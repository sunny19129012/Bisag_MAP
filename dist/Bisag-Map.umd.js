(function(Dt,I){typeof exports=="object"&&typeof module<"u"?I(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],I):(Dt=typeof globalThis<"u"?globalThis:Dt||self,I(Dt.MyReactLib={},Dt.React))})(this,function(Dt,I){"use strict";var KP=Object.defineProperty;var ZP=(Dt,I,li)=>I in Dt?KP(Dt,I,{enumerable:!0,configurable:!0,writable:!0,value:li}):Dt[I]=li;var un=(Dt,I,li)=>ZP(Dt,typeof I!="symbol"?I+"":I,li);var li={exports:{}},ss={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vu;function np(){if(Vu)return ss;Vu=1;var n=I,e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,c){var h,u={},d=null,f=null;c!==void 0&&(d=""+c),l.key!==void 0&&(d=""+l.key),l.ref!==void 0&&(f=l.ref);for(h in l)i.call(l,h)&&!s.hasOwnProperty(h)&&(u[h]=l[h]);if(a&&a.defaultProps)for(h in l=a.defaultProps,l)u[h]===void 0&&(u[h]=l[h]);return{$$typeof:e,type:a,key:d,ref:f,props:u,_owner:r.current}}return ss.Fragment=t,ss.jsx=o,ss.jsxs=o,ss}var os={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xu;function ip(){return Xu||(Xu=1,process.env.NODE_ENV!=="production"&&function(){var n=I,e=Symbol.for("react.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),a=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.suspense_list"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.for("react.offscreen"),g=Symbol.iterator,_="@@iterator";function m(T){if(T===null||typeof T!="object")return null;var M=g&&T[g]||T[_];return typeof M=="function"?M:null}var y=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function p(T){{for(var M=arguments.length,W=new Array(M>1?M-1:0),ie=1;ie<M;ie++)W[ie-1]=arguments[ie];E("error",T,W)}}function E(T,M,W){{var ie=y.ReactDebugCurrentFrame,we=ie.getStackAddendum();we!==""&&(M+="%s",W=W.concat([we]));var Ce=W.map(function(me){return String(me)});Ce.unshift("Warning: "+M),Function.prototype.apply.call(console[T],console,Ce)}}var x=!1,v=!1,S=!1,w=!1,b=!1,P;P=Symbol.for("react.module.reference");function D(T){return!!(typeof T=="string"||typeof T=="function"||T===i||T===s||b||T===r||T===c||T===h||w||T===f||x||v||S||typeof T=="object"&&T!==null&&(T.$$typeof===d||T.$$typeof===u||T.$$typeof===o||T.$$typeof===a||T.$$typeof===l||T.$$typeof===P||T.getModuleId!==void 0))}function G(T,M,W){var ie=T.displayName;if(ie)return ie;var we=M.displayName||M.name||"";return we!==""?W+"("+we+")":W}function N(T){return T.displayName||"Context"}function F(T){if(T==null)return null;if(typeof T.tag=="number"&&p("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof T=="function")return T.displayName||T.name||null;if(typeof T=="string")return T;switch(T){case i:return"Fragment";case t:return"Portal";case s:return"Profiler";case r:return"StrictMode";case c:return"Suspense";case h:return"SuspenseList"}if(typeof T=="object")switch(T.$$typeof){case a:var M=T;return N(M)+".Consumer";case o:var W=T;return N(W._context)+".Provider";case l:return G(T,T.render,"ForwardRef");case u:var ie=T.displayName||null;return ie!==null?ie:F(T.type)||"Memo";case d:{var we=T,Ce=we._payload,me=we._init;try{return F(me(Ce))}catch{return null}}}return null}var B=Object.assign,H=0,A,k,z,V,K,oe,L;function ke(){}ke.__reactDisabledLog=!0;function We(){{if(H===0){A=console.log,k=console.info,z=console.warn,V=console.error,K=console.group,oe=console.groupCollapsed,L=console.groupEnd;var T={configurable:!0,enumerable:!0,value:ke,writable:!0};Object.defineProperties(console,{info:T,log:T,warn:T,error:T,group:T,groupCollapsed:T,groupEnd:T})}H++}}function Re(){{if(H--,H===0){var T={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:B({},T,{value:A}),info:B({},T,{value:k}),warn:B({},T,{value:z}),error:B({},T,{value:V}),group:B({},T,{value:K}),groupCollapsed:B({},T,{value:oe}),groupEnd:B({},T,{value:L})})}H<0&&p("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var nt=y.ReactCurrentDispatcher,Ye;function yt(T,M,W){{if(Ye===void 0)try{throw Error()}catch(we){var ie=we.stack.trim().match(/\n( *(at )?)/);Ye=ie&&ie[1]||""}return`
`+Ye+T}}var xt=!1,tt;{var es=typeof WeakMap=="function"?WeakMap:Map;tt=new es}function ts(T,M){if(!T||xt)return"";{var W=tt.get(T);if(W!==void 0)return W}var ie;xt=!0;var we=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var Ce;Ce=nt.current,nt.current=null,We();try{if(M){var me=function(){throw Error()};if(Object.defineProperty(me.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(me,[])}catch(Ot){ie=Ot}Reflect.construct(T,[],me)}else{try{me.call()}catch(Ot){ie=Ot}T.call(me.prototype)}}else{try{throw Error()}catch(Ot){ie=Ot}T()}}catch(Ot){if(Ot&&ie&&typeof Ot.stack=="string"){for(var de=Ot.stack.split(`
`),Tt=ie.stack.split(`
`),Be=de.length-1,je=Tt.length-1;Be>=1&&je>=0&&de[Be]!==Tt[je];)je--;for(;Be>=1&&je>=0;Be--,je--)if(de[Be]!==Tt[je]){if(Be!==1||je!==1)do if(Be--,je--,je<0||de[Be]!==Tt[je]){var Ht=`
`+de[Be].replace(" at new "," at ");return T.displayName&&Ht.includes("<anonymous>")&&(Ht=Ht.replace("<anonymous>",T.displayName)),typeof T=="function"&&tt.set(T,Ht),Ht}while(Be>=1&&je>=0);break}}}finally{xt=!1,nt.current=Ce,Re(),Error.prepareStackTrace=we}var rs=T?T.displayName||T.name:"",hr=rs?yt(rs):"";return typeof T=="function"&&tt.set(T,hr),hr}function ar(T,M,W){return ts(T,!1)}function ti(T){var M=T.prototype;return!!(M&&M.isReactComponent)}function it(T,M,W){if(T==null)return"";if(typeof T=="function")return ts(T,ti(T));if(typeof T=="string")return yt(T);switch(T){case c:return yt("Suspense");case h:return yt("SuspenseList")}if(typeof T=="object")switch(T.$$typeof){case l:return ar(T.render);case u:return it(T.type,M,W);case d:{var ie=T,we=ie._payload,Ce=ie._init;try{return it(Ce(we),M,W)}catch{}}}return""}var ut=Object.prototype.hasOwnProperty,ni={},ii=y.ReactDebugCurrentFrame;function Cn(T){if(T){var M=T._owner,W=it(T.type,T._source,M?M.type:null);ii.setExtraStackFrame(W)}else ii.setExtraStackFrame(null)}function ri(T,M,W,ie,we){{var Ce=Function.call.bind(ut);for(var me in T)if(Ce(T,me)){var de=void 0;try{if(typeof T[me]!="function"){var Tt=Error((ie||"React class")+": "+W+" type `"+me+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof T[me]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw Tt.name="Invariant Violation",Tt}de=T[me](M,me,ie,W,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(Be){de=Be}de&&!(de instanceof Error)&&(Cn(we),p("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",ie||"React class",W,me,typeof de),Cn(null)),de instanceof Error&&!(de.message in ni)&&(ni[de.message]=!0,Cn(we),p("Failed %s type: %s",W,de.message),Cn(null))}}}var Pi=Array.isArray;function Rn(T){return Pi(T)}function $e(T){{var M=typeof Symbol=="function"&&Symbol.toStringTag,W=M&&T[Symbol.toStringTag]||T.constructor.name||"Object";return W}}function vo(T){try{return ns(T),!1}catch{return!0}}function ns(T){return""+T}function lr(T){if(vo(T))return p("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",$e(T)),ns(T)}var cr=y.ReactCurrentOwner,zu={key:!0,ref:!0,__self:!0,__source:!0},Eo,To;function wo(T){if(ut.call(T,"ref")){var M=Object.getOwnPropertyDescriptor(T,"ref").get;if(M&&M.isReactWarning)return!1}return T.ref!==void 0}function Wu(T){if(ut.call(T,"key")){var M=Object.getOwnPropertyDescriptor(T,"key").get;if(M&&M.isReactWarning)return!1}return T.key!==void 0}function Yu(T,M){typeof T.ref=="string"&&cr.current}function El(T,M){{var W=function(){Eo||(Eo=!0,p("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",M))};W.isReactWarning=!0,Object.defineProperty(T,"key",{get:W,configurable:!0})}}function Tl(T,M){{var W=function(){To||(To=!0,p("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",M))};W.isReactWarning=!0,Object.defineProperty(T,"ref",{get:W,configurable:!0})}}var So=function(T,M,W,ie,we,Ce,me){var de={$$typeof:e,type:T,key:M,ref:W,props:me,_owner:Ce};return de._store={},Object.defineProperty(de._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(de,"_self",{configurable:!1,enumerable:!1,writable:!1,value:ie}),Object.defineProperty(de,"_source",{configurable:!1,enumerable:!1,writable:!1,value:we}),Object.freeze&&(Object.freeze(de.props),Object.freeze(de)),de};function wl(T,M,W,ie,we){{var Ce,me={},de=null,Tt=null;W!==void 0&&(lr(W),de=""+W),Wu(M)&&(lr(M.key),de=""+M.key),wo(M)&&(Tt=M.ref,Yu(M,we));for(Ce in M)ut.call(M,Ce)&&!zu.hasOwnProperty(Ce)&&(me[Ce]=M[Ce]);if(T&&T.defaultProps){var Be=T.defaultProps;for(Ce in Be)me[Ce]===void 0&&(me[Ce]=Be[Ce])}if(de||Tt){var je=typeof T=="function"?T.displayName||T.name||"Unknown":T;de&&El(me,je),Tt&&Tl(me,je)}return So(T,de,Tt,we,ie,cr.current,me)}}var bo=y.ReactCurrentOwner,is=y.ReactDebugCurrentFrame;function Vt(T){if(T){var M=T._owner,W=it(T.type,T._source,M?M.type:null);is.setExtraStackFrame(W)}else is.setExtraStackFrame(null)}var si;si=!1;function oi(T){return typeof T=="object"&&T!==null&&T.$$typeof===e}function Co(){{if(bo.current){var T=F(bo.current.type);if(T)return`

Check the render method of \``+T+"`."}return""}}function Sl(T){return""}var vt={};function ai(T){{var M=Co();if(!M){var W=typeof T=="string"?T:T.displayName||T.name;W&&(M=`

Check the top-level render call using <`+W+">.")}return M}}function Et(T,M){{if(!T._store||T._store.validated||T.key!=null)return;T._store.validated=!0;var W=ai(M);if(vt[W])return;vt[W]=!0;var ie="";T&&T._owner&&T._owner!==bo.current&&(ie=" It was passed a child from "+F(T._owner.type)+"."),Vt(T),p('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',W,ie),Vt(null)}}function Gt(T,M){{if(typeof T!="object")return;if(Rn(T))for(var W=0;W<T.length;W++){var ie=T[W];oi(ie)&&Et(ie,M)}else if(oi(T))T._store&&(T._store.validated=!0);else if(T){var we=m(T);if(typeof we=="function"&&we!==T.entries)for(var Ce=we.call(T),me;!(me=Ce.next()).done;)oi(me.value)&&Et(me.value,M)}}}function Mt(T){{var M=T.type;if(M==null||typeof M=="string")return;var W;if(typeof M=="function")W=M.propTypes;else if(typeof M=="object"&&(M.$$typeof===l||M.$$typeof===u))W=M.propTypes;else return;if(W){var ie=F(M);ri(W,T.props,"prop",ie,T)}else if(M.PropTypes!==void 0&&!si){si=!0;var we=F(M);p("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",we||"Unknown")}typeof M.getDefaultProps=="function"&&!M.getDefaultProps.isReactClassApproved&&p("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function cn(T){{for(var M=Object.keys(T.props),W=0;W<M.length;W++){var ie=M[W];if(ie!=="children"&&ie!=="key"){Vt(T),p("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",ie),Vt(null);break}}T.ref!==null&&(Vt(T),p("Invalid attribute `ref` supplied to `React.Fragment`."),Vt(null))}}var Xt={};function Le(T,M,W,ie,we,Ce){{var me=D(T);if(!me){var de="";(T===void 0||typeof T=="object"&&T!==null&&Object.keys(T).length===0)&&(de+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var Tt=Sl();Tt?de+=Tt:de+=Co();var Be;T===null?Be="null":Rn(T)?Be="array":T!==void 0&&T.$$typeof===e?(Be="<"+(F(T.type)||"Unknown")+" />",de=" Did you accidentally export a JSX literal instead of a component?"):Be=typeof T,p("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",Be,de)}var je=wl(T,M,W,we,Ce);if(je==null)return je;if(me){var Ht=M.children;if(Ht!==void 0)if(ie)if(Rn(Ht)){for(var rs=0;rs<Ht.length;rs++)Gt(Ht[rs],T);Object.freeze&&Object.freeze(Ht)}else p("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else Gt(Ht,T)}if(ut.call(M,"key")){var hr=F(T),Ot=Object.keys(M).filter(function(HP){return HP!=="key"}),ju=Ot.length>0?"{key: someKey, "+Ot.join(": ..., ")+": ...}":"{key: someKey}";if(!Xt[hr+ju]){var XP=Ot.length>0?"{"+Ot.join(": ..., ")+": ...}":"{}";p(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,ju,hr,XP,hr),Xt[hr+ju]=!0}}return T===i?cn(je):Mt(je),je}}function rt(T,M,W){return Le(T,M,W,!0)}function hn(T,M,W){return Le(T,M,W,!1)}var $u=hn,VP=rt;os.Fragment=i,os.jsx=$u,os.jsxs=VP}()),os}process.env.NODE_ENV==="production"?li.exports=np():li.exports=ip();var j=li.exports;function Hu(n){var e,t,i="";if(typeof n=="string"||typeof n=="number")i+=n;else if(typeof n=="object")if(Array.isArray(n)){var r=n.length;for(e=0;e<r;e++)n[e]&&(t=Hu(n[e]))&&(i&&(i+=" "),i+=t)}else for(t in n)n[t]&&(i&&(i+=" "),i+=t);return i}function Ii(){for(var n,e,t=0,i="",r=arguments.length;t<r;t++)(n=arguments[t])&&(e=Hu(n))&&(i&&(i+=" "),i+=e);return i}function rp(n){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t),t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n))}rp(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var as=n=>typeof n=="number"&&!isNaN(n),Ai=n=>typeof n=="string",Pn=n=>typeof n=="function",sp=n=>Ai(n)||as(n),bl=n=>Ai(n)||Pn(n)?n:null,op=(n,e)=>n===!1||as(n)&&n>0?n:e,Cl=n=>I.isValidElement(n)||Ai(n)||Pn(n)||as(n);function ap(n,e,t=300){let{scrollHeight:i,style:r}=n;requestAnimationFrame(()=>{r.minHeight="initial",r.height=i+"px",r.transition=`all ${t}ms`,requestAnimationFrame(()=>{r.height="0",r.padding="0",r.margin="0",setTimeout(e,t)})})}function lp({enter:n,exit:e,appendPosition:t=!1,collapse:i=!0,collapseDuration:r=300}){return function({children:s,position:o,preventExitTransition:a,done:l,nodeRef:c,isIn:h,playToast:u}){let d=t?`${n}--${o}`:n,f=t?`${e}--${o}`:e,g=I.useRef(0);return I.useLayoutEffect(()=>{let _=c.current,m=d.split(" "),y=p=>{p.target===c.current&&(u(),_.removeEventListener("animationend",y),_.removeEventListener("animationcancel",y),g.current===0&&p.type!=="animationcancel"&&_.classList.remove(...m))};_.classList.add(...m),_.addEventListener("animationend",y),_.addEventListener("animationcancel",y)},[]),I.useEffect(()=>{let _=c.current,m=()=>{_.removeEventListener("animationend",m),i?ap(_,l,r):l()};h||(a?m():(g.current=1,_.className+=` ${f}`,_.addEventListener("animationend",m)))},[h]),I.createElement(I.Fragment,null,s)}}function Ku(n,e){return{content:Zu(n.content,n.props),containerId:n.props.containerId,id:n.props.toastId,theme:n.props.theme,type:n.props.type,data:n.props.data||{},isLoading:n.props.isLoading,icon:n.props.icon,reason:n.removalReason,status:e}}function Zu(n,e,t=!1){return I.isValidElement(n)&&!Ai(n.type)?I.cloneElement(n,{closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:t}):Pn(n)?n({closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:t}):n}function cp({closeToast:n,theme:e,ariaLabel:t="close"}){return I.createElement("button",{className:`Toastify__close-button Toastify__close-button--${e}`,type:"button",onClick:i=>{i.stopPropagation(),n(!0)},"aria-label":t},I.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},I.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function hp({delay:n,isRunning:e,closeToast:t,type:i="default",hide:r,className:s,controlledProgress:o,progress:a,rtl:l,isIn:c,theme:h}){let u=r||o&&a===0,d={animationDuration:`${n}ms`,animationPlayState:e?"running":"paused"};o&&(d.transform=`scaleX(${a})`);let f=Ii("Toastify__progress-bar",o?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${h}`,`Toastify__progress-bar--${i}`,{"Toastify__progress-bar--rtl":l}),g=Pn(s)?s({rtl:l,type:i,defaultClassName:f}):Ii(f,s),_={[o&&a>=1?"onTransitionEnd":"onAnimationEnd"]:o&&a<1?null:()=>{c&&t()}};return I.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":u},I.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${h} Toastify__progress-bar--${i}`}),I.createElement("div",{role:"progressbar","aria-hidden":u?"true":"false","aria-label":"notification timer",className:g,style:d,..._}))}var up=1,qu=()=>`${up++}`;function dp(n,e,t){let i=1,r=0,s=[],o=[],a=e,l=new Map,c=new Set,h=p=>(c.add(p),()=>c.delete(p)),u=()=>{o=Array.from(l.values()),c.forEach(p=>p())},d=({containerId:p,toastId:E,updateId:x})=>{let v=p?p!==n:n!==1,S=l.has(E)&&x==null;return v||S},f=(p,E)=>{l.forEach(x=>{var v;(E==null||E===x.props.toastId)&&((v=x.toggle)==null||v.call(x,p))})},g=p=>{var E,x;(x=(E=p.props)==null?void 0:E.onClose)==null||x.call(E,p.removalReason),p.isActive=!1},_=p=>{if(p==null)l.forEach(g);else{let E=l.get(p);E&&g(E)}u()},m=()=>{r-=s.length,s=[]},y=p=>{var E,x;let{toastId:v,updateId:S}=p.props,w=S==null;p.staleId&&l.delete(p.staleId),p.isActive=!0,l.set(v,p),u(),t(Ku(p,w?"added":"updated")),w&&((x=(E=p.props).onOpen)==null||x.call(E))};return{id:n,props:a,observe:h,toggle:f,removeToast:_,toasts:l,clearQueue:m,buildToast:(p,E)=>{if(d(E))return;let{toastId:x,updateId:v,data:S,staleId:w,delay:b}=E,P=v==null;P&&r++;let D={...a,style:a.toastStyle,key:i++,...Object.fromEntries(Object.entries(E).filter(([N,F])=>F!=null)),toastId:x,updateId:v,data:S,isIn:!1,className:bl(E.className||a.toastClassName),progressClassName:bl(E.progressClassName||a.progressClassName),autoClose:E.isLoading?!1:op(E.autoClose,a.autoClose),closeToast(N){l.get(x).removalReason=N,_(x)},deleteToast(){let N=l.get(x);if(N!=null){if(t(Ku(N,"removed")),l.delete(x),r--,r<0&&(r=0),s.length>0){y(s.shift());return}u()}}};D.closeButton=a.closeButton,E.closeButton===!1||Cl(E.closeButton)?D.closeButton=E.closeButton:E.closeButton===!0&&(D.closeButton=Cl(a.closeButton)?a.closeButton:!0);let G={content:p,props:D,staleId:w};a.limit&&a.limit>0&&r>a.limit&&P?s.push(G):as(b)?setTimeout(()=>{y(G)},b):y(G)},setProps(p){a=p},setToggle:(p,E)=>{let x=l.get(p);x&&(x.toggle=E)},isToastActive:p=>{var E;return(E=l.get(p))==null?void 0:E.isActive},getSnapshot:()=>o}}var dt=new Map,ls=[],Rl=new Set,fp=n=>Rl.forEach(e=>e(n)),Ju=()=>dt.size>0;function gp(){ls.forEach(n=>ed(n.content,n.options)),ls=[]}var mp=(n,{containerId:e})=>{var t;return(t=dt.get(e||1))==null?void 0:t.toasts.get(n)};function Qu(n,e){var t;if(e)return!!((t=dt.get(e))!=null&&t.isToastActive(n));let i=!1;return dt.forEach(r=>{r.isToastActive(n)&&(i=!0)}),i}function _p(n){if(!Ju()){ls=ls.filter(e=>n!=null&&e.options.toastId!==n);return}if(n==null||sp(n))dt.forEach(e=>{e.removeToast(n)});else if(n&&("containerId"in n||"id"in n)){let e=dt.get(n.containerId);e?e.removeToast(n.id):dt.forEach(t=>{t.removeToast(n.id)})}}var pp=(n={})=>{dt.forEach(e=>{e.props.limit&&(!n.containerId||e.id===n.containerId)&&e.clearQueue()})};function ed(n,e){Cl(n)&&(Ju()||ls.push({content:n,options:e}),dt.forEach(t=>{t.buildToast(n,e)}))}function yp(n){var e;(e=dt.get(n.containerId||1))==null||e.setToggle(n.id,n.fn)}function td(n,e){dt.forEach(t=>{(e==null||!(e!=null&&e.containerId)||(e==null?void 0:e.containerId)===t.id)&&t.toggle(n,e==null?void 0:e.id)})}function xp(n){let e=n.containerId||1;return{subscribe(t){let i=dp(e,n,fp);dt.set(e,i);let r=i.observe(t);return gp(),()=>{r(),dt.delete(e)}},setProps(t){var i;(i=dt.get(e))==null||i.setProps(t)},getSnapshot(){var t;return(t=dt.get(e))==null?void 0:t.getSnapshot()}}}function vp(n){return Rl.add(n),()=>{Rl.delete(n)}}function Ep(n){return n&&(Ai(n.toastId)||as(n.toastId))?n.toastId:qu()}function cs(n,e){return ed(n,e),e.toastId}function Ro(n,e){return{...e,type:e&&e.type||n,toastId:Ep(e)}}function Po(n){return(e,t)=>cs(e,Ro(n,t))}function Te(n,e){return cs(n,Ro("default",e))}Te.loading=(n,e)=>cs(n,Ro("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e}));function Tp(n,{pending:e,error:t,success:i},r){let s;e&&(s=Ai(e)?Te.loading(e,r):Te.loading(e.render,{...r,...e}));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},a=(c,h,u)=>{if(h==null){Te.dismiss(s);return}let d={type:c,...o,...r,data:u},f=Ai(h)?{render:h}:h;return s?Te.update(s,{...d,...f}):Te(f.render,{...d,...f}),u},l=Pn(n)?n():n;return l.then(c=>a("success",i,c)).catch(c=>a("error",t,c)),l}Te.promise=Tp,Te.success=Po("success"),Te.info=Po("info"),Te.error=Po("error"),Te.warning=Po("warning"),Te.warn=Te.warning,Te.dark=(n,e)=>cs(n,Ro("default",{theme:"dark",...e}));function wp(n){_p(n)}Te.dismiss=wp,Te.clearWaitingQueue=pp,Te.isActive=Qu,Te.update=(n,e={})=>{let t=mp(n,e);if(t){let{props:i,content:r}=t,s={delay:100,...i,...e,toastId:e.toastId||n,updateId:qu()};s.toastId!==n&&(s.staleId=n);let o=s.render||r;delete s.render,cs(o,s)}},Te.done=n=>{Te.update(n,{progress:1})},Te.onChange=vp,Te.play=n=>td(!0,n),Te.pause=n=>td(!1,n);function Sp(n){var e;let{subscribe:t,getSnapshot:i,setProps:r}=I.useRef(xp(n)).current;r(n);let s=(e=I.useSyncExternalStore(t,i,i))==null?void 0:e.slice();function o(a){if(!s)return[];let l=new Map;return n.newestOnTop&&s.reverse(),s.forEach(c=>{let{position:h}=c.props;l.has(h)||l.set(h,[]),l.get(h).push(c)}),Array.from(l,c=>a(c[0],c[1]))}return{getToastToRender:o,isToastActive:Qu,count:s==null?void 0:s.length}}function bp(n){let[e,t]=I.useState(!1),[i,r]=I.useState(!1),s=I.useRef(null),o=I.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:a,pauseOnHover:l,closeToast:c,onClick:h,closeOnClick:u}=n;yp({id:n.toastId,containerId:n.containerId,fn:t}),I.useEffect(()=>{if(n.pauseOnFocusLoss)return d(),()=>{f()}},[n.pauseOnFocusLoss]);function d(){document.hasFocus()||y(),window.addEventListener("focus",m),window.addEventListener("blur",y)}function f(){window.removeEventListener("focus",m),window.removeEventListener("blur",y)}function g(w){if(n.draggable===!0||n.draggable===w.pointerType){p();let b=s.current;o.canCloseOnClick=!0,o.canDrag=!0,b.style.transition="none",n.draggableDirection==="x"?(o.start=w.clientX,o.removalDistance=b.offsetWidth*(n.draggablePercent/100)):(o.start=w.clientY,o.removalDistance=b.offsetHeight*(n.draggablePercent===80?n.draggablePercent*1.5:n.draggablePercent)/100)}}function _(w){let{top:b,bottom:P,left:D,right:G}=s.current.getBoundingClientRect();w.nativeEvent.type!=="touchend"&&n.pauseOnHover&&w.clientX>=D&&w.clientX<=G&&w.clientY>=b&&w.clientY<=P?y():m()}function m(){t(!0)}function y(){t(!1)}function p(){o.didMove=!1,document.addEventListener("pointermove",x),document.addEventListener("pointerup",v)}function E(){document.removeEventListener("pointermove",x),document.removeEventListener("pointerup",v)}function x(w){let b=s.current;if(o.canDrag&&b){o.didMove=!0,e&&y(),n.draggableDirection==="x"?o.delta=w.clientX-o.start:o.delta=w.clientY-o.start,o.start!==w.clientX&&(o.canCloseOnClick=!1);let P=n.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`;b.style.transform=`translate3d(${P},0)`,b.style.opacity=`${1-Math.abs(o.delta/o.removalDistance)}`}}function v(){E();let w=s.current;if(o.canDrag&&o.didMove&&w){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance){r(!0),n.closeToast(!0),n.collapseAll();return}w.style.transition="transform 0.2s, opacity 0.2s",w.style.removeProperty("transform"),w.style.removeProperty("opacity")}}let S={onPointerDown:g,onPointerUp:_};return a&&l&&(S.onMouseEnter=y,n.stacked||(S.onMouseLeave=m)),u&&(S.onClick=w=>{h&&h(w),o.canCloseOnClick&&c(!0)}),{playToast:m,pauseToast:y,isRunning:e,preventExitTransition:i,toastRef:s,eventHandlers:S}}var Cp=typeof window<"u"?I.useLayoutEffect:I.useEffect,Io=({theme:n,type:e,isLoading:t,...i})=>I.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:n==="colored"?"currentColor":`var(--toastify-icon-color-${e})`,...i});function Rp(n){return I.createElement(Io,{...n},I.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function Pp(n){return I.createElement(Io,{...n},I.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function Ip(n){return I.createElement(Io,{...n},I.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function Ap(n){return I.createElement(Io,{...n},I.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function Lp(){return I.createElement("div",{className:"Toastify__spinner"})}var Pl={info:Pp,warning:Rp,success:Ip,error:Ap,spinner:Lp},Mp=n=>n in Pl;function Op({theme:n,type:e,isLoading:t,icon:i}){let r=null,s={theme:n,type:e};return i===!1||(Pn(i)?r=i({...s,isLoading:t}):I.isValidElement(i)?r=I.cloneElement(i,s):t?r=Pl.spinner():Mp(e)&&(r=Pl[e](s))),r}var Dp=n=>{let{isRunning:e,preventExitTransition:t,toastRef:i,eventHandlers:r,playToast:s}=bp(n),{closeButton:o,children:a,autoClose:l,onClick:c,type:h,hideProgressBar:u,closeToast:d,transition:f,position:g,className:_,style:m,progressClassName:y,updateId:p,role:E,progress:x,rtl:v,toastId:S,deleteToast:w,isIn:b,isLoading:P,closeOnClick:D,theme:G,ariaLabel:N}=n,F=Ii("Toastify__toast",`Toastify__toast-theme--${G}`,`Toastify__toast--${h}`,{"Toastify__toast--rtl":v},{"Toastify__toast--close-on-click":D}),B=Pn(_)?_({rtl:v,position:g,type:h,defaultClassName:F}):Ii(F,_),H=Op(n),A=!!x||!l,k={closeToast:d,type:h,theme:G},z=null;return o===!1||(Pn(o)?z=o(k):I.isValidElement(o)?z=I.cloneElement(o,k):z=cp(k)),I.createElement(f,{isIn:b,done:w,position:g,preventExitTransition:t,nodeRef:i,playToast:s},I.createElement("div",{id:S,tabIndex:0,onClick:c,"data-in":b,className:B,...r,style:m,ref:i,...b&&{role:E,"aria-label":N}},H!=null&&I.createElement("div",{className:Ii("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!P})},H),Zu(a,n,!e),z,!n.customProgressBar&&I.createElement(hp,{...p&&!A?{key:`p-${p}`}:{},rtl:v,theme:G,delay:l,isRunning:e,isIn:b,closeToast:d,hide:u,type:h,className:y,controlledProgress:A,progress:x||0})))},Fp=(n,e=!1)=>({enter:`Toastify--animate Toastify__${n}-enter`,exit:`Toastify--animate Toastify__${n}-exit`,appendPosition:e}),kp=lp(Fp("bounce",!0)),Np={position:"top-right",transition:kp,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:n=>n.altKey&&n.code==="KeyT"};function Gp(n){let e={...Np,...n},t=n.stacked,[i,r]=I.useState(!0),s=I.useRef(null),{getToastToRender:o,isToastActive:a,count:l}=Sp(e),{className:c,style:h,rtl:u,containerId:d,hotKeys:f}=e;function g(m){let y=Ii("Toastify__toast-container",`Toastify__toast-container--${m}`,{"Toastify__toast-container--rtl":u});return Pn(c)?c({position:m,rtl:u,defaultClassName:y}):Ii(y,bl(c))}function _(){t&&(r(!0),Te.play())}return Cp(()=>{var m;if(t){let y=s.current.querySelectorAll('[data-in="true"]'),p=12,E=(m=e.position)==null?void 0:m.includes("top"),x=0,v=0;Array.from(y).reverse().forEach((S,w)=>{let b=S;b.classList.add("Toastify__toast--stacked"),w>0&&(b.dataset.collapsed=`${i}`),b.dataset.pos||(b.dataset.pos=E?"top":"bot");let P=x*(i?.2:1)+(i?0:p*w);b.style.setProperty("--y",`${E?P:P*-1}px`),b.style.setProperty("--g",`${p}`),b.style.setProperty("--s",`${1-(i?v:0)}`),x+=b.offsetHeight,v+=.025})}},[i,l,t]),I.useEffect(()=>{function m(y){var p;let E=s.current;f(y)&&((p=E.querySelector('[tabIndex="0"]'))==null||p.focus(),r(!1),Te.pause()),y.key==="Escape"&&(document.activeElement===E||E!=null&&E.contains(document.activeElement))&&(r(!0),Te.play())}return document.addEventListener("keydown",m),()=>{document.removeEventListener("keydown",m)}},[f]),I.createElement("section",{ref:s,className:"Toastify",id:d,onMouseEnter:()=>{t&&(r(!1),Te.pause())},onMouseLeave:_,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":e["aria-label"]},o((m,y)=>{let p=y.length?{...h}:{...h,pointerEvents:"none"};return I.createElement("div",{tabIndex:-1,className:g(m),"data-stacked":t,style:p,key:`c-${m}`},y.map(({content:E,props:x})=>I.createElement(Dp,{...x,stacked:t,collapseAll:_,isIn:a(x.toastId,x.containerId),key:`t-${x.key}`},E)))}))}const wt={ADD:"add",REMOVE:"remove"},ur={PROPERTYCHANGE:"propertychange"},re={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class hs{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function Up(n,e,t){let i,r;t=t||In;let s=0,o=n.length,a=!1;for(;s<o;)i=s+(o-s>>1),r=+t(n[i],e),r<0?s=i+1:(o=i,a=!r);return a?s:~s}function In(n,e){return n>e?1:n<e?-1:0}function Bp(n,e){return n<e?1:n>e?-1:0}function Il(n,e,t){if(n[0]<=e)return 0;const i=n.length;if(e<=n[i-1])return i-1;if(typeof t=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===e)return r;if(s<e)return t(e,n[r-1],s)>0?r-1:r}return i-1}if(t>0){for(let r=1;r<i;++r)if(n[r]<e)return r-1;return i-1}if(t<0){for(let r=1;r<i;++r)if(n[r]<=e)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return n[r-1]-e<e-n[r]?r-1:r}return i-1}function zp(n,e,t){for(;e<t;){const i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function dn(n,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let r=0;r<i;r++)n[n.length]=t[r]}function An(n,e){const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function Wp(n,e,t){const i=e||In;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}function us(){return!0}function Ao(){return!1}function ds(){}function nd(n){let e,t,i;return function(){const r=Array.prototype.slice.call(arguments);return(!t||this!==i||!An(r,t))&&(i=this,t=r,e=n.apply(this,arguments)),e}}function Yp(n){function e(){let t;try{t=n()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function dr(n){for(const e in n)delete n[e]}function Li(n){let e;for(e in n)return!1;return!e}class Ln{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class Lo extends hs{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),r=i[e]||(i[e]=[]);r.includes(t)||r.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=t?new Ln(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let l;for(let c=0,h=r.length;c<h;++c)if("handleEvent"in r[c]?l=r[c].handleEvent(s):l=r[c].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--o[i]===0){let c=a[i];for(delete a[i];c--;)this.removeEventListener(i,ds);delete o[i]}return l}disposeInternal(){this.listeners_&&dr(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const r=i.indexOf(t);r!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[r]=ds,++this.pendingRemovals_[e]):(i.splice(r,1),i.length===0&&delete this.listeners_[e]))}}function he(n,e,t,i,r){if(r){const o=t;t=function(a){return n.removeEventListener(e,t),o.call(i??this,a)}}else i&&i!==n&&(t=t.bind(i));const s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function Mo(n,e,t,i){return he(n,e,t,i,!0)}function be(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),dr(n))}class fs extends Lo{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(re.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=he(this,e[s],t);return r}return he(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const r=e.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=Mo(this,e[s],t)}else i=Mo(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)ci(i);else if(Array.isArray(e))for(let r=0,s=e.length;r<s;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}fs.prototype.on,fs.prototype.once,fs.prototype.un;function ci(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)be(n[e]);else be(n)}function Q(){throw new Error("Unimplemented abstract method.")}let $p=0;function J(n){return n.ol_uid||(n.ol_uid=String(++$p))}const jp="10.6.1";class id extends Ln{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class St extends fs{constructor(e){super(),this.on,this.once,this.un,J(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new id(i,e,t)),i=ur.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new id(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const r=this.values_||(this.values_={});if(i)r[e]=t;else{const s=r[e];r[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],Li(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}const rd={LENGTH:"length"};class Oo extends Ln{constructor(e,t,i){super(e),this.element=t,this.index=i}}class fn extends St{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e||[],this.unique_)for(let i=0,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(rd.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Oo(wt.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){this.unique_&&this.assertUnique_(e);const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,r=t.length;i<r;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Oo(wt.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const r=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Oo(wt.REMOVE,r,e)),this.dispatchEvent(new Oo(wt.ADD,t,e))}updateLength_(){this.set(rd.LENGTH,this.array_.length)}assertUnique_(e,t){for(let i=0,r=this.array_.length;i<r;++i)if(this.array_[i]===e&&i!==t)throw new Error("Duplicate item added to a unique collection")}}function fe(n,e){if(!n)throw new Error(e)}class hi extends St{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new hi(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(be(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=he(e,re.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?Vp(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function Vp(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(fe(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}const qe={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function sd(n){const e=ft();for(let t=0,i=n.length;t<i;++t)gs(e,n[t]);return e}function Xp(n,e,t){const i=Math.min.apply(null,n),r=Math.min.apply(null,e),s=Math.max.apply(null,n),o=Math.max.apply(null,e);return On(i,r,s,o,t)}function Mn(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function od(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function Mi(n,e,t){let i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function fr(n,e){return Al(n,e[0],e[1])}function gr(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function Al(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function Ll(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=e[0],a=e[1];let l=qe.UNKNOWN;return o<t?l=l|qe.LEFT:o>r&&(l=l|qe.RIGHT),a<i?l=l|qe.BELOW:a>s&&(l=l|qe.ABOVE),l===qe.UNKNOWN&&(l=qe.INTERSECTING),l}function ft(){return[1/0,1/0,-1/0,-1/0]}function On(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function mr(n){return On(1/0,1/0,-1/0,-1/0,n)}function Ml(n,e){const t=n[0],i=n[1];return On(t,i,t,i,e)}function Ol(n,e,t,i,r){const s=mr(r);return ld(s,n,e,t,i)}function _r(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function ad(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function gs(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function ld(n,e,t,i,r){for(;t<i;t+=r)Hp(n,e[t],e[t+1]);return n}function Hp(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function cd(n,e){let t;return t=e(Do(n)),t||(t=e(Fo(n)),t)||(t=e(ko(n)),t)||(t=e(Di(n)),t)?t:!1}function Dl(n){let e=0;return ms(n)||(e=xe(n)*st(n)),e}function Do(n){return[n[0],n[1]]}function Fo(n){return[n[2],n[1]]}function Kt(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function Kp(n,e){let t;if(e==="bottom-left")t=Do(n);else if(e==="bottom-right")t=Fo(n);else if(e==="top-left")t=Di(n);else if(e==="top-right")t=ko(n);else throw new Error("Invalid corner");return t}function Fl(n,e,t,i,r){const[s,o,a,l,c,h,u,d]=hd(n,e,t,i);return On(Math.min(s,a,c,u),Math.min(o,l,h,d),Math.max(s,a,c,u),Math.max(o,l,h,d),r)}function hd(n,e,t,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),a=Math.sin(t),l=r*o,c=r*a,h=s*o,u=s*a,d=n[0],f=n[1];return[d-l+u,f-c-h,d-l-u,f-c+h,d+l-u,f+c+h,d+l+u,f+c-h,d-l+u,f-c-h]}function st(n){return n[3]-n[1]}function Oi(n,e,t){const i=t||ft();return gt(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):mr(i),i}function Di(n){return[n[0],n[3]]}function ko(n){return[n[2],n[3]]}function xe(n){return n[2]-n[0]}function gt(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function ms(n){return n[2]<n[0]||n[3]<n[1]}function Zp(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function qp(n,e,t){let i=!1;const r=Ll(n,e),s=Ll(n,t);if(r===qe.INTERSECTING||s===qe.INTERSECTING)i=!0;else{const o=n[0],a=n[1],l=n[2],c=n[3],h=e[0],u=e[1],d=t[0],f=t[1],g=(f-u)/(d-h);let _,m;s&qe.ABOVE&&!(r&qe.ABOVE)&&(_=d-(f-c)/g,i=_>=o&&_<=l),!i&&s&qe.RIGHT&&!(r&qe.RIGHT)&&(m=f-(d-l)*g,i=m>=a&&m<=c),!i&&s&qe.BELOW&&!(r&qe.BELOW)&&(_=d-(f-a)/g,i=_>=o&&_<=l),!i&&s&qe.LEFT&&!(r&qe.LEFT)&&(m=f-(d-o)*g,i=m>=a&&m<=c)}return i}function ud(n,e,t,i){if(ms(n))return mr(t);let r=[];r=[n[0],n[1],n[2],n[1],n[2],n[3],n[0],n[3]],e(r,r,2);const s=[],o=[];for(let a=0,l=r.length;a<l;a+=2)s.push(r[a]),o.push(r[a+1]);return Xp(s,o,t)}function dd(n,e){const t=e.getExtent(),i=Kt(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const r=xe(t),o=Math.floor((i[0]-t[0])/r)*r;n[0]-=o,n[2]-=o}return n}function fd(n,e,t){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];dd(n,e);const r=xe(i);if(xe(n)>r&&!t)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function Me(n,e,t){return Math.min(Math.max(n,e),t)}function Jp(n,e,t,i,r,s){const o=r-t,a=s-i;if(o!==0||a!==0){const l=((n-t)*o+(e-i)*a)/(o*o+a*a);l>1?(t=r,i=s):l>0&&(t+=o*l,i+=a*l)}return Fi(n,e,t,i)}function Fi(n,e,t,i){const r=t-n,s=i-e;return r*r+s*s}function Qp(n){const e=n.length;for(let i=0;i<e;i++){let r=i,s=Math.abs(n[i][i]);for(let a=i+1;a<e;a++){const l=Math.abs(n[a][i]);l>s&&(s=l,r=a)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let a=i+1;a<e;a++){const l=-n[a][i]/n[i][i];for(let c=i;c<e+1;c++)i==c?n[a][c]=0:n[a][c]+=l*n[i][c]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=n[i][e]/n[i][i];for(let r=i-1;r>=0;r--)n[r][e]-=n[r][i]*t[i]}return t}function gd(n){return n*180/Math.PI}function ui(n){return n*Math.PI/180}function ki(n,e){const t=n%e;return t*e<0?t+e:t}function Ft(n,e,t){return n+t*(e-n)}function _s(n,e){const t=Math.pow(10,e);return Math.round(n*t)/t}function md(n,e){return Math.round(_s(n,e))}function No(n,e){return Math.floor(_s(n,e))}function Go(n,e){return Math.ceil(_s(n,e))}function kl(n,e,t){if(n>=e&&n<t)return n;const i=t-e;return((n-e)%i+i)%i+e}const ey=63710088e-1;function Uo(n,e,t){t=t||ey;const i=ui(n[1]),r=ui(e[1]),s=(r-i)/2,o=ui(e[0]-n[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function _d(...n){console.warn(...n)}function pd(n,e){const t=(""+n).split("."),i=(""+e).split(".");for(let r=0;r<Math.max(t.length,i.length);r++){const s=parseInt(t[r]||"0",10),o=parseInt(i[r]||"0",10);if(s>o)return 1;if(o>s)return-1}return 0}function yd(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function Bo(n,e){let t=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function Nl(n,e){const t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,s=n[1]*t+n[0]*i;return n[0]=r,n[1]=s,n}function xd(n,e){return n[0]*=e,n[1]*=e,n}function vd(n,e){if(e.canWrapX()){const t=xe(e.getExtent()),i=ty(n,e,t);i&&(n[0]-=i*t)}return n}function ty(n,e,t){const i=e.getExtent();let r=0;return e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(t=t||xe(i),r=Math.floor((n[0]-i[0])/t)),r}const pr={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class Gl{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||pr[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const ps=6378137,yr=Math.PI*ps,ny=[-yr,-yr,yr,yr],iy=[-180,-85,180,85],zo=ps*Math.log(Math.tan(Math.PI/2));class xr extends Gl{constructor(e){super({code:e,units:"m",extent:ny,global:!0,worldExtent:iy,getPointResolution:function(t,i){return t/Math.cosh(i[1]/ps)}})}}const Ed=[new xr("EPSG:3857"),new xr("EPSG:102100"),new xr("EPSG:102113"),new xr("EPSG:900913"),new xr("http://www.opengis.net/def/crs/EPSG/0/3857"),new xr("http://www.opengis.net/gml/srs/epsg.xml#3857")];function ry(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i){e[s]=yr*n[s]/180;let o=ps*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>zo?o=zo:o<-zo&&(o=-zo),e[s+1]=o}return e}function sy(n,e,t,i){const r=n.length;t=t>1?t:2,i=i??t,e===void 0&&(t>2?e=n.slice():e=new Array(r));for(let s=0;s<r;s+=i)e[s]=180*n[s]/yr,e[s+1]=360*Math.atan(Math.exp(n[s+1]/ps))/Math.PI-90;return e}const oy=6378137,Td=[-180,-90,180,90],ay=Math.PI*oy/180;class Ni extends Gl{constructor(e,t){super({code:e,units:"degrees",extent:Td,axisOrientation:t,global:!0,metersPerUnit:ay,worldExtent:Td})}}const wd=[new Ni("CRS:84"),new Ni("EPSG:4326","neu"),new Ni("urn:ogc:def:crs:OGC:1.3:CRS84"),new Ni("urn:ogc:def:crs:OGC:2:84"),new Ni("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Ni("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Ni("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Ul={};function ly(n){return Ul[n]||Ul[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function cy(n,e){Ul[n]=e}let vr={};function ys(n,e,t){const i=n.getCode(),r=e.getCode();i in vr||(vr[i]={}),vr[i][r]=t}function Bl(n,e){return n in vr&&e in vr[n]?vr[n][e]:null}const Wo=.9996,Ut=.00669438,Yo=Ut*Ut,$o=Yo*Ut,Gi=Ut/(1-Ut),Sd=Math.sqrt(1-Ut),Er=(1-Sd)/(1+Sd),bd=Er*Er,zl=bd*Er,Wl=zl*Er,Cd=Wl*Er,Rd=1-Ut/4-3*Yo/64-5*$o/256,hy=3*Ut/8+3*Yo/32+45*$o/1024,uy=15*Yo/256+45*$o/1024,dy=35*$o/3072,fy=3/2*Er-27/32*zl+269/512*Cd,gy=21/16*bd-55/32*Wl,my=151/96*zl-417/128*Cd,_y=1097/512*Wl,jo=6378137;function py(n,e,t){const i=n-5e5,o=(t.north?e:e-1e7)/Wo/(jo*Rd),a=o+fy*Math.sin(2*o)+gy*Math.sin(4*o)+my*Math.sin(6*o)+_y*Math.sin(8*o),l=Math.sin(a),c=l*l,h=Math.cos(a),u=l/h,d=u*u,f=d*d,g=1-Ut*c,_=Math.sqrt(1-Ut*c),m=jo/_,y=(1-Ut)/g,p=Gi*h**2,E=p*p,x=i/(m*Wo),v=x*x,S=v*x,w=S*x,b=w*x,P=b*x,D=a-u/y*(v/2-w/24*(5+3*d+10*p-4*E-9*Gi))+P/720*(61+90*d+298*p+45*f-252*Gi-3*E);let G=(x-S/6*(1+2*d+p)+b/120*(5-2*p+28*d-3*E+8*Gi+24*f))/h;return G=kl(G+ui(Ad(t.number)),-Math.PI,Math.PI),[gd(G),gd(D)]}const Pd=-80,Id=84,yy=-180,xy=180;function vy(n,e,t){n=kl(n,yy,xy),e<Pd?e=Pd:e>Id&&(e=Id);const i=ui(e),r=Math.sin(i),s=Math.cos(i),o=r/s,a=o*o,l=a*a,c=ui(n),h=Ad(t.number),u=ui(h),d=jo/Math.sqrt(1-Ut*r**2),f=Gi*s**2,g=s*kl(c-u,-Math.PI,Math.PI),_=g*g,m=_*g,y=m*g,p=y*g,E=p*g,x=jo*(Rd*i-hy*Math.sin(2*i)+uy*Math.sin(4*i)-dy*Math.sin(6*i)),v=Wo*d*(g+m/6*(1-a+f)+p/120*(5-18*a+l+72*f-58*Gi))+5e5;let S=Wo*(x+d*o*(_/2+y/24*(5-a+9*f+4*f**2)+E/720*(61-58*a+l+600*f-330*Gi)));return t.north||(S+=1e7),[v,S]}function Ad(n){return(n-1)*6-180+3}const Ey=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function Ld(n){let e=0;for(const r of Ey){const s=n.match(r);if(s){e=parseInt(s[1]);break}}if(!e)return null;let t=0,i=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(i=!0,t=e-32600),t?{number:t,north:i}:null}function Md(n,e){return function(t,i,r,s){const o=t.length;r=r>1?r:2,s=s??r,i||(r>2?i=t.slice():i=new Array(o));for(let a=0;a<o;a+=s){const l=t[a],c=t[a+1],h=n(l,c,e);i[a]=h[0],i[a+1]=h[1]}return i}}function Ty(n){return Ld(n)?new Gl({code:n,units:"m"}):null}function wy(n){const e=Ld(n.getCode());return e?{forward:Md(vy,e),inverse:Md(py,e)}:null}const Sy=[wy],by=[Ty];let Yl=!0;function Od(n){Yl=!1}function $l(n,e){if(e!==void 0){for(let t=0,i=n.length;t<i;++t)e[t]=n[t];e=e}else e=n.slice();return e}function jl(n){cy(n.getCode(),n),ys(n,n,$l)}function Cy(n){n.forEach(jl)}function Pe(n){if(typeof n!="string")return n;const e=ly(n);if(e)return e;for(const t of by){const i=t(n);if(i)return i}return null}function Vo(n,e,t,i){n=Pe(n);let r;const s=n.getPointResolutionFunc();if(s){if(r=s(e,t),i&&i!==n.getUnits()){const o=n.getMetersPerUnit();o&&(r=r*o/pr[i])}}else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=e;else{const a=Ho(n,Pe("EPSG:4326"));if(!a&&o!=="degrees")r=e*n.getMetersPerUnit();else{let c=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];c=a(c,c,2);const h=Uo(c.slice(0,2),c.slice(2,4)),u=Uo(c.slice(4,6),c.slice(6,8));r=(h+u)/2}const l=i?pr[i]:n.getMetersPerUnit();l!==void 0&&(r/=l)}}return r}function Dd(n){Cy(n),n.forEach(function(e){n.forEach(function(t){e!==t&&ys(e,t,$l)})})}function Ry(n,e,t,i){n.forEach(function(r){e.forEach(function(s){ys(r,s,t),ys(s,r,i)})})}function Vl(n,e){return n?typeof n=="string"?Pe(n):n:Pe(e)}function Py(n){return function(e,t,i,r){const s=e.length;i=i!==void 0?i:2,r=r??i,t=t!==void 0?t:new Array(s);for(let o=0;o<s;o+=r){const a=n(e.slice(o,o+i)),l=a.length;for(let c=0,h=r;c<h;++c)t[o+c]=c>=l?e[o+c]:a[c]}return t}}function Iy(n,e){return Od(),Zt(n,"EPSG:4326","EPSG:3857")}function Xo(n,e){if(n===e)return!0;const t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||Ho(n,e)===$l)&&t}function Ho(n,e){const t=n.getCode(),i=e.getCode();let r=Bl(t,i);if(r)return r;let s=null,o=null;for(const l of Sy)s||(s=l(n)),o||(o=l(e));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)r=Xl(s.inverse,o.forward);else{const l=Bl(t,a);l&&(r=Xl(l,o.forward))}else{const l=Bl(a,i);l&&(r=Xl(s.inverse,l))}return r&&(jl(n),jl(e),ys(n,e,r)),r}function Xl(n,e){return function(t,i,r,s){return i=n(t,i,r,s),e(i,i,r,s)}}function Tr(n,e){const t=Pe(n),i=Pe(e);return Ho(t,i)}function Zt(n,e,t){const i=Tr(e,t);if(!i){const r=Pe(e).getCode(),s=Pe(t).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function Ay(n,e,t,i){const r=Tr(e,t);return ud(n,r,void 0)}function Hl(n,e){return n}function Dn(n,e){return Yl&&!Bo(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(Yl=!1,_d("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function Fd(n,e){return n}function di(n,e){return n}function Ly(){Dd(Ed),Dd(wd),Ry(wd,Ed,ry,sy)}Ly();const My=new Array(6);function Ve(){return[1,0,0,1,0,0]}function Kl(n,e){const t=n[0],i=n[1],r=n[2],s=n[3],o=n[4],a=n[5],l=e[0],c=e[1],h=e[2],u=e[3],d=e[4],f=e[5];return n[0]=t*l+r*c,n[1]=i*l+s*c,n[2]=t*h+r*u,n[3]=i*h+s*u,n[4]=t*d+r*f+o,n[5]=i*d+s*f+a,n}function Oy(n,e,t,i,r,s,o){return n[0]=e,n[1]=t,n[2]=i,n[3]=r,n[4]=s,n[5]=o,n}function kd(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function Ne(n,e){const t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function Dy(n,e,t){return Kl(n,Oy(My,1,0,0,1,e,t))}function qt(n,e,t,i,r,s,o,a){const l=Math.sin(s),c=Math.cos(s);return n[0]=i*c,n[1]=r*l,n[2]=-i*l,n[3]=r*c,n[4]=o*i*c-a*i*l+e,n[5]=o*r*l+a*r*c+t,n}function xs(n,e){const t=Fy(e);fe(t!==0,"Transformation matrix cannot be inverted");const i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5];return n[0]=o/t,n[1]=-r/t,n[2]=-s/t,n[3]=i/t,n[4]=(s*l-o*a)/t,n[5]=-(i*l-r*a)/t,n}function Fy(n){return n[0]*n[3]-n[1]*n[2]}const ky=[1e5,1e5,1e5,1e5,2,2];function Ny(n){return"matrix("+n.join(", ")+")"}function Nd(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function Gy(n,e){const t=Nd(n),i=Nd(e);for(let r=0;r<6;++r)if(Math.round((t[r]-i[r])*ky[r])!==0)return!1;return!0}function gn(n,e,t,i,r,s,o){s=s||[],o=o||2;let a=0;for(let l=e;l<t;l+=i){const c=n[l],h=n[l+1];s[a++]=r[0]*c+r[2]*h+r[4],s[a++]=r[1]*c+r[3]*h+r[5];for(let u=2;u<o;u++)s[a++]=n[l+u]}return s&&s.length!=a&&(s.length=a),s}function Gd(n,e,t,i,r,s,o){o=o||[];const a=Math.cos(r),l=Math.sin(r),c=s[0],h=s[1];let u=0;for(let d=e;d<t;d+=i){const f=n[d]-c,g=n[d+1]-h;o[u++]=c+f*a-g*l,o[u++]=h+f*l+g*a;for(let _=d+2;_<d+i;++_)o[u++]=n[_]}return o&&o.length!=u&&(o.length=u),o}function Uy(n,e,t,i,r,s,o,a){a=a||[];const l=o[0],c=o[1];let h=0;for(let u=e;u<t;u+=i){const d=n[u]-l,f=n[u+1]-c;a[h++]=l+r*d,a[h++]=c+s*f;for(let g=u+2;g<u+i;++g)a[h++]=n[g]}return a&&a.length!=h&&(a.length=h),a}function By(n,e,t,i,r,s,o){o=o||[];let a=0;for(let l=e;l<t;l+=i){o[a++]=n[l]+r,o[a++]=n[l+1]+s;for(let c=l+2;c<l+i;++c)o[a++]=n[c]}return o&&o.length!=a&&(o.length=a),o}const Ud=Ve(),zy=[NaN,NaN];class Bd extends St{constructor(){super(),this.extent_=ft(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=nd((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return Q()}closestPointXY(e,t,i,r){return Q()}containsXY(e,t){return this.closestPointXY(e,t,zy,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return Q()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&mr(t),this.extentRevision_=this.getRevision()}return Zp(this.extent_,e)}rotate(e,t){Q()}scale(e,t,i){Q()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return Q()}getType(){return Q()}applyTransform(e){Q()}intersectsExtent(e){return Q()}translate(e,t){Q()}transform(e,t){const i=Pe(e),r=i.getUnits()=="tile-pixels"?function(s,o,a){const l=i.getExtent(),c=i.getWorldExtent(),h=st(c)/st(l);qt(Ud,c[0],c[3],h,-h,0,0,0);const u=gn(s,0,s.length,a,Ud,o),d=Tr(i,t);return d?d(u,u,a):u}:Tr(i,t);return this.applyTransform(r),this}}class Ui extends Bd{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return Ol(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return Q()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=zd(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){Q()}setLayout(e,t,i){let r;if(e)r=zd(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}r=t.length,e=Bi(r)}this.layout=e,this.stride=r}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();Gd(i,0,i.length,r,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=Kt(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();Uy(r,0,r.length,s,e,t,i,r),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const r=this.getStride();By(i,0,i.length,r,e,t,i),this.changed()}}}function Bi(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function zd(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function Wy(n,e,t){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return gn(i,0,i.length,r,e,t)}function Wd(n,e,t,i){let r=0;const s=n[t-i],o=n[t-i+1];let a=0,l=0;for(;e<t;e+=i){const c=n[e]-s,h=n[e+1]-o;r+=l*c-a*h,a=c,l=h}return r/2}function Yd(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const a=t[s];r+=Wd(n,e,a,i),e=a}return r}function Yy(n,e,t,i){let r=0;for(let s=0,o=t.length;s<o;++s){const a=t[s];r+=Yd(n,e,a,i),e=a[a.length-1]}return r}function $d(n,e,t,i,r,s,o){const a=n[e],l=n[e+1],c=n[t]-a,h=n[t+1]-l;let u;if(c===0&&h===0)u=e;else{const d=((r-a)*c+(s-l)*h)/(c*c+h*h);if(d>1)u=t;else if(d>0){for(let f=0;f<i;++f)o[f]=Ft(n[e+f],n[t+f],d);o.length=i;return}else u=e}for(let d=0;d<i;++d)o[d]=n[u+d];o.length=i}function Zl(n,e,t,i,r){let s=n[e],o=n[e+1];for(e+=i;e<t;e+=i){const a=n[e],l=n[e+1],c=Fi(s,o,a,l);c>r&&(r=c),s=a,o=l}return r}function ql(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];r=Zl(n,e,a,i,r),e=a}return r}function $y(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];r=ql(n,e,a,i,r),e=a[a.length-1]}return r}function Jl(n,e,t,i,r,s,o,a,l,c,h){if(e==t)return c;let u,d;if(r===0){if(d=Fi(o,a,n[e],n[e+1]),d<c){for(u=0;u<i;++u)l[u]=n[e+u];return l.length=i,d}return c}h=h||[NaN,NaN];let f=e+i;for(;f<t;)if($d(n,f-i,f,i,o,a,h),d=Fi(o,a,h[0],h[1]),d<c){for(c=d,u=0;u<i;++u)l[u]=h[u];l.length=i,f+=i}else f+=i*Math.max((Math.sqrt(d)-Math.sqrt(c))/r|0,1);if(s&&($d(n,t-i,e,i,o,a,h),d=Fi(o,a,h[0],h[1]),d<c)){for(c=d,u=0;u<i;++u)l[u]=h[u];l.length=i}return c}function Ql(n,e,t,i,r,s,o,a,l,c,h){h=h||[NaN,NaN];for(let u=0,d=t.length;u<d;++u){const f=t[u];c=Jl(n,e,f,i,r,s,o,a,l,c,h),e=f}return c}function jy(n,e,t,i,r,s,o,a,l,c,h){h=h||[NaN,NaN];for(let u=0,d=t.length;u<d;++u){const f=t[u];c=Ql(n,e,f,i,r,s,o,a,l,c,h),e=f[f.length-1]}return c}function Vy(n,e,t,i){for(let r=0,s=t.length;r<s;++r)n[e++]=t[r];return e}function Ko(n,e,t,i){for(let r=0,s=t.length;r<s;++r){const o=t[r];for(let a=0;a<i;++a)n[e++]=o[a]}return e}function vs(n,e,t,i,r){r=r||[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=Ko(n,e,t[o],i);r[s++]=l,e=l}return r.length=s,r}function jd(n,e,t,i,r){r=r||[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=vs(n,e,t[o],i,r[s]);l.length===0&&(l[0]=e),r[s++]=l,e=l[l.length-1]}return r.length=s,r}function fi(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=e;o<t;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function Es(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=t[o];r[s++]=fi(n,e,l,i,r[s]),e=l}return r.length=s,r}function ec(n,e,t,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=t[o];r[s++]=l.length===1&&l[0]===e?[]:Es(n,e,l,i,r[s]),e=l[l.length-1]}return r.length=s,r}function Zo(n,e,t,i,r,s,o){const a=(t-e)/i;if(a<3){for(;e<t;e+=i)s[o++]=n[e],s[o++]=n[e+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const c=[e,t-i];let h=0;for(;c.length>0;){const u=c.pop(),d=c.pop();let f=0;const g=n[d],_=n[d+1],m=n[u],y=n[u+1];for(let p=d+i;p<u;p+=i){const E=n[p],x=n[p+1],v=Jp(E,x,g,_,m,y);v>f&&(h=p,f=v)}f>r&&(l[(h-e)/i]=1,d+i<h&&c.push(d,h),h+i<u&&c.push(h,u))}for(let u=0;u<a;++u)l[u]&&(s[o++]=n[e+u*i],s[o++]=n[e+u*i+1]);return o}function Vd(n,e,t,i,r,s,o,a){for(let l=0,c=t.length;l<c;++l){const h=t[l];o=Zo(n,e,h,i,r,s,o),a.push(o),e=h}return o}function zi(n,e){return e*Math.round(n/e)}function Xy(n,e,t,i,r,s,o){if(e==t)return o;let a=zi(n[e],r),l=zi(n[e+1],r);e+=i,s[o++]=a,s[o++]=l;let c,h;do if(c=zi(n[e],r),h=zi(n[e+1],r),e+=i,e==t)return s[o++]=c,s[o++]=h,o;while(c==a&&h==l);for(;e<t;){const u=zi(n[e],r),d=zi(n[e+1],r);if(e+=i,u==c&&d==h)continue;const f=c-a,g=h-l,_=u-a,m=d-l;if(f*m==g*_&&(f<0&&_<f||f==_||f>0&&_>f)&&(g<0&&m<g||g==m||g>0&&m>g)){c=u,h=d;continue}s[o++]=c,s[o++]=h,a=c,l=h,c=u,h=d}return s[o++]=c,s[o++]=h,o}function tc(n,e,t,i,r,s,o,a){for(let l=0,c=t.length;l<c;++l){const h=t[l];o=Xy(n,e,h,i,r,s,o),a.push(o),e=h}return o}function Hy(n,e,t,i,r,s,o,a){for(let l=0,c=t.length;l<c;++l){const h=t[l],u=[];o=tc(n,e,h,i,r,s,o,u),a.push(u),e=h[h.length-1]}return o}class Ts extends Ui{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new Ts(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,r){return r<Mi(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Zl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Jl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,r))}getArea(){return Wd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return fi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=Zo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new Ts(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ko(this.flatCoordinates,0,e,this.stride),this.changed()}}class Jt extends Ui{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new Jt(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){const s=this.flatCoordinates,o=Fi(e,t,s[0],s[1]);if(o<r){const a=this.stride;for(let l=0;l<a;++l)i[l]=s[l];return i.length=a,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return Ml(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return Al(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Vy(this.flatCoordinates,0,e,this.stride),this.changed()}}function Ky(n,e,t,i,r){return!cd(r,function(o){return!Wi(n,e,t,i,o[0],o[1])})}function Wi(n,e,t,i,r,s){let o=0,a=n[t-i],l=n[t-i+1];for(;e<t;e+=i){const c=n[e],h=n[e+1];l<=s?h>s&&(c-a)*(s-l)-(r-a)*(h-l)>0&&o++:h<=s&&(c-a)*(s-l)-(r-a)*(h-l)<0&&o--,a=c,l=h}return o!==0}function nc(n,e,t,i,r,s){if(t.length===0||!Wi(n,e,t[0],i,r,s))return!1;for(let o=1,a=t.length;o<a;++o)if(Wi(n,t[o-1],t[o],i,r,s))return!1;return!0}function Zy(n,e,t,i,r,s){if(t.length===0)return!1;for(let o=0,a=t.length;o<a;++o){const l=t[o];if(nc(n,e,l,i,r,s))return!0;e=l[l.length-1]}return!1}function ic(n,e,t,i,r,s,o){let a,l,c,h,u,d,f;const g=r[s+1],_=[];for(let p=0,E=t.length;p<E;++p){const x=t[p];for(h=n[x-i],d=n[x-i+1],a=e;a<x;a+=i)u=n[a],f=n[a+1],(g<=d&&f<=g||d<=g&&g<=f)&&(c=(g-d)/(f-d)*(u-h)+h,_.push(c)),h=u,d=f}let m=NaN,y=-1/0;for(_.sort(In),h=_[0],a=1,l=_.length;a<l;++a){u=_[a];const p=Math.abs(u-h);p>y&&(c=(h+u)/2,nc(n,e,t,i,c,g)&&(m=c,y=p)),h=u}return isNaN(m)&&(m=r[s]),o?(o.push(m,g,y),o):[m,g,y]}function Xd(n,e,t,i,r){let s=[];for(let o=0,a=t.length;o<a;++o){const l=t[o];s=ic(n,e,l,i,r,2*o,s),e=l[l.length-1]}return s}function Hd(n,e,t,i,r){let s;for(e+=i;e<t;e+=i)if(s=r(n.slice(e-i,e),n.slice(e,e+i)),s)return s;return!1}function qo(n,e,t,i,r,s){return s=s??ld(ft(),n,e,t,i),gt(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:Hd(n,e,t,i,function(o,a){return qp(r,o,a)}):!1}function qy(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){if(qo(n,e,t[s],i,r))return!0;e=t[s]}return!1}function Kd(n,e,t,i,r){return!!(qo(n,e,t,i,r)||Wi(n,e,t,i,r[0],r[1])||Wi(n,e,t,i,r[0],r[3])||Wi(n,e,t,i,r[2],r[1])||Wi(n,e,t,i,r[2],r[3]))}function Zd(n,e,t,i,r){if(!Kd(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(Ky(n,t[s-1],t[s],i,r)&&!qo(n,t[s-1],t[s],i,r))return!1;return!0}function Jy(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];if(Zd(n,e,a,i,r))return!0;e=a[a.length-1]}return!1}function Qy(n,e,t,i){for(;e<t-i;){for(let r=0;r<i;++r){const s=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=s}e+=i,t-=i}}function rc(n,e,t,i){let r=0,s=n[t-i],o=n[t-i+1];for(;e<t;e+=i){const a=n[e],l=n[e+1];r+=(a-s)*(l+o),s=a,o=l}return r===0?void 0:r>0}function sc(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],l=rc(n,e,a,i);if(s===0){if(r&&l||!r&&!l)return!1}else if(r&&!l||!r&&l)return!1;e=a}return!0}function qd(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s){const a=t[s];if(!sc(n,e,a,i,r))return!1;a.length&&(e=a[a.length-1])}return!0}function Jo(n,e,t,i,r){r=r!==void 0?r:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],l=rc(n,e,a,i);(s===0?r&&l||!r&&!l:r&&!l||!r&&l)&&Qy(n,e,a,i),e=a}return e}function oc(n,e,t,i,r){for(let s=0,o=t.length;s<o;++s)e=Jo(n,e,t[s],i,r);return e}function Jd(n,e){const t=[];let i=0,r=0,s;for(let o=0,a=e.length;o<a;++o){const l=e[o],c=rc(n,i,l,2);if(s===void 0&&(s=c),c===s)t.push(e.slice(r,o+1));else{if(t.length===0)continue;t[t.length-1].push(e[r])}r=o+1,i=l}return t}class gi extends Ui{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?dn(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new gi(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Mi(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ql(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ql(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return nc(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return Yd(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),Jo(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Es(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=Kt(this.getExtent());this.flatInteriorPoint_=ic(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Jt(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Ts(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const l=i[o],c=new Ts(t.slice(s,l),e);r.push(c),s=l}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;sc(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=Jo(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=tc(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new gi(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return Zd(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=vs(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function Qd(n){if(ms(n))throw new Error("Cannot create polygon from empty extent");const e=n[0],t=n[1],i=n[2],r=n[3],s=[e,t,e,r,i,r,i,t,e,t];return new gi(s,"XY",[s.length])}function Qo(n,e,t,i,r,s,o){let a,l;const c=(t-e)/i;if(c===1)a=e;else if(c===2)a=e,l=r;else if(c!==0){let h=n[e],u=n[e+1],d=0;const f=[0];for(let m=e+i;m<t;m+=i){const y=n[m],p=n[m+1];d+=Math.sqrt((y-h)*(y-h)+(p-u)*(p-u)),f.push(d),h=y,u=p}const g=r*d,_=Up(f,g);_<0?(l=(g-f[-_-2])/(f[-_-1]-f[-_-2]),a=e+(-_-2)*i):a=e+_*i}o=o>1?o:2,s=s||new Array(o);for(let h=0;h<o;++h)s[h]=a===void 0?NaN:l===void 0?n[a+h]:Ft(n[a+h],n[a+i+h],l);return s}function ac(n,e,t,i,r,s){if(t==e)return null;let o;if(r<n[e+i-1])return s?(o=n.slice(e,e+i),o[i-1]=r,o):null;if(n[t-1]<r)return s?(o=n.slice(t-i,t),o[i-1]=r,o):null;if(r==n[e+i-1])return n.slice(e,e+i);let a=e/i,l=t/i;for(;a<l;){const d=a+l>>1;r<n[(d+1)*i-1]?l=d:a=d+1}const c=n[a*i-1];if(r==c)return n.slice((a-1)*i,(a-1)*i+i);const h=n[(a+1)*i-1],u=(r-c)/(h-c);o=[];for(let d=0;d<i-1;++d)o.push(Ft(n[(a-1)*i+d],n[a*i+d],u));return o.push(r),o}function e0(n,e,t,i,r,s,o){if(o)return ac(n,e,t[t.length-1],i,r,s);let a;if(r<n[i-1])return s?(a=n.slice(0,i),a[i-1]=r,a):null;if(n[n.length-1]<r)return s?(a=n.slice(n.length-i),a[i-1]=r,a):null;for(let l=0,c=t.length;l<c;++l){const h=t[l];if(e!=h){if(r<n[e+i-1])return null;if(r<=n[h-1])return ac(n,e,h,i,r,!1);e=h}}return null}function lc(n,e,t,i){let r=n[e],s=n[e+1],o=0;for(let a=e+i;a<t;a+=i){const l=n[a],c=n[a+1];o+=Math.sqrt((l-r)*(l-r)+(c-s)*(c-s)),r=l,s=c}return o}class wr extends Ui{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){dn(this.flatCoordinates,e),this.changed()}clone(){const e=new wr(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Mi(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Zl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Jl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,i,r))}forEachSegment(e){return Hd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,ac(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return fi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return Qo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return lc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const t=[];return t.length=Zo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new wr(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return qo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ko(this.flatCoordinates,0,e,this.stride),this.changed()}}const Je={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},Yi=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",t0=Yi.includes("safari")&&!Yi.includes("chrom")&&(Yi.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Yi)),n0=Yi.includes("webkit")&&!Yi.includes("edge"),ef=Yi.includes("macintosh"),i0=typeof devicePixelRatio<"u"?devicePixelRatio:1,cc=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,tf=typeof Image<"u"&&Image.prototype.decode,nf=function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n}(),ce={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function ze(n,e,t,i){let r;return t&&t.length?r=t.shift():cc?r=new OffscreenCanvas(n||300,e||300):r=document.createElement("canvas"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}let hc;function ea(){return hc||(hc=ze(1,1)),hc}function ta(n){const e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function r0(n){let e=n.offsetWidth;const t=getComputedStyle(n);return e+=parseInt(t.marginLeft,10)+parseInt(t.marginRight,10),e}function s0(n){let e=n.offsetHeight;const t=getComputedStyle(n);return e+=parseInt(t.marginTop,10)+parseInt(t.marginBottom,10),e}function rf(n,e){const t=e.parentNode;t&&t.replaceChild(n,e)}function sf(n){for(;n.lastChild;)n.lastChild.remove()}function o0(n,e){const t=n.childNodes;for(let i=0;;++i){const r=t[i],s=e[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}const uc=[NaN,NaN,NaN,0];let dc;function a0(){return dc||(dc=ze(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),dc}const l0=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,c0=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,h0=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,u0=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function na(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function ws(n){throw new Error('failed to parse "'+n+'" as color')}function of(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(c0)||n.match(l0)||n.match(h0);if(s){const o=s[4],a=100/255;return[Me(na(s[1],a)+.5|0,0,255),Me(na(s[2],a)+.5|0,0,255),Me(na(s[3],a)+.5|0,0,255),o!==void 0?Me(na(o,100),0,1):1]}ws(n)}if(n.startsWith("#")){if(u0.test(n)){const s=n.substring(1),o=s.length<=4?1:2,a=[0,0,0,255];for(let l=0,c=s.length;l<c;l+=o){let h=parseInt(s.substring(l,l+o),16);o===1&&(h+=h<<4),a[l/o]=h}return a[3]=a[3]/255,a}ws(n)}const e=a0();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&ws(n));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return of(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const r=Array.from(e.getImageData(0,0,1,1).data);return r[3]=_s(r[3]/255,3),r}function Fn(n){return typeof n=="string"?n:xc(n)}const d0=1024,Ss={};let fc=0;function f0(n){if(n.length===4)return n;const e=n.slice();return e[3]=1,e}function gc(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function mc(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function _c(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function pc(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function af(n){const e=_c(n[0]),t=_c(n[1]),i=_c(n[2]),r=pc(e*.222488403+t*.716873169+i*.06060791),s=500*(pc(e*.452247074+t*.399439023+i*.148375274)-r),o=200*(r-pc(e*.016863605+t*.117638439+i*.865350722)),a=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),a<0?a+360:a,n[3]]}function g0(n){const e=(n[0]+16)/116,t=n[1],i=n[2]*Math.PI/180,r=mc(e),s=mc(e+t/500*Math.cos(i)),o=mc(e-t/200*Math.sin(i)),a=gc(s*3.021973625-r*1.617392459-o*.404875592),l=gc(s*-.943766287+r*1.916279586+o*.027607165),c=gc(s*.069407491-r*.22898585+o*1.159737864);return[Me(a+.5|0,0,255),Me(l+.5|0,0,255),Me(c+.5|0,0,255),n[3]]}function yc(n){if(n==="none")return uc;if(Ss.hasOwnProperty(n))return Ss[n];if(fc>=d0){let t=0;for(const i in Ss)t++&3||(delete Ss[i],--fc)}const e=of(n);e.length!==4&&ws(n);for(const t of e)isNaN(t)&&ws(n);return Ss[n]=e,++fc,e}function Qt(n){return Array.isArray(n)?n:yc(n)}function xc(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+r+")"}function m0(n,e,t){const i=n;let r=!0,s=!1,o=!1;const a=[Mo(i,re.LOAD,function(){o=!0,s||e()})];return i.src&&tf?(s=!0,i.decode().then(function(){r&&e()}).catch(function(l){r&&(o?e():t())})):a.push(Mo(i,re.ERROR,t)),function(){r=!1,a.forEach(be)}}function _0(n,e){return new Promise((t,i)=>{function r(){o(),t(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function p0(n,e){return e&&(n.src=e),n.src&&tf?new Promise((t,i)=>n.decode().then(()=>t(n)).catch(r=>n.complete&&n.width?t(n):i(r))):_0(n)}class y0{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];!(e++&3)&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const r=vc(e,t,i);return r in this.cache_?this.cache_[r]:null}getPattern(e,t,i){const r=vc(e,t,i);return r in this.patternCache_?this.patternCache_[r]:null}set(e,t,i,r,s){const o=vc(e,t,i),a=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===ce.IDLE&&r.load(),r.getImageState()===ce.LOADING?r.ready().then(()=>{this.patternCache_[o]=ea().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=ea().createPattern(r.getImage(1),"repeat")),a||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function vc(n,e,t){const i=t?Qt(t):"null";return e+":"+n+":"+i}const Bt=new y0;let bs=null;class lf extends Lo{constructor(e,t,i,r,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?ce.IDLE:r,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===ce.LOADED){bs||(bs=ze(1,1,void 0,{willReadFrequently:!0})),bs.drawImage(this.image_,0,0);try{bs.getImageData(0,0,1,1),this.tainted_=!1}catch{bs=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(re.CHANGE)}handleImageError_(){this.imageState_=ce.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=ce.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=ze(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===ce.IDLE){this.image_||this.initializeImage_(),this.imageState_=ce.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&p0(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==ce.LOADED)return;const t=this.image_,i=ze(Math.ceil(t.width*e),Math.ceil(t.height*e)),r=i.canvas;i.scale(e,e),i.drawImage(t,0,0),i.globalCompositeOperation="multiply",i.fillStyle=Fn(this.color_),i.fillRect(0,0,r.width/e,r.height/e),i.globalCompositeOperation="destination-in",i.drawImage(t,0,0),this.canvas_[e]=r}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===ce.LOADED||this.imageState_===ce.ERROR)e();else{const t=()=>{(this.imageState_===ce.LOADED||this.imageState_===ce.ERROR)&&(this.removeEventListener(re.CHANGE,t),e())};this.addEventListener(re.CHANGE,t)}})),this.ready_}}function Ec(n,e,t,i,r,s){let o=e===void 0?void 0:Bt.get(e,t,r);return o||(o=new lf(n,n&&"src"in n?n.src||void 0:e,t,i,r),Bt.set(e,t,r,o,s)),s&&o&&!Bt.getPattern(e,t,r)&&Bt.set(e,t,r,o,s),o}function mn(n){return n?Array.isArray(n)?xc(n):typeof n=="object"&&"src"in n?x0(n):n:null}function x0(n){if(!n.offset||!n.size)return Bt.getPattern(n.src,"anonymous",n.color);const e=n.src+":"+n.offset,t=Bt.getPattern(e,void 0,n.color);if(t)return t;const i=Bt.get(n.src,"anonymous",null);if(i.getImageState()!==ce.LOADED)return null;const r=ze(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),Ec(r.canvas,e,void 0,ce.LOADED,n.color,!0),Bt.getPattern(e,void 0,n.color)}class cf{drawCustom(e,t,i,r,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}const ia="ol-hidden",v0="ol-selectable",Cs="ol-unselectable",Tc="ol-control",hf="ol-collapsed",E0=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),uf=["style","variant","weight","size","lineHeight","family"],wc={normal:400,bold:700},Sc=function(n){const e=n.match(E0);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=uf.length;i<r;++i){const s=e[i+1];s!==void 0&&(t[uf[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(t.weight))&&t.weight in wc&&(t.weight=wc[t.weight]),t.families=t.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),t},df="10px sans-serif",bt="#000",Sr="round",kn=[],Nn=0,br="round",Rs=10,Ps="#000",Is="center",ra="middle",$i=[0,0,0,0],As=1,Cr=new St;let Ls=null,ff;const bc={},T0=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function w0(n,e,t){return`${n} ${e} 16px "${t}"`}const S0=function(){let e,t;async function i(s){await t.ready;const o=await t.load(s);if(o.length===0)return!1;const a=Sc(s),l=a.families[0].toLowerCase(),c=a.weight;return o.some(h=>{const u=h.family.replace(/^['"]|['"]$/g,"").toLowerCase(),d=wc[h.weight]||h.weight;return u===l&&h.style===a.style&&d==c})}async function r(){await t.ready;let s=!0;const o=Cr.getProperties(),a=Object.keys(o).filter(l=>o[l]<100);for(let l=a.length-1;l>=0;--l){const c=a[l];let h=o[c];h<100&&(await i(c)?(dr(bc),Cr.set(c,100)):(h+=10,Cr.set(c,h,!0),h<100&&(s=!1)))}e=void 0,s||(e=setTimeout(r,100))}return async function(s){t||(t=cc?self.fonts:document.fonts);const o=Sc(s);if(!o)return;const a=o.families;let l=!1;for(const c of a){if(T0.has(c))continue;const h=w0(o.style,o.weight,c);Cr.get(h)===void 0&&(Cr.set(h,0,!0),l=!0)}l&&(clearTimeout(e),e=setTimeout(r,100))}}(),b0=function(){let n;return function(e){let t=bc[e];if(t==null){if(cc){const i=Sc(e),r=gf(e,"Žg");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);bc[e]=t}return t}}();function gf(n,e){return Ls||(Ls=ze(1,1)),n!=ff&&(Ls.font=n,ff=Ls.font),Ls.measureText(e)}function mf(n,e){return gf(n,e).width}function _f(n,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((r,s)=>Math.max(r,mf(n,s)),0);return t[e]=i,i}function C0(n,e){const t=[],i=[],r=[];let s=0,o=0,a=0,l=0;for(let c=0,h=e.length;c<=h;c+=2){const u=e[c];if(u===`
`||c===h){s=Math.max(s,o),r.push(o),o=0,a+=l,l=0;continue}const d=e[c+1]||n.font,f=mf(d,u);t.push(f),o+=f;const g=b0(d);i.push(g),l=Math.max(l,g)}return{width:s,height:a,widths:t,heights:i,lineWidths:r}}function R0(n,e,t,i,r,s,o,a,l,c,h){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=u=>u.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),i.contextInstructions?(n.translate(l,c),n.scale(h[0],h[1]),P0(i,n)):h[0]<0||h[1]<0?(n.translate(l,c),n.scale(h[0],h[1]),n.drawImage(i,r,s,o,a,0,0,o,a)):n.drawImage(i,r,s,o,a,l,c,o*h[0],a*h[1]),n.restore()}function P0(n,e){const t=n.contextInstructions;for(let i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class pf extends cf{constructor(e,t,i,r,s,o,a){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=r,this.transformRotation_=r?_s(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Ve()}drawImages_(e,t,i,r){if(!this.image_)return;const s=gn(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let h=0,u=s.length;h<u;h+=2){const d=s[h]-this.imageAnchorX_,f=s[h+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const g=d+this.imageAnchorX_,_=f+this.imageAnchorY_;qt(a,g,_,1,1,c,-g,-_),o.save(),o.transform.apply(o,a),o.translate(g,_),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,d,f,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(e,t,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=gn(e,t,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);t<i;t+=r){const l=s[t]+this.textOffsetX_,c=s[t+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,c-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,c),this.textFillState_&&o.fillText(this.text_,l,c))}}moveToLineTo_(e,t,i,r,s){const o=this.context_,a=gn(e,t,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;s&&(l-=2);for(let c=2;c<l;c+=2)o.lineTo(a[c],a[c+1]);return s&&o.closePath(),i}drawRings_(e,t,i,r){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],r,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!gt(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=Wy(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],r=t[3]-t[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,r=t.length;i<r;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!gt(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(gt(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=e.getFlatCoordinates();let s=0;const o=e.getEnds(),a=e.getStride();i.beginPath();for(let l=0,c=o.length;l<c;++l)s=this.moveToLineTo_(r,s,o[l],a,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!gt(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!gt(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let r=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let a=0,l=s.length;a<l;++a){const c=s[a];r=this.drawRings_(i,r,c,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),An(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,r=e.textAlign?e.textAlign:Is;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=r&&(i.textAlign=r,t.textAlign=r),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=r,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:r,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:mn(i||bt)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),r=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),a=t.getLineJoin(),l=t.getWidth(),c=t.getMiterLimit(),h=s||kn;this.strokeState_={lineCap:r!==void 0?r:Sr,lineDash:this.pixelRatio_===1?h:h.map(u=>u*this.pixelRatio_),lineDashOffset:(o||Nn)*this.pixelRatio_,lineJoin:a!==void 0?a:br,lineWidth:(l!==void 0?l:As)*this.pixelRatio_,miterLimit:c!==void 0?c:Rs,strokeStyle:mn(i||Ps)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),r=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const f=t.getColor();this.textFillState_={fillStyle:mn(f||bt)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const f=i.getColor(),g=i.getLineCap(),_=i.getLineDash(),m=i.getLineDashOffset(),y=i.getLineJoin(),p=i.getWidth(),E=i.getMiterLimit();this.textStrokeState_={lineCap:g!==void 0?g:Sr,lineDash:_||kn,lineDashOffset:m||Nn,lineJoin:y!==void 0?y:br,lineWidth:p!==void 0?p:As,miterLimit:E!==void 0?E:Rs,strokeStyle:mn(f||Ps)}}const r=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),a=e.getRotateWithView(),l=e.getRotation(),c=e.getScaleArray(),h=e.getText(),u=e.getTextAlign(),d=e.getTextBaseline();this.textState_={font:r!==void 0?r:df,textAlign:u!==void 0?u:Is,textBaseline:d!==void 0?d:ra},this.text_=h!==void 0?Array.isArray(h)?h.reduce((f,g,_)=>f+=_%2?" ":g,""):h:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const I0=.5,yf={Point:N0,LineString:D0,Polygon:U0,MultiPoint:G0,MultiLineString:F0,MultiPolygon:k0,GeometryCollection:O0,Circle:L0};function A0(n,e){return parseInt(J(n),10)-parseInt(J(e),10)}function xf(n,e){const t=vf(n,e);return t*t}function vf(n,e){return I0*n/e}function L0(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const l=n.getBuilder(t.getZIndex(),"Circle");l.setFillStrokeStyle(s,o),l.drawCircle(e,i,r)}const a=t.getText();if(a&&a.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i)}}function Ef(n,e,t,i,r,s,o,a){const l=[],c=t.getImage();if(c){let d=!0;const f=c.getImageState();f==ce.LOADED||f==ce.ERROR?d=!1:f==ce.IDLE&&c.load(),d&&l.push(c.ready())}const h=t.getFill();h&&h.loading()&&l.push(h.ready());const u=l.length>0;return u&&Promise.all(l).then(()=>r(null)),M0(n,e,t,i,s,o,a),u}function M0(n,e,t,i,r,s,o){const a=t.getGeometryFunction()(e);if(!a)return;const l=a.simplifyTransformed(i,r);if(t.getRenderer())Tf(n,l,t,e,o);else{const h=yf[l.getType()];h(n,l,t,e,o,s)}}function Tf(n,e,t,i,r){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let a=0,l=o.length;a<l;++a)Tf(n,o[a],t,i,r);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),r)}function O0(n,e,t,i,r,s){const o=e.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const c=yf[o[a].getType()];c(n,o[a],t,i,r,s)}}function D0(n,e,t,i,r){const s=t.getStroke();if(s){const a=n.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const a=n.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,r)}}function F0(n,e,t,i,r){const s=t.getStroke();if(s){const a=n.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(e,i,r)}const o=t.getText();if(o&&o.getText()){const a=n.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,r)}}function k0(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(o||s){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawMultiPolygon(e,i,r)}const a=t.getText();if(a&&a.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i,r)}}function N0(n,e,t,i,r,s){const o=t.getImage(),a=t.getText(),l=a&&a.getText(),c=s&&o&&l?{}:void 0;if(o){if(o.getImageState()!=ce.LOADED)return;const h=n.getBuilder(t.getZIndex(),"Image");h.setImageStyle(o,c),h.drawPoint(e,i,r)}if(l){const h=n.getBuilder(t.getZIndex(),"Text");h.setTextStyle(a,c),h.drawText(e,i,r)}}function G0(n,e,t,i,r,s){const o=t.getImage(),a=o&&o.getOpacity()!==0,l=t.getText(),c=l&&l.getText(),h=s&&a&&c?{}:void 0;if(a){if(o.getImageState()!=ce.LOADED)return;const u=n.getBuilder(t.getZIndex(),"Image");u.setImageStyle(o,h),u.drawMultiPoint(e,i,r)}if(c){const u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l,h),u.drawText(e,i,r)}}function U0(n,e,t,i,r){const s=t.getFill(),o=t.getStroke();if(s||o){const l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawPolygon(e,i,r)}const a=t.getText();if(a&&a.getText()){const l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i,r)}}let B0=!1;function z0(n,e,t,i,r,s,o){const a=new XMLHttpRequest;a.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=B0,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const c=e.getType();try{let h;c=="text"||c=="json"?h=a.responseText:c=="xml"?h=a.responseXML||a.responseText:c=="arraybuffer"&&(h=a.response),h?s(e.readFeatures(h,{extent:t,featureProjection:r}),e.readProjection(h)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function wf(n,e){return function(t,i,r,s,o){z0(n,e,t,i,r,(a,l)=>{this.addFeatures(a),s!==void 0&&s(a)},()=>{this.changed(),o!==void 0&&o()})}}function W0(n,e){return[[-1/0,-1/0,1/0,1/0]]}function Sf(n,e,t,i){const r=[];let s=ft();for(let o=0,a=t.length;o<a;++o){const l=t[o];s=Ol(n,e,l[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return r}class sa extends Bd{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(be),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let t=0,i=e.length;t<i;++t)this.changeEventsKeys_.push(he(e[t],re.CHANGE,this.changed,this))}clone(){const e=new sa(Cc(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,t,i,r){if(r<Mi(this.getExtent(),e,t))return r;const s=this.geometries_;for(let o=0,a=s.length;o<a;++o)r=s[o].closestPointXY(e,t,i,r);return r}containsXY(e,t){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)if(i[r].containsXY(e,t))return!0;return!1}computeExtent(e){mr(e);const t=this.geometries_;for(let i=0,r=t.length;i<r;++i)ad(e,t[i].getExtent());return e}getGeometries(){return Cc(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const t=this.geometries_;for(let i=0,r=t.length;i<r;++i)t[i].getType()===this.getType()?e=e.concat(t[i].getGeometriesArrayRecursive()):e.push(t[i]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=[],i=this.geometries_;let r=!1;for(let s=0,o=i.length;s<o;++s){const a=i[s],l=a.getSimplifiedGeometry(e);t.push(l),l!==a&&(r=!0)}return r?new sa(t):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const t=this.geometries_;for(let i=0,r=t.length;i<r;++i)if(t[i].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].rotate(e,t);this.changed()}scale(e,t,i){i||(i=Kt(this.getExtent()));const r=this.geometries_;for(let s=0,o=r.length;s<o;++s)r[s].scale(e,t,i);this.changed()}setGeometries(e){this.setGeometriesArray(Cc(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const t=this.geometries_;for(let i=0,r=t.length;i<r;++i)t[i].applyTransform(e);this.changed()}translate(e,t){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function Cc(n){return n.map(e=>e.clone())}class oa extends Ui{constructor(e,t,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,t);else if(t!==void 0&&i)this.setFlatCoordinates(t,e),this.ends_=i;else{const r=e,s=[],o=[];for(let l=0,c=r.length;l<c;++l){const h=r[l];dn(s,h.getFlatCoordinates()),o.push(s.length)}const a=r.length===0?this.getLayout():r[0].getLayout();this.setFlatCoordinates(a,s),this.ends_=o}}appendLineString(e){dn(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new oa(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,r){return r<Mi(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ql(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ql(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,i,r))}getCoordinateAtM(e,t,i){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(t=t!==void 0?t:!1,i=i!==void 0?i:!1,e0(this.flatCoordinates,0,this.ends_,this.stride,e,t,i))}getCoordinates(){return Es(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new wr(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,t=this.ends_,i=this.layout,r=[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=t[o],c=new wr(e.slice(s,l),i);r.push(c),s=l}return r}getLength(){const e=this.ends_;let t=0,i=0;for(let r=0,s=e.length;r<s;++r)i+=lc(this.flatCoordinates,t,e[r],this.stride),t=e[r];return i}getFlatMidpoints(){const e=[],t=this.flatCoordinates;let i=0;const r=this.ends_,s=this.stride;for(let o=0,a=r.length;o<a;++o){const l=r[o],c=Qo(t,i,l,s,.5);dn(e,c),i=l}return e}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=Vd(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,i),new oa(t,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(e){return qy(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=vs(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}class aa extends Ui{constructor(e,t){super(),t&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendPoint(e){dn(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new aa(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,r){if(r<Mi(this.getExtent(),e,t))return r;const s=this.flatCoordinates,o=this.stride;for(let a=0,l=s.length;a<l;a+=o){const c=Fi(e,t,s[a],s[a+1]);if(c<r){r=c;for(let h=0;h<o;++h)i[h]=s[a+h];i.length=o}}return r}getCoordinates(){return fi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const t=this.flatCoordinates.length/this.stride;return e<0||t<=e?null:new Jt(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,t=this.layout,i=this.stride,r=[];for(let s=0,o=e.length;s<o;s+=i){const a=new Jt(e.slice(s,s+i),t);r.push(a)}return r}getType(){return"MultiPoint"}intersectsExtent(e){const t=this.flatCoordinates,i=this.stride;for(let r=0,s=t.length;r<s;r+=i){const o=t[r],a=t[r+1];if(Al(e,o,a))return!0}return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ko(this.flatCoordinates,0,e,this.stride),this.changed()}}class la extends Ui{constructor(e,t,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(e[0])){const r=e,s=[],o=[];for(let a=0,l=r.length;a<l;++a){const c=r[a],h=s.length,u=c.getEnds();for(let d=0,f=u.length;d<f;++d)u[d]+=h;dn(s,c.getFlatCoordinates()),o.push(u)}t=r.length===0?this.getLayout():r[0].getLayout(),e=s,i=o}t!==void 0&&i?(this.setFlatCoordinates(t,e),this.endss_=i):this.setCoordinates(e,t)}appendPolygon(e){let t;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();else{const i=this.flatCoordinates.length;dn(this.flatCoordinates,e.getFlatCoordinates()),t=e.getEnds().slice();for(let r=0,s=t.length;r<s;++r)t[r]+=i}this.endss_.push(t),this.changed()}clone(){const e=this.endss_.length,t=new Array(e);for(let r=0;r<e;++r)t[r]=this.endss_[r].slice();const i=new la(this.flatCoordinates.slice(),this.layout,t);return i.applyProperties(this),i}closestPointXY(e,t,i,r){return r<Mi(this.getExtent(),e,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt($y(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),jy(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,i,r))}containsXY(e,t){return Zy(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}getArea(){return Yy(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),oc(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,ec(t,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=Sf(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Xd(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new aa(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;qd(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=oc(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=Hy(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,i),new la(t,"XY",i)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let t;if(e===0)t=0;else{const s=this.endss_[e-1];t=s[s.length-1]}const i=this.endss_[e].slice(),r=i[i.length-1];if(t!==0)for(let s=0,o=i.length;s<o;++s)i[s]-=t;return new gi(this.flatCoordinates.slice(t,r),this.layout,i)}getPolygons(){const e=this.layout,t=this.flatCoordinates,i=this.endss_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const l=i[o].slice(),c=l[l.length-1];if(s!==0)for(let u=0,d=l.length;u<d;++u)l[u]-=s;const h=new gi(t.slice(s,c),e,l);r.push(h),s=c}return r}getType(){return"MultiPolygon"}intersectsExtent(e){return Jy(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=jd(this.flatCoordinates,0,e,this.stride,this.endss_);if(i.length===0)this.flatCoordinates.length=0;else{const r=i[i.length-1];this.flatCoordinates.length=r.length===0?0:r[r.length-1]}this.changed()}}const bf=Ve();class Ct{constructor(e,t,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?Ml(this.flatCoordinates_):Ol(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=Kt(this.getExtent());this.flatInteriorPoints_=ic(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=Jd(this.flatCoordinates_,this.ends_),t=Sf(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=Xd(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=Qo(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],a=Qo(e,t,o,2,.5);dn(this.flatMidpoints_,a),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=Pe(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=st(i)/st(t);qt(bf,i[0],i[3],r,-r,0,0,0),gn(this.flatCoordinates_,0,this.flatCoordinates_.length,2,bf,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){var e;return new Ct(this.type_,this.flatCoordinates_.slice(),(e=this.ends_)==null?void 0:e.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=nd((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=Zo(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=Vd(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,r);break;case"Polygon":r=[],i.length=tc(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,r);break}return r&&(this.simplifiedGeometry_=new Ct(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}Ct.prototype.getFlatCoordinates=Ct.prototype.getOrientedFlatCoordinates;function Cf(n,e,t=0,i=n.length-1,r=Y0){for(;i>t;){if(i-t>600){const l=i-t+1,c=e-t+1,h=Math.log(l),u=.5*Math.exp(2*h/3),d=.5*Math.sqrt(h*u*(l-u)/l)*(c-l/2<0?-1:1),f=Math.max(t,Math.floor(e-c*u/l+d)),g=Math.min(i,Math.floor(e+(l-c)*u/l+d));Cf(n,e,f,g,r)}const s=n[e];let o=t,a=i;for(Ms(n,t,e),r(n[i],s)>0&&Ms(n,t,i);o<a;){for(Ms(n,o,a),o++,a--;r(n[o],s)<0;)o++;for(;r(n[a],s)>0;)a--}r(n[t],s)===0?Ms(n,t,a):(a++,Ms(n,a,i)),a<=e&&(t=a+1),e<=a&&(i=a-1)}}function Ms(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function Y0(n,e){return n<e?-1:n>e?1:0}let Rf=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!ha(e,t))return i;const r=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const a=t.children[o],l=t.leaf?r(a):a;ha(e,l)&&(t.leaf?i.push(a):Pc(e,l)?this._all(a,i):s.push(a))}t=s.pop()}return i}collides(e){let t=this.data;if(!ha(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const s=t.children[r],o=t.leaf?this.toBBox(s):s;if(ha(e,o)){if(t.leaf||Pc(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Pr([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),s=[],o=[];let a,l,c;for(;i||s.length;){if(i||(i=s.pop(),l=s[s.length-1],a=o.pop(),c=!0),i.leaf){const h=$0(e,i.children,t);if(h!==-1)return i.children.splice(h,1),s.push(i),this._condense(s),this}!c&&!i.leaf&&Pc(i,r)?(s.push(i),o.push(a),a=0,l=i,i=i.children[0]):l?(a++,i=l.children[a],c=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const s=i-t+1;let o=this._maxEntries,a;if(s<=o)return a=Pr(e.slice(t,i+1)),Rr(a,this.toBBox),a;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),a=Pr([]),a.leaf=!1,a.height=r;const l=Math.ceil(s/o),c=l*Math.ceil(Math.sqrt(o));Pf(e,t,i,c,this.compareMinX);for(let h=t;h<=i;h+=c){const u=Math.min(h+c-1,i);Pf(e,h,u,l,this.compareMinY);for(let d=h;d<=u;d+=l){const f=Math.min(d+l-1,u);a.children.push(this._build(e,d,f,r-1))}}return Rr(a,this.toBBox),a}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let s=1/0,o=1/0,a;for(let l=0;l<t.children.length;l++){const c=t.children[l],h=Rc(c),u=X0(e,c)-h;u<o?(o=u,s=h<s?h:s,a=c):u===o&&h<s&&(s=h,a=c)}t=a||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(r,this.data,t,s);for(o.children.push(e),Ds(o,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)}_split(e,t){const i=e[t],r=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,r);const o=this._chooseSplitIndex(i,s,r),a=Pr(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,Rr(i,this.toBBox),Rr(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(i,a)}_splitRoot(e,t){this.data=Pr([e,t]),this.data.height=e.height+1,this.data.leaf=!1,Rr(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,s=1/0,o=1/0;for(let a=t;a<=i-t;a++){const l=Os(e,0,a,this.toBBox),c=Os(e,a,i,this.toBBox),h=H0(l,c),u=Rc(l)+Rc(c);h<s?(s=h,r=a,o=u<o?u:o):h===s&&u<o&&(o=u,r=a)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:j0,s=e.leaf?this.compareMinY:V0,o=this._allDistMargin(e,t,i,r),a=this._allDistMargin(e,t,i,s);o<a&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const s=this.toBBox,o=Os(e,0,t,s),a=Os(e,i-t,i,s);let l=ca(o)+ca(a);for(let c=t;c<i-t;c++){const h=e.children[c];Ds(o,e.leaf?s(h):h),l+=ca(o)}for(let c=i-t-1;c>=t;c--){const h=e.children[c];Ds(a,e.leaf?s(h):h),l+=ca(a)}return l}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)Ds(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():Rr(e[t],this.toBBox)}};function $0(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function Rr(n,e){Os(n,0,n.children.length,e,n)}function Os(n,e,t,i,r){r||(r=Pr(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<t;s++){const o=n.children[s];Ds(r,n.leaf?i(o):o)}return r}function Ds(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function j0(n,e){return n.minX-e.minX}function V0(n,e){return n.minY-e.minY}function Rc(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function ca(n){return n.maxX-n.minX+(n.maxY-n.minY)}function X0(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function H0(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),s=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,s-i)}function Pc(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function ha(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Pr(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Pf(n,e,t,i,r){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;Cf(n,o,e,t,r),s.push(e,o,o,t)}}class If{constructor(e){this.rbush_=new Rf(e),this.items_={}}insert(e,t){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[J(t)]=i}load(e,t){const i=new Array(t.length);for(let r=0,s=t.length;r<s;r++){const o=e[r],a=t[r],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[r]=l,this.items_[J(a)]=l}this.rbush_.load(i)}remove(e){const t=J(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null}update(e,t){const i=this.items_[J(t)],r=[i.minX,i.minY,i.maxX,i.maxY];_r(r,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(r){return r.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let i;for(let r=0,s=e.length;r<s;r++)if(i=t(e[r]),i)return i;return i}isEmpty(){return Li(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const t=this.rbush_.toJSON();return On(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const t in e.items_)this.items_[t]=e.items_[t]}}class Af extends St{constructor(e){super(),this.projection=Pe(e.projection),this.attributions_=Lf(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,r){t.viewResolver=i,t.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=Lf(e),this.changed()}setState(e){this.state_=e,this.changed()}}function Lf(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}const ot={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class mi extends Ln{constructor(e,t,i){super(e),this.feature=t,this.features=i}}class Fs extends Af{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=ds,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(fe(this.format_,"`format` must be set when `url` is set"),this.loader_=wf(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:W0;const t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new If:null,this.loadedExtentsRtree_=new If,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(e.features)?r=e.features:e.features&&(i=e.features,r=i.getArray()),!t&&i===void 0&&(i=new fn(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const t=J(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);const i=e.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new mi(ot.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof Ct||(this.featureChangeKeys_[e]=[he(t,re.CHANGE,this.handleFeatureChange_,this),he(t,ur.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let i=!0;if(t.getId()!==void 0){const r=String(t.getId());if(!(r in this.idIndex_))this.idIndex_[r]=t;else if(t instanceof Ct){const s=this.idIndex_[r];s instanceof Ct?Array.isArray(s)?s.push(t):this.idIndex_[r]=[s,t]:i=!1}else i=!1}return i&&(fe(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const t=[],i=[],r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s],l=J(a);this.addToIndex_(l,a)&&i.push(a)}for(let s=0,o=i.length;s<o;s++){const a=i[s],l=J(a);this.setupChangeEvents_(l,a);const c=a.getGeometry();if(c){const h=c.getExtent();t.push(h),r.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(t,r),this.hasListener(ot.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new mi(ot.ADDFEATURE,i[s]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(ot.ADDFEATURE,function(i){t||(t=!0,e.push(i.feature),t=!1)}),this.addEventListener(ot.REMOVEFEATURE,function(i){t||(t=!0,e.remove(i.feature),t=!1)}),e.addEventListener(wt.ADD,i=>{t||(t=!0,this.addFeature(i.element),t=!1)}),e.addEventListener(wt.REMOVE,i=>{t||(t=!0,this.removeFeature(i.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(be);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const t=new mi(ot.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof Ct||s.intersectsCoordinate(e))return t(r)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(i){const r=i.getGeometry();if(r instanceof Ct||r.intersectsExtent(e)){const s=t(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),Li(this.nullGeometryFeatures_)||dn(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const t=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){t.push(i)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const r=fd(e,t);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){const i=e[0],r=e[1];let s=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return t=t||us,this.featuresRtree_.forEachInExtent(l,function(c){if(t(c)){const h=c.getGeometry(),u=a;if(a=h instanceof Ct?0:h.closestPointXY(i,r,o,a),a<u){s=c;const d=Math.sqrt(a);l[0]=i-d,l[1]=r-d,l[2]=i+d,l[3]=r+d}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){const t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const t=e.target,i=J(t),r=t.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[i]=t);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,t)):this.featuresRtree_&&this.featuresRtree_.update(o,t)}const s=t.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[o]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[i]=t;this.changed(),this.dispatchEvent(new mi(ot.CHANGEFEATURE,t))}hasFeature(e){const t=e.getId();return t!==void 0?t in this.idIndex_:J(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Li(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,i){const r=this.loadedExtentsRtree_,s=this.strategy_(e,t,i);for(let o=0,a=s.length;o<a;++o){const l=s[o];r.forEachInExtent(l,function(h){return gr(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new mi(ot.FEATURESLOADSTART)),this.loader_.call(this,l,t,i,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new mi(ot.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new mi(ot.FEATURESLOADERROR))}),r.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const t=this.loadedExtentsRtree_,i=t.forEachInExtent(e,function(r){if(_r(r.extent,e))return r});i&&t.remove(i)}removeFeatures(e){let t=!1;for(let i=0,r=e.length;i<r;++i)t=this.removeFeatureInternal(e[i])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const t=J(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e);const i=this.featureChangeKeys_[t];i==null||i.forEach(be),delete this.featureChangeKeys_[t];const r=e.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[t],this.hasListener(ot.REMOVEFEATURE)&&this.dispatchEvent(new mi(ot.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){fe(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(wf(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Gn{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Gn({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=Ec(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===ce.IDLE&&t.load(),t.getImageState()===ce.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?J(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:Qt(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class kt{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new kt({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function Mf(n){return n[0]>0&&n[1]>0}function K0(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function mt(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}class ua{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=mt(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new ua({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return Q()}getImage(e){return Q()}getHitDetectionImage(){return Q()}getPixelRatio(e){return 1}getImageState(){return Q()}getImageSize(){return Q()}getOrigin(){return Q()}getSize(){return Q()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=mt(e)}listenImageChange(e){Q()}load(){Q()}unlistenImageChange(e){Q()}ready(){return Promise.resolve()}}class da extends ua{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?ce.LOADING:ce.LOADED,this.imageState_===ce.LOADING&&this.ready().then(()=>this.imageState_=ce.LOADED),this.render()}clone(){const e=this.getScale(),t=new da({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){var s,o;const t=(s=this.fill_)==null?void 0:s.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(",");let r=(o=Bt.get(i,null,null))==null?void 0:o.getImage(1);if(!r){const a=this.renderOptions_,l=Math.ceil(a.size*e),c=ze(l,l);this.draw_(a,c,e),r=c.canvas,Bt.set(i,null,null,new lf(r,void 0,null,ce.LOADED,null))}return r}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const S=r;r=s,s=S}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=s*Math.sin(a),c=Math.sqrt(s*s-l*l),h=r-c,u=Math.sqrt(l*l+h*h),d=u/l;if(e==="miter"&&d<=i)return d*t;const f=t/2/d,g=t/2*(h/u),m=Math.sqrt((r+f)*(r+f)+g*g)-r;if(this.radius2_===void 0||e==="bevel")return m*2;const y=r*Math.sin(a),p=Math.sqrt(r*r-y*y),E=s-p,v=Math.sqrt(y*y+E*E)/y;if(v<=i){const S=v*t/2-s-r;return 2*Math.max(m,S)}return m*2}createRenderOptions(){let e=Sr,t=br,i=0,r=null,s=0,o,a=0;this.stroke_&&(o=mn(this.stroke_.getColor()??Ps),a=this.stroke_.getWidth()??As,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??br,e=this.stroke_.getLineCap()??Sr,i=this.stroke_.getMiterLimit()??Rs);const l=this.calculateLineJoinSize_(t,a,i),c=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*c+l);return{strokeStyle:o,strokeWidth:a,size:h,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let r=this.fill_.getColor();r===null&&(r=bt),t.fillStyle=mn(r),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=Qt(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(t=ze(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let a=0;a<t;a++){const l=s+a*o,c=a%2===0?i:r;e.lineTo(c*Math.cos(l),c*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=bt,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class ji extends da{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new ji({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}}class _t{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=Df,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new _t({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=Df,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function Z0(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(fe(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}let Ic=null;function Of(n,e){if(!Ic){const t=new Gn({color:"rgba(255,255,255,0.4)"}),i=new kt({color:"#3399CC",width:1.25});Ic=[new _t({image:new ji({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return Ic}function Df(n){return n.getGeometry()}const q0="#333";class Vi{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=mt(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Gn({color:q0}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Vi({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=mt(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const Qe={ANIMATING:0,INTERACTING:1},Z={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},fa=[Z.FILL],_i=[Z.STROKE],Xi=[Z.BEGIN_PATH],Ff=[Z.CLOSE_PATH];class ks extends cf{constructor(e,t,i,r){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,l=e.length;a<l;a+=t)r[0]=e[a],r[1]=e[a+1],fr(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(e,t,i,r,s,o){const a=this.coordinates;let l=a.length;const c=this.getBufferedMaxExtent();o&&(t+=r);let h=e[t],u=e[t+1];const d=this.tmpCoordinate_;let f=!0,g,_,m;for(g=t+r;g<i;g+=r)d[0]=e[g],d[1]=e[g+1],m=Ll(c,d),m!==_?(f&&(a[l++]=h,a[l++]=u,f=!1),a[l++]=d[0],a[l++]=d[1]):m===qe.INTERSECTING?(a[l++]=d[0],a[l++]=d[1],f=!1):f=!0,h=d[0],u=d[1],_=m;return(s&&f||g===t+r)&&(a[l++]=h,a[l++]=u),l}drawCustomCoordinates_(e,t,i,r,s){for(let o=0,a=i.length;o<a;++o){const l=i[o],c=this.appendFlatLineCoordinates(e,t,l,r,!1,!1);s.push(c),t=l}return t}drawCustom(e,t,i,r,s){this.beginGeometry(e,t,s);const o=e.getType(),a=e.getStride(),l=this.coordinates.length;let c,h,u,d,f;switch(o){case"MultiPolygon":c=e.getOrientedFlatCoordinates(),d=[];const g=e.getEndss();f=0;for(let _=0,m=g.length;_<m;++_){const y=[];f=this.drawCustomCoordinates_(c,f,g[_],a,y),d.push(y)}this.instructions.push([Z.CUSTOM,l,d,e,i,ec,s]),this.hitDetectionInstructions.push([Z.CUSTOM,l,d,e,r||i,ec,s]);break;case"Polygon":case"MultiLineString":u=[],c=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),f=this.drawCustomCoordinates_(c,0,e.getEnds(),a,u),this.instructions.push([Z.CUSTOM,l,u,e,i,Es,s]),this.hitDetectionInstructions.push([Z.CUSTOM,l,u,e,r||i,Es,s]);break;case"LineString":case"Circle":c=e.getFlatCoordinates(),h=this.appendFlatLineCoordinates(c,0,c.length,a,!1,!1),this.instructions.push([Z.CUSTOM,l,h,e,i,fi,s]),this.hitDetectionInstructions.push([Z.CUSTOM,l,h,e,r||i,fi,s]);break;case"MultiPoint":c=e.getFlatCoordinates(),h=this.appendFlatPointCoordinates(c,a),h>l&&(this.instructions.push([Z.CUSTOM,l,h,e,i,fi,s]),this.hitDetectionInstructions.push([Z.CUSTOM,l,h,e,r||i,fi,s]));break;case"Point":c=e.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),h=this.coordinates.length,this.instructions.push([Z.CUSTOM,l,h,e,i,void 0,s]),this.hitDetectionInstructions.push([Z.CUSTOM,l,h,e,r||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[Z.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Z.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let r,s,o=-1;for(t=0;t<i;++t)r=e[t],s=r[0],s==Z.END_GEOMETRY?o=t:s==Z.BEGIN_GEOMETRY&&(r[2]=t,zp(this.hitDetectionInstructions,o,t),o=-1)}fillStyleToState(e,t={}){if(e){const i=e.getColor();t.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,t.fillStyle=mn(i||bt)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){const i=e.getColor();t.strokeStyle=mn(i||Ps);const r=e.getLineCap();t.lineCap=r!==void 0?r:Sr;const s=e.getLineDash();t.lineDash=s?s.slice():kn;const o=e.getLineDashOffset();t.lineDashOffset=o||Nn;const a=e.getLineJoin();t.lineJoin=a!==void 0?a:br;const l=e.getWidth();t.lineWidth=l!==void 0?l:As;const c=e.getMiterLimit();t.miterLimit=c!==void 0?c:Rs,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(t,i)}createFill(e){const t=e.fillStyle,i=[Z.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Z.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,r=e.lineCap,s=e.lineDash,o=e.lineDashOffset,a=e.lineJoin,l=e.lineWidth,c=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=r||s!=e.currentLineDash&&!An(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=a||e.currentLineWidth!=l||e.currentMiterLimit!=c)&&(t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=r,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=a,e.currentLineWidth=l,e.currentMiterLimit=c)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[Z.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=od(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;Mn(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class J0 extends ks{constructor(e,t,i,r){super(e,t,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!fr(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,s);this.instructions.push([Z.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Z.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const r=e.getFlatCoordinates(),s=[];for(let l=0,c=r.length;l<c;l+=e.getStride())(!this.maxExtent||fr(this.maxExtent,r.slice(l,l+2)))&&s.push(r[l],r[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([Z.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Z.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),r=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=r[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class Q0 extends ks{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinates_(e,t,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,r,!1,!1),a=[Z.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Z.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,kn,Nn],Xi);const a=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(_i),this.endGeometry(t)}drawMultiLineString(e,t,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([Z.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,kn,Nn],Xi);const a=e.getEnds(),l=e.getFlatCoordinates(),c=e.getStride();let h=0;for(let u=0,d=a.length;u<d;++u)h=this.drawFlatCoordinates_(l,h,a[u],c);this.hitDetectionInstructions.push(_i),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(_i),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(_i),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Xi)}}class kf extends ks{constructor(e,t,i,r){super(e,t,i,r)}drawFlatCoordinatess_(e,t,i,r){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,l=i.length;this.instructions.push(Xi),this.hitDetectionInstructions.push(Xi);for(let c=0;c<l;++c){const h=i[c],u=this.coordinates.length,d=this.appendFlatLineCoordinates(e,t,h,r,!0,!a),f=[Z.MOVE_TO_LINE_TO,u,d];this.instructions.push(f),this.hitDetectionInstructions.push(f),a&&(this.instructions.push(Ff),this.hitDetectionInstructions.push(Ff)),t=h}return o&&(this.instructions.push(fa),this.hitDetectionInstructions.push(fa)),a&&(this.instructions.push(_i),this.hitDetectionInstructions.push(_i)),t}drawCircle(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Z.SET_FILL_STYLE,bt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Z.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,kn,Nn]);const a=e.getFlatCoordinates(),l=e.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const h=[Z.CIRCLE,c];this.instructions.push(Xi,h),this.hitDetectionInstructions.push(Xi,h),r.fillStyle!==void 0&&(this.instructions.push(fa),this.hitDetectionInstructions.push(fa)),r.strokeStyle!==void 0&&(this.instructions.push(_i),this.hitDetectionInstructions.push(_i)),this.endGeometry(t)}drawPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Z.SET_FILL_STYLE,bt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Z.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,kn,Nn]);const a=e.getEnds(),l=e.getOrientedFlatCoordinates(),c=e.getStride();this.drawFlatCoordinatess_(l,0,a,c),this.endGeometry(t)}drawMultiPolygon(e,t,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([Z.SET_FILL_STYLE,bt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Z.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,kn,Nn]);const a=e.getEndss(),l=e.getOrientedFlatCoordinates(),c=e.getStride();let h=0;for(let u=0,d=a.length;u<d;++u)h=this.drawFlatCoordinatess_(l,h,a[u],c);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,r=t.length;i<r;++i)t[i]=zi(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function ex(n,e,t,i,r){const s=[];let o=t,a=0,l=e.slice(t,2);for(;a<n&&o+r<i;){const[c,h]=l.slice(-2),u=e[o+r],d=e[o+r+1],f=Math.sqrt((u-c)*(u-c)+(d-h)*(d-h));if(a+=f,a>=n){const g=(n-a+f)/f,_=Ft(c,u,g),m=Ft(h,d,g);l.push(_,m),s.push(l),l=[_,m],a==n&&(o+=r),a=0}else if(a<n)l.push(e[o+r],e[o+r+1]),o+=r;else{const g=f-a,_=Ft(c,u,g/f),m=Ft(h,d,g/f);l.push(_,m),s.push(l),l=[_,m],a=0,o+=r}}return a>0&&s.push(l),s}function tx(n,e,t,i,r){let s=t,o=t,a=0,l=0,c=t,h,u,d,f,g,_,m,y,p,E;for(u=t;u<i;u+=r){const x=e[u],v=e[u+1];g!==void 0&&(p=x-g,E=v-_,f=Math.sqrt(p*p+E*E),m!==void 0&&(l+=d,h=Math.acos((m*p+y*E)/(d*f)),h>n&&(l>a&&(a=l,s=c,o=u),l=0,c=u-r)),d=f,m=p,y=E),g=x,_=v}return l+=f,l>a?[c,u]:[s,o]}const ga={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class nx extends ks{constructor(e,t,i,r){super(e,t,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[bt]={fillStyle:bt},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const a=this.coordinates;let l=a.length;const c=e.getType();let h=null,u=e.getStride();if(o.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!gt(this.maxExtent,e.getExtent()))return;let d;if(h=e.getFlatCoordinates(),c=="LineString")d=[h.length];else if(c=="MultiLineString")d=e.getEnds();else if(c=="Polygon")d=e.getEnds().slice(0,1);else if(c=="MultiPolygon"){const m=e.getEndss();d=[];for(let y=0,p=m.length;y<p;++y)d.push(m[y][0])}this.beginGeometry(e,t,i);const f=o.repeat,g=f?void 0:o.textAlign;let _=0;for(let m=0,y=d.length;m<y;++m){let p;f?p=ex(f*this.resolution,h,_,d[m],u):p=[h.slice(_,d[m])];for(let E=0,x=p.length;E<x;++E){const v=p[E];let S=0,w=v.length;if(g==null){const P=tx(o.maxAngle,v,0,v.length,2);S=P[0],w=P[1]}for(let P=S;P<w;P+=u)a.push(v[P],v[P+1]);const b=a.length;_=d[m],this.drawChars_(l,b),l=b}}this.endGeometry(t)}else{let d=o.overflow?null:[];switch(c){case"Point":case"MultiPoint":h=e.getFlatCoordinates();break;case"LineString":h=e.getFlatMidpoint();break;case"Circle":h=e.getCenter();break;case"MultiLineString":h=e.getFlatMidpoints(),u=2;break;case"Polygon":h=e.getFlatInteriorPoint(),o.overflow||d.push(h[2]/this.resolution),u=3;break;case"MultiPolygon":const x=e.getFlatInteriorPoints();h=[];for(let v=0,S=x.length;v<S;v+=3)o.overflow||d.push(x[v+2]/this.resolution),h.push(x[v],x[v+1]);if(h.length===0)return;u=2;break}const f=this.appendFlatPointCoordinates(h,u);if(f===l)return;if(d&&(f-l)/2!==h.length/u){let x=l/2;d=d.filter((v,S)=>{const w=a[(x+S)*2]===h[S*u]&&a[(x+S)*2+1]===h[S*u+1];return w||--x,w})}this.saveTextStates_();const g=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,_=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,t,i);let m=o.padding;if(m!=$i&&(o.scale[0]<0||o.scale[1]<0)){let x=o.padding[0],v=o.padding[1],S=o.padding[2],w=o.padding[3];o.scale[0]<0&&(v=-v,w=-w),o.scale[1]<0&&(x=-x,S=-S),m=[x,v,S,w]}const y=this.pixelRatio;this.instructions.push([Z.DRAW_IMAGE,l,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,m==$i?$i:m.map(function(x){return x*y}),g,_,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]);const p=1/y,E=g?g.slice(0):null;E&&(E[1]=bt),this.hitDetectionInstructions.push([Z.DRAW_IMAGE,l,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[p,p],NaN,this.declutterMode_,this.declutterImageWithText_,m,E,_,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?bt:this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,r=this.strokeKey_;e&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Is,justify:t.justify,textBaseline:t.textBaseline||ra,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=ga[r.textBaseline],h=this.textOffsetY_*l,u=this.text_,d=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Z.DRAW_CHARS,e,t,c,r.overflow,a,r.maxAngle,l,h,s,d*l,u,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Z.DRAW_CHARS,e,t,c,r.overflow,a&&bt,r.maxAngle,l,h,s,d*l,u,o,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let i,r,s;if(!e)this.text_="";else{const o=e.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=mn(o.getColor()||bt)):(r=null,this.textFillState_=r);const a=e.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const _=a.getLineDash(),m=a.getLineDashOffset(),y=a.getWidth(),p=a.getMiterLimit();s.lineCap=a.getLineCap()||Sr,s.lineDash=_?_.slice():kn,s.lineDashOffset=m===void 0?Nn:m,s.lineJoin=a.getLineJoin()||br,s.lineWidth=y===void 0?As:y,s.miterLimit=p===void 0?Rs:p,s.strokeStyle=mn(a.getColor()||Ps)}i=this.textState_;const l=e.getFont()||df;S0(l);const c=e.getScaleArray();i.overflow=e.getOverflow(),i.font=l,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||ra,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||$i,i.scale=c===void 0?[1,1]:c;const h=e.getOffsetX(),u=e.getOffsetY(),d=e.getRotateWithView(),f=e.getKeepUpright(),g=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=u===void 0?0:u,this.textRotateWithView_=d===void 0?!1:d,this.textKeepUpright_=f===void 0?!0:f,this.textRotation_=g===void 0?0:g,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:J(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+J(r.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const ix={Circle:kf,Default:ks,Image:J0,LineString:Q0,Polygon:kf,Text:nx};class rx{constructor(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const r in i){const s=i[r].finish();e[t][r]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[t];if(s===void 0){const o=ix[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=s}return s}}function sx(n,e,t,i,r,s,o,a,l,c,h,u,d=!0){let f=n[e],g=n[e+1],_=0,m=0,y=0,p=0;function E(){_=f,m=g,e+=i,f=n[e],g=n[e+1],p+=y,y=Math.sqrt((f-_)*(f-_)+(g-m)*(g-m))}do E();while(e<t-i&&p+y<s);let x=y===0?0:(s-p)/y;const v=Ft(_,f,x),S=Ft(m,g,x),w=e-i,b=p,P=s+a*l(c,r,h);for(;e<t-i&&p+y<P;)E();x=y===0?0:(P-p)/y;const D=Ft(_,f,x),G=Ft(m,g,x);let N=!1;if(d)if(u){const k=[v,S,D,G];Gd(k,0,4,2,u,k,k),N=k[0]>k[2]}else N=v>D;const F=Math.PI,B=[],H=w+i===e;e=w,y=0,p=b,f=n[e],g=n[e+1];let A;if(H){E(),A=Math.atan2(g-m,f-_),N&&(A+=A>0?-F:F);const k=(D+v)/2,z=(G+S)/2;return B[0]=[k,z,(P-s)/2,A,r],B}r=r.replace(/\n/g," ");for(let k=0,z=r.length;k<z;){E();let V=Math.atan2(g-m,f-_);if(N&&(V+=V>0?-F:F),A!==void 0){let Re=V-A;if(Re+=Re>F?-2*F:Re<-F?2*F:0,Math.abs(Re)>o)return null}A=V;const K=k;let oe=0;for(;k<z;++k){const Re=N?z-k-1:k,nt=a*l(c,r[Re],h);if(e+i<t&&p+y<s+oe+nt/2)break;oe+=nt}if(k===K)continue;const L=N?r.substring(z-K,z-k):r.substring(K,k);x=y===0?0:(s+oe/2-p)/y;const ke=Ft(_,f,x),We=Ft(m,g,x);B.push([ke,We,oe/2,V,L]),s+=oe}return B}class Nf{constructor(){un(this,"pushMethodArgs_",(...e)=>(this.push_(e),this));this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(ea(),{get:(e,t)=>{if(typeof ea()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,i)=>(this.push_(t,i),!0)})}push_(...e){const t=this.instructions_,i=this.zIndex+this.offset_;t[i]||(t[i]=[]),t[i].push(...e)}pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,r=t.length;i<r;++i){const s=t[i];if(typeof s=="function"){s(e);continue}const o=t[++i];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const Ir=ft(),pi=[],Un=[],Bn=[],yi=[];function Gf(n){return n[3].declutterBox}const Uf=new RegExp("[֑-ࣿיִ-﷿ﹰ-ﻼࠀ-࿿-]");function Ac(n,e){return e==="start"?e=Uf.test(n)?"right":"left":e==="end"&&(e=Uf.test(n)?"left":"right"),ga[e]}function ox(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function ax(n,e,t){return t%2===0&&(n+=e),n}class lx{constructor(e,t,i,r,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Ve(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new Nf:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,r){const s=e+t+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,a=i?this.fillStates[i]:null,l=this.textStates[t],c=this.pixelRatio,h=[l.scale[0]*c,l.scale[1]*c],u=l.justify?ga[l.justify]:Ac(Array.isArray(e)?e[0]:e,l.textAlign||Is),d=r&&o.lineWidth?o.lineWidth:0,f=Array.isArray(e)?e:String(e).split(`
`).reduce(ox,[]),{width:g,height:_,widths:m,heights:y,lineWidths:p}=C0(l,f),E=g+d,x=[],v=(E+2)*h[0],S=(_+d)*h[1],w={width:v<0?Math.floor(v):Math.ceil(v),height:S<0?Math.floor(S):Math.ceil(S),contextInstructions:x};(h[0]!=1||h[1]!=1)&&x.push("scale",h),r&&(x.push("strokeStyle",o.strokeStyle),x.push("lineWidth",d),x.push("lineCap",o.lineCap),x.push("lineJoin",o.lineJoin),x.push("miterLimit",o.miterLimit),x.push("setLineDash",[o.lineDash]),x.push("lineDashOffset",o.lineDashOffset)),i&&x.push("fillStyle",a.fillStyle),x.push("textBaseline","middle"),x.push("textAlign","center");const b=.5-u;let P=u*E+b*d;const D=[],G=[];let N=0,F=0,B=0,H=0,A;for(let k=0,z=f.length;k<z;k+=2){const V=f[k];if(V===`
`){F+=N,N=0,P=u*E+b*d,++H;continue}const K=f[k+1]||l.font;K!==A&&(r&&D.push("font",K),i&&G.push("font",K),A=K),N=Math.max(N,y[B]);const oe=[V,P+b*m[B]+u*(m[B]-p[H]),.5*(d+N)+F];P+=m[B],r&&D.push("strokeText",oe),i&&G.push("fillText",oe),++B}return Array.prototype.push.apply(x,D),Array.prototype.push.apply(x,G),this.labels_[s]=w,w}replayTextBackground_(e,t,i,r,s,o,a){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,r,s,o,a,l,c,h,u,d,f,g,_,m){a*=d[0],l*=d[1];let y=i-a,p=r-l;const E=s+c>e?e-c:s,x=o+h>t?t-h:o,v=g[3]+E*d[0]+g[1],S=g[0]+x*d[1]+g[2],w=y-g[3],b=p-g[0];(_||u!==0)&&(pi[0]=w,yi[0]=w,pi[1]=b,Un[1]=b,Un[0]=w+v,Bn[0]=Un[0],Bn[1]=b+S,yi[1]=Bn[1]);let P;return u!==0?(P=qt(Ve(),i,r,1,1,u,-i,-r),Ne(P,pi),Ne(P,Un),Ne(P,Bn),Ne(P,yi),On(Math.min(pi[0],Un[0],Bn[0],yi[0]),Math.min(pi[1],Un[1],Bn[1],yi[1]),Math.max(pi[0],Un[0],Bn[0],yi[0]),Math.max(pi[1],Un[1],Bn[1],yi[1]),Ir)):On(Math.min(w,w+v),Math.min(b,b+S),Math.max(w,w+v),Math.max(b,b+S),Ir),f&&(y=Math.round(y),p=Math.round(p)),{drawImageX:y,drawImageY:p,drawImageW:E,drawImageH:x,originX:c,originY:h,declutterBox:{minX:Ir[0],minY:Ir[1],maxX:Ir[2],maxY:Ir[3],value:m},canvasTransform:P,scale:d}}replayImageOrLabel_(e,t,i,r,s,o,a){const l=!!(o||a),c=r.declutterBox,h=a?a[2]*r.scale[0]/2:0;return c.minX-h<=t[0]&&c.maxX+h>=0&&c.minY-h<=t[1]&&c.maxY+h>=0&&(l&&this.replayTextBackground_(e,pi,Un,Bn,yi,o,a),R0(e,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=Ne(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;e.save(),e.translate(i[0]%r,i[1]%r),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],t[1]&&(e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6]))}drawLabelWithPointPlacement_(e,t,i,r){const s=this.textStates[t],o=this.createLabel(e,t,r,i),a=this.strokeStates[i],l=this.pixelRatio,c=Ac(Array.isArray(e)?e[0]:e,s.textAlign||Is),h=ga[s.textBaseline||ra],u=a&&a.lineWidth?a.lineWidth:0,d=o.width/l-2*s.scale[0],f=c*d+2*(.5-c)*u,g=h*o.height/l+2*(.5-h)*u;return{label:o,anchorX:f,anchorY:g}}execute_(e,t,i,r,s,o,a,l){const c=this.zIndexContext_;let h;this.pixelCoordinates_&&An(i,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=gn(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),kd(this.renderedTransform_,i));let u=0;const d=r.length;let f=0,g,_,m,y,p,E,x,v,S,w,b,P,D,G=0,N=0;const F=this.coordinateCache_,B=this.viewRotation_,H=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,A={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:B},k=this.instructions!=r||this.overlaps?0:200;let z,V,K,oe;for(;u<d;){const L=r[u];switch(L[0]){case Z.BEGIN_GEOMETRY:z=L[1],oe=L[3],z.getGeometry()?a!==void 0&&!gt(a,oe.getExtent())?u=L[2]+1:++u:u=L[2],c&&(c.zIndex=L[4]);break;case Z.BEGIN_PATH:G>k&&(this.fill_(e),G=0),N>k&&(e.stroke(),N=0),!G&&!N&&(e.beginPath(),p=NaN,E=NaN),++u;break;case Z.CIRCLE:f=L[1];const We=h[f],Re=h[f+1],nt=h[f+2],Ye=h[f+3],yt=nt-We,xt=Ye-Re,tt=Math.sqrt(yt*yt+xt*xt);e.moveTo(We+tt,Re),e.arc(We,Re,tt,0,2*Math.PI,!0),++u;break;case Z.CLOSE_PATH:e.closePath(),++u;break;case Z.CUSTOM:f=L[1],g=L[2];const es=L[3],ts=L[4],ar=L[5];A.geometry=es,A.feature=z,u in F||(F[u]=[]);const ti=F[u];ar?ar(h,f,g,2,ti):(ti[0]=h[f],ti[1]=h[f+1],ti.length=2),c&&(c.zIndex=L[6]),ts(ti,A),++u;break;case Z.DRAW_IMAGE:f=L[1],g=L[2],S=L[3],_=L[4],m=L[5];let it=L[6];const ut=L[7],ni=L[8],ii=L[9],Cn=L[10];let ri=L[11];const Pi=L[12];let Rn=L[13];y=L[14]||"declutter";const $e=L[15];if(!S&&L.length>=20){w=L[19],b=L[20],P=L[21],D=L[22];const vt=this.drawLabelWithPointPlacement_(w,b,P,D);S=vt.label,L[3]=S;const ai=L[23];_=(vt.anchorX-ai)*this.pixelRatio,L[4]=_;const Et=L[24];m=(vt.anchorY-Et)*this.pixelRatio,L[5]=m,it=S.height,L[6]=it,Rn=S.width,L[13]=Rn}let vo;L.length>25&&(vo=L[25]);let ns,lr,cr;L.length>17?(ns=L[16],lr=L[17],cr=L[18]):(ns=$i,lr=null,cr=null),Cn&&H?ri+=B:!Cn&&!H&&(ri-=B);let zu=0;for(;f<g;f+=2){if(vo&&vo[zu++]<Rn/this.pixelRatio)continue;const vt=this.calculateImageOrLabelDimensions_(S.width,S.height,h[f],h[f+1],Rn,it,_,m,ni,ii,ri,Pi,s,ns,!!lr||!!cr,z),ai=[e,t,S,vt,ut,lr,cr];if(l){let Et,Gt,Mt;if($e){const Le=g-f;if(!$e[Le]){$e[Le]={args:ai,declutterMode:y};continue}const rt=$e[Le];Et=rt.args,Gt=rt.declutterMode,delete $e[Le],Mt=Gf(Et)}let cn,Xt;if(Et&&(Gt!=="declutter"||!l.collides(Mt))&&(cn=!0),(y!=="declutter"||!l.collides(vt.declutterBox))&&(Xt=!0),Gt==="declutter"&&y==="declutter"){const Le=cn&&Xt;cn=Le,Xt=Le}cn&&(Gt!=="none"&&l.insert(Mt),this.replayImageOrLabel_.apply(this,Et)),Xt&&(y!=="none"&&l.insert(vt.declutterBox),this.replayImageOrLabel_.apply(this,ai))}else this.replayImageOrLabel_.apply(this,ai)}++u;break;case Z.DRAW_CHARS:const Eo=L[1],To=L[2],wo=L[3],Wu=L[4];D=L[5];const Yu=L[6],El=L[7],Tl=L[8];P=L[9];const So=L[10];w=L[11],Array.isArray(w)&&(w=w.reduce(ax,"")),b=L[12];const wl=[L[13],L[13]];y=L[14]||"declutter";const bo=L[15],is=this.textStates[b],Vt=is.font,si=[is.scale[0]*El,is.scale[1]*El];let oi;Vt in this.widths_?oi=this.widths_[Vt]:(oi={},this.widths_[Vt]=oi);const Co=lc(h,Eo,To,2),Sl=Math.abs(si[0])*_f(Vt,w,oi);if(Wu||Sl<=Co){const vt=this.textStates[b].textAlign,ai=(Co-Sl)*Ac(w,vt),Et=sx(h,Eo,To,2,w,ai,Yu,Math.abs(si[0]),_f,Vt,oi,H?0:this.viewRotation_,bo);e:if(Et){const Gt=[];let Mt,cn,Xt,Le,rt;if(P)for(Mt=0,cn=Et.length;Mt<cn;++Mt){rt=Et[Mt],Xt=rt[4],Le=this.createLabel(Xt,b,"",P),_=rt[2]+(si[0]<0?-So:So),m=wo*Le.height+(.5-wo)*2*So*si[1]/si[0]-Tl;const hn=this.calculateImageOrLabelDimensions_(Le.width,Le.height,rt[0],rt[1],Le.width,Le.height,_,m,0,0,rt[3],wl,!1,$i,!1,z);if(l&&y==="declutter"&&l.collides(hn.declutterBox))break e;Gt.push([e,t,Le,hn,1,null,null])}if(D)for(Mt=0,cn=Et.length;Mt<cn;++Mt){rt=Et[Mt],Xt=rt[4],Le=this.createLabel(Xt,b,D,""),_=rt[2],m=wo*Le.height-Tl;const hn=this.calculateImageOrLabelDimensions_(Le.width,Le.height,rt[0],rt[1],Le.width,Le.height,_,m,0,0,rt[3],wl,!1,$i,!1,z);if(l&&y==="declutter"&&l.collides(hn.declutterBox))break e;Gt.push([e,t,Le,hn,1,null,null])}l&&y!=="none"&&l.load(Gt.map(Gf));for(let hn=0,$u=Gt.length;hn<$u;++hn)this.replayImageOrLabel_.apply(this,Gt[hn])}}++u;break;case Z.END_GEOMETRY:if(o!==void 0){z=L[1];const vt=o(z,oe,y);if(vt)return vt}++u;break;case Z.FILL:k?G++:this.fill_(e),++u;break;case Z.MOVE_TO_LINE_TO:for(f=L[1],g=L[2],V=h[f],K=h[f+1],e.moveTo(V,K),p=V+.5|0,E=K+.5|0,f+=2;f<g;f+=2)V=h[f],K=h[f+1],x=V+.5|0,v=K+.5|0,(f==g-2||x!==p||v!==E)&&(e.lineTo(V,K),p=x,E=v);++u;break;case Z.SET_FILL_STYLE:this.alignAndScaleFill_=L[2],G&&(this.fill_(e),G=0,N&&(e.stroke(),N=0)),e.fillStyle=L[1],++u;break;case Z.SET_STROKE_STYLE:N&&(e.stroke(),N=0),this.setStrokeStyle_(e,L),++u;break;case Z.STROKE:k?N++:e.stroke(),++u;break;default:++u;break}}G&&this.fill_(e),N&&e.stroke()}execute(e,t,i,r,s,o){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,r,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,r,s)}}const Hi=["Polygon","Circle","LineString","Image","Text","Default"],Bf=["Image","Text"],cx=Hi.filter(n=>!Bf.includes(n));class hx{constructor(e,t,i,r,s,o,a){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Ve(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=e[i];for(const o in s){const a=s[o];r[o]=new lx(this.resolution_,this.pixelRatio_,this.overlaps_,a,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let r=0,s=e.length;r<s;++r)if(e[r]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,r,s,o){r=Math.round(r);const a=r*2+1,l=qt(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=ze(a,a));const h=this.hitDetectionContext_;h.canvas.width!==a||h.canvas.height!==a?(h.canvas.width=a,h.canvas.height=a):c||h.clearRect(0,0,a,a);let u;this.renderBuffer_!==void 0&&(u=ft(),gs(u,e),Mn(u,t*(this.renderBuffer_+r),u));const d=ux(r);let f;function g(v,S,w){const b=h.getImageData(0,0,a,a).data;for(let P=0,D=d.length;P<D;P++)if(b[d[P]]>0){if(!o||w==="none"||f!=="Image"&&f!=="Text"||o.includes(v)){const G=(d[P]-3)/4,N=r-G%a,F=r-(G/a|0),B=s(v,S,N*N+F*F);if(B)return B}h.clearRect(0,0,a,a);break}}const _=Object.keys(this.executorsByZIndex_).map(Number);_.sort(In);let m,y,p,E,x;for(m=_.length-1;m>=0;--m){const v=_[m].toString();for(p=this.executorsByZIndex_[v],y=Hi.length-1;y>=0;--y)if(f=Hi[y],E=p[f],E!==void 0&&(x=E.executeHitDetection(h,l,i,g,u),x))return x}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],r=t[1],s=t[2],o=t[3],a=[i,r,i,o,s,o,s,r];return gn(a,0,8,2,e,a),a}isEmpty(){return Li(this.executorsByZIndex_)}execute(e,t,i,r,s,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(a?Bp:In),o=o||Hi;const c=Hi.length;for(let h=0,u=l.length;h<u;++h){const d=l[h].toString(),f=this.executorsByZIndex_[d];for(let g=0,_=o.length;g<_;++g){const m=o[g],y=f[m];if(y!==void 0){const p=a===null?void 0:y.getZIndexContext(),E=p?p.getContext():e,x=this.maxExtent_&&m!=="Image"&&m!=="Text";if(x&&(E.save(),this.clip(E,i)),!p||m==="Text"||m==="Image"?y.execute(E,t,i,r,s,a):p.pushFunction(v=>y.execute(v,t,i,r,s,a)),x&&E.restore(),p){p.offset();const v=l[h]*c+Hi.indexOf(m);this.deferredZIndexContexts_[v]||(this.deferredZIndexContexts_[v]=[]),this.deferredZIndexContexts_[v].push(p)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(In);for(let i=0,r=t.length;i<r;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[t[i]].length=0}}const Lc={};function ux(n){if(Lc[n]!==void 0)return Lc[n];const e=n*2+1,t=n*n,i=new Array(t+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const a=s*s+o*o;if(a>t)break;let l=i[a];l||(l=[],i[a]=l),l.push(((n+s)*e+(n+o))*4+3),s>0&&l.push(((n-s)*e+(n+o))*4+3),o>0&&(l.push(((n+s)*e+(n-o))*4+3),s>0&&l.push(((n-s)*e+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return Lc[n]=r,r}function zf(n,e,t,i){return t!==void 0&&i!==void 0?[t/n,i/e]:t!==void 0?t/n:i!==void 0?i/e:1}class Ns extends ua{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,r=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:r,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let a=e.src;fe(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||J(o)),fe(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),fe(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=ce.IDLE:o!==void 0&&("complete"in o?o.complete?l=o.src?ce.LOADED:ce.IDLE:l=ce.LOADING:l=ce.LOADED),this.color_=e.color!==void 0?Qt(e.color):null,this.iconImage_=Ec(o,a,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let c,h;if(e.size)[c,h]=e.size;else{const u=this.getImage(1);if(u.width&&u.height)c=u.width,h=u.height;else if(u instanceof HTMLImageElement){this.initialOptions_=e;const d=()=>{if(this.unlistenImageChange(d),!this.initialOptions_)return;const f=this.iconImage_.getSize();this.setScale(zf(f[0],f[1],e.width,e.height))};this.listenImageChange(d);return}}c!==void 0&&this.setScale(zf(c,h,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new Ns({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=r[0]),this.anchorYUnits_=="fraction"&&(e[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+r[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==ce.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==ce.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(re.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(re.CHANGE,e)}ready(){return this.iconImage_.ready()}}const _n=.5;function dx(n,e,t,i,r,s,o,a,l){const c=r,h=n[0]*_n,u=n[1]*_n,d=ze(h,u);d.imageSmoothingEnabled=!1;const f=d.canvas,g=new pf(d,_n,r,null,o,a,null),_=t.length,m=Math.floor((256*256*256-1)/_),y={};for(let E=1;E<=_;++E){const x=t[E-1],v=x.getStyleFunction()||i;if(!v)continue;let S=v(x,s);if(!S)continue;Array.isArray(S)||(S=[S]);const b=(E*m).toString(16).padStart(7,"#00000");for(let P=0,D=S.length;P<D;++P){const G=S[P],N=G.getGeometryFunction()(x);if(!N||!gt(c,N.getExtent()))continue;const F=G.clone(),B=F.getFill();B&&B.setColor(b);const H=F.getStroke();H&&(H.setColor(b),H.setLineDash(null)),F.setText(void 0);const A=G.getImage();if(A){const K=A.getImageSize();if(!K)continue;const oe=ze(K[0],K[1],void 0,{alpha:!1}),L=oe.canvas;oe.fillStyle=b,oe.fillRect(0,0,L.width,L.height),F.setImage(new Ns({img:L,anchor:A.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:A.getOrigin(),opacity:1,size:A.getSize(),scale:A.getScale(),rotation:A.getRotation(),rotateWithView:A.getRotateWithView()}))}const k=F.getZIndex()||0;let z=y[k];z||(z={},y[k]=z,z.Polygon=[],z.Circle=[],z.LineString=[],z.Point=[]);const V=N.getType();if(V==="GeometryCollection"){const K=N.getGeometriesArrayRecursive();for(let oe=0,L=K.length;oe<L;++oe){const ke=K[oe];z[ke.getType().replace("Multi","")].push(ke,F)}}else z[V.replace("Multi","")].push(N,F)}}const p=Object.keys(y).map(Number).sort(In);for(let E=0,x=p.length;E<x;++E){const v=y[p[E]];for(const S in v){const w=v[S];for(let b=0,P=w.length;b<P;b+=2){g.setStyle(w[b+1]);for(let D=0,G=e.length;D<G;++D)g.setTransform(e[D]),g.drawGeometry(w[b])}}}return d.getImageData(0,0,f.width,f.height)}function fx(n,e,t){const i=[];if(t){const r=Math.floor(Math.round(n[0])*_n),s=Math.floor(Math.round(n[1])*_n),o=(Me(r,0,t.width-1)+Me(s,0,t.height-1)*t.width)*4,a=t.data[o],l=t.data[o+1],h=t.data[o+2]+256*(l+256*a),u=Math.floor((256*256*256-1)/e.length);h&&h%u===0&&i.push(e[h/u-1])}return i}class Gs extends Ln{constructor(e,t,i,r){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=r}}const gx=5;class Wf extends fs{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=gx}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return Q()}getData(e){return null}prepareFrame(e){return Q()}renderFrame(e,t){return Q()}forEachFeatureAtCoordinate(e,t,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===ce.LOADED||t.getState()===ce.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=ce.LOADED&&t!=ce.ERROR&&e.addEventListener(re.CHANGE,this.boundHandleImageChange_),t==ce.IDLE&&(e.load(),t=e.getState()),t==ce.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const Yf=[];let Ar=null;function mx(){Ar=ze(1,1,void 0,{willReadFrequently:!0})}class $f extends Wf{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Ve(),this.pixelTransform=Ve(),this.inversePixelTransform=Ve(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,i){Ar||mx(),Ar.clearRect(0,0,1,1);let r;try{Ar.drawImage(e,t,i,1,1,0,0,1,1),r=Ar.getImageData(0,0,1,1).data}catch{return Ar=null,null}return r}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const r=this.getLayer().getClassName();let s,o;if(e&&e.className===r&&(!i||e&&e.style.backgroundColor&&An(Qt(e.style.backgroundColor),Qt(i)))){const a=e.firstElementChild;a instanceof HTMLCanvasElement&&(o=a.getContext("2d"))}if(o&&Gy(o.canvas.style.transform,t)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=document.createElement("div"),s.className=r;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=ze();const l=o.canvas;s.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const r=Di(i),s=ko(i),o=Fo(i),a=Do(i);Ne(t.coordinateToPixelTransform,r),Ne(t.coordinateToPixelTransform,s),Ne(t.coordinateToPixelTransform,o),Ne(t.coordinateToPixelTransform,a);const l=this.inversePixelTransform;Ne(l,r),Ne(l,s),Ne(l,o),Ne(l,a),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}prepareContainer(e,t){const i=e.extent,r=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,a=Math.round(xe(i)/r*o),l=Math.round(st(i)/r*o);qt(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-a/2,-l/2),xs(this.inversePixelTransform,this.pixelTransform);const c=Ny(this.pixelTransform);if(this.useContainer(t,c,this.getBackground(e)),!this.containerReused){const h=this.context.canvas;h.width!=a||h.height!=l?(h.width=a,h.height=l):this.context.clearRect(0,0,a,l),c!==h.style.transform&&(h.style.transform=c)}}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){const s=new Gs(e,this.inversePixelTransform,i,t);r.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(Je.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(Je.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new Nf),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Je.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Je.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,r,s,o,a){const l=s/2,c=o/2,h=r/t,u=-h,d=-e[0]+a,f=-e[1];return qt(this.tempTransform,l,c,h,u,-i,d,f)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class _x extends $f{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=ft(),this.wrappedRenderedExtent_=ft(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const r=t.extent,s=t.viewState,o=s.center,a=s.resolution,l=s.projection,c=s.rotation,h=l.getExtent(),u=this.getLayer().getSource(),d=this.getLayer().getDeclutter(),f=t.pixelRatio,g=t.viewHints,_=!(g[Qe.ANIMATING]||g[Qe.INTERACTING]),m=this.context,y=Math.round(xe(r)/a*f),p=Math.round(st(r)/a*f),E=u.getWrapX()&&l.canWrapX(),x=E?xe(h):null,v=E?Math.ceil((r[2]-h[2])/x)+1:1;let S=E?Math.floor((r[0]-h[0])/x):0;do{let w=this.getRenderTransform(o,a,0,f,y,p,S*x);t.declutter&&(w=w.slice(0)),e.execute(m,[m.canvas.width,m.canvas.height],w,c,_,i===void 0?Hi:i?Bf:cx,i?d&&t.declutter[d]:void 0)}while(++S<v)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=ze(this.context.canvas.width,this.context.canvas.height,Yf))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,ta(this.context),Yf.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const r=e.viewState;this.prepareContainer(e,t);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(Je.PRERENDER)||this.getLayer().hasListener(Je.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),r.projection,this.clipped_=!1,a&&i.extent&&this.clipping){const l=di(i.extent);a=gt(l,e.extent),this.clipped_=a&&!gr(l,e.extent),this.clipped_&&this.clipUnrotated(s,e,l)}return a&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),h=[],u=i[0]*_n,d=i[1]*_n;h.push(this.getRenderTransform(r,s,o,_n,u,d,0).slice());const f=c.getSource(),g=a.getExtent();if(f.getWrapX()&&a.canWrapX()&&!gr(g,l)){let _=l[0];const m=xe(g);let y=0,p;for(;_<g[0];)--y,p=m*y,h.push(this.getRenderTransform(r,s,o,_n,u,d,p).slice()),_+=m;for(y=0,_=l[2];_>g[2];)++y,p=m*y,h.push(this.getRenderTransform(r,s,o,_n,u,d,p).slice()),_-=m}this.hitDetectionImageData_=dx(i,h,this.renderedFeatures_,c.getStyleFunction(),l,s,o,xf(s,this.renderedPixelRatio_))}t(fx(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,r,s){var d,f;if(!this.replayGroup_)return;const o=t.viewState.resolution,a=t.viewState.rotation,l=this.getLayer(),c={},h=function(g,_,m){const y=J(g),p=c[y];if(p){if(p!==!0&&m<p.distanceSq){if(m===0)return c[y]=!0,s.splice(s.lastIndexOf(p),1),r(g,l,_);p.geometry=_,p.distanceSq=m}}else{if(m===0)return c[y]=!0,r(g,l,_);s.push(c[y]={feature:g,layer:l,geometry:_,distanceSq:m,callback:r})}},u=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,a,i,h,u?(f=(d=t.declutter)==null?void 0:d[u])==null?void 0:f.all().map(g=>g.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const r=e.viewHints[Qe.ANIMATING],s=e.viewHints[Qe.INTERACTING],o=t.getUpdateWhileAnimating(),a=t.getUpdateWhileInteracting();if(this.ready&&!o&&r||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,c=e.viewState,h=c.projection,u=c.resolution,d=e.pixelRatio,f=t.getRevision(),g=t.getRenderBuffer();let _=t.getRenderOrder();_===void 0&&(_=A0);const m=c.center.slice(),y=Mn(l,g*u),p=y.slice(),E=[y.slice()],x=h.getExtent();if(i.getWrapX()&&h.canWrapX()&&!gr(x,e.extent)){const B=xe(x),H=Math.max(xe(y)/2,B);y[0]=x[0]-H,y[2]=x[2]+H,vd(m,h);const A=dd(E[0],h);A[0]<x[0]&&A[2]<x[2]?E.push([A[0]+B,A[1],A[2]+B,A[3]]):A[0]>x[0]&&A[2]>x[2]&&E.push([A[0]-B,A[1],A[2]-B,A[3]])}if(this.ready&&this.renderedResolution_==u&&this.renderedRevision_==f&&this.renderedRenderOrder_==_&&this.renderedFrameDeclutter_===!!e.declutter&&gr(this.wrappedRenderedExtent_,y))return An(this.renderedExtent_,p)||(this.hitDetectionImageData_=null,this.renderedExtent_=p),this.renderedCenter_=m,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const v=new rx(vf(u,d),y,u,d);let S;for(let B=0,H=E.length;B<H;++B)i.loadFeatures(E[B],u,h);const w=xf(u,d);let b=!0;const P=(B,H)=>{let A;const k=B.getStyleFunction()||t.getStyleFunction();if(k&&(A=k(B,u)),A){const z=this.renderFeature(B,w,A,v,S,this.getLayer().getDeclutter(),H);b=b&&!z}},D=Fd(y),G=i.getFeaturesInExtent(D);_&&G.sort(_);for(let B=0,H=G.length;B<H;++B)P(G[B],B);this.renderedFeatures_=G,this.ready=b;const N=v.finish(),F=new hx(y,u,d,i.getOverlaps(),N,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=u,this.renderedRevision_=f,this.renderedRenderOrder_=_,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=p,this.wrappedRenderedExtent_=y,this.renderedCenter_=m,this.renderedProjection_=h,this.renderedPixelRatio_=d,this.replayGroup_=F,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,r,s,o,a){if(!i)return!1;let l=!1;if(Array.isArray(i))for(let c=0,h=i.length;c<h;++c)l=Ef(r,e,i[c],t,this.boundHandleStyleImageChange_,s,o,a)||l;else l=Ef(r,e,i,t,this.boundHandleStyleImageChange_,s,o,a);return l}}let Ki=0;const Xe=1<<Ki++,$=1<<Ki++,He=1<<Ki++,Oe=1<<Ki++,Rt=1<<Ki++,zt=1<<Ki++,ma=Math.pow(2,Ki)-1,Mc={[Xe]:"boolean",[$]:"number",[He]:"string",[Oe]:"color",[Rt]:"number[]",[zt]:"size"},px=Object.keys(Mc).map(Number).sort(In);function yx(n){return n in Mc}function Lr(n){const e=[];for(const t of px)Us(n,t)&&e.push(Mc[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Us(n,e){return(n&e)===e}function xi(n,e){return n===e}class Ke{constructor(e,t){if(!yx(e))throw new Error(`literal expressions must have a specific type, got ${Lr(e)}`);this.type=e,this.value=t}}class jf{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function _a(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function et(n,e,t){switch(typeof n){case"boolean":{if(xi(e,He))return new Ke(He,n?"true":"false");if(!Us(e,Xe))throw new Error(`got a boolean, but expected ${Lr(e)}`);return new Ke(Xe,n)}case"number":{if(xi(e,zt))return new Ke(zt,mt(n));if(xi(e,Xe))return new Ke(Xe,!!n);if(xi(e,He))return new Ke(He,n.toString());if(!Us(e,$))throw new Error(`got a number, but expected ${Lr(e)}`);return new Ke($,n)}case"string":{if(xi(e,Oe))return new Ke(Oe,yc(n));if(xi(e,Xe))return new Ke(Xe,!!n);if(!Us(e,He))throw new Error(`got a string, but expected ${Lr(e)}`);return new Ke(He,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return Ix(n,e,t);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(xi(e,zt)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new Ke(zt,n)}if(xi(e,Oe)){if(n.length===3)return new Ke(Oe,[...n,1]);if(n.length===4)return new Ke(Oe,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Us(e,Rt))throw new Error(`got an array of numbers, but expected ${Lr(e)}`);return new Ke(Rt,n)}const C={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},xx={[C.Get]:ee(ae(1,1/0),Vf),[C.Var]:ee(ae(1,1),vx),[C.Has]:ee(ae(1,1/0),Vf),[C.Id]:ee(Ex,Mr),[C.Concat]:ee(ae(2,1/0),ve(He)),[C.GeometryType]:ee(Tx,Mr),[C.LineMetric]:ee(Mr),[C.Resolution]:ee(Oc,Mr),[C.Zoom]:ee(Oc,Mr),[C.Time]:ee(Oc,Mr),[C.Any]:ee(ae(2,1/0),ve(Xe)),[C.All]:ee(ae(2,1/0),ve(Xe)),[C.Not]:ee(ae(1,1),ve(Xe)),[C.Equal]:ee(ae(2,2),ve(ma)),[C.NotEqual]:ee(ae(2,2),ve(ma)),[C.GreaterThan]:ee(ae(2,2),ve($)),[C.GreaterThanOrEqualTo]:ee(ae(2,2),ve($)),[C.LessThan]:ee(ae(2,2),ve($)),[C.LessThanOrEqualTo]:ee(ae(2,2),ve($)),[C.Multiply]:ee(ae(2,1/0),Xf),[C.Coalesce]:ee(ae(2,1/0),Xf),[C.Divide]:ee(ae(2,2),ve($)),[C.Add]:ee(ae(2,1/0),ve($)),[C.Subtract]:ee(ae(2,2),ve($)),[C.Clamp]:ee(ae(3,3),ve($)),[C.Mod]:ee(ae(2,2),ve($)),[C.Pow]:ee(ae(2,2),ve($)),[C.Abs]:ee(ae(1,1),ve($)),[C.Floor]:ee(ae(1,1),ve($)),[C.Ceil]:ee(ae(1,1),ve($)),[C.Round]:ee(ae(1,1),ve($)),[C.Sin]:ee(ae(1,1),ve($)),[C.Cos]:ee(ae(1,1),ve($)),[C.Atan]:ee(ae(1,2),ve($)),[C.Sqrt]:ee(ae(1,1),ve($)),[C.Match]:ee(ae(4,1/0),Hf,Sx),[C.Between]:ee(ae(3,3),ve($)),[C.Interpolate]:ee(ae(6,1/0),Hf,bx),[C.Case]:ee(ae(3,1/0),wx,Cx),[C.In]:ee(ae(2,2),Rx),[C.Number]:ee(ae(1,1/0),ve(ma)),[C.String]:ee(ae(1,1/0),ve(ma)),[C.Array]:ee(ae(1,1/0),ve($)),[C.Color]:ee(ae(1,4),ve($)),[C.Band]:ee(ae(1,3),ve($)),[C.Palette]:ee(ae(2,2),Px),[C.ToString]:ee(ae(1,1),ve(Xe|$|He|Oe))};function Vf(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new Ke($,o);break}case"string":{r[s]=new Ke(He,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&t.properties.add(String(o))}return r}function vx(n,e,t){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return t.variables.add(i),[new Ke(He,i)]}function Ex(n,e,t){t.featureId=!0}function Tx(n,e,t){t.geometryType=!0}function Oc(n,e,t){t.mapState=!0}function Mr(n,e,t){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function ae(n,e){return function(t,i,r){const s=t[0],o=t.length-1;if(n===e){if(o!==n){const a=n===1?"":"s";throw new Error(`expected ${n} argument${a} for ${s}, got ${o}`)}}else if(o<n||o>e){const a=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function Xf(n,e,t){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=et(n[s+1],e,t);r[s]=o}return r}function ve(n){return function(e,t,i){const r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const a=et(e[o+1],n,i);s[o]=a}return s}}function wx(n,e,t){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function Hf(n,e,t){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function Sx(n,e,t){const i=n.length-1,r=He|$|Xe,s=et(n[1],r,t),o=et(n[n.length-1],e,t),a=new Array(i-2);for(let l=0;l<i-2;l+=2){try{const c=et(n[l+2],s.type,t);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{const c=et(n[l+3],o.type,t);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[s,...a,o]}function bx(n,e,t){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const l=i[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);r=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new Ke($,r);let o;try{o=et(n[2],$,t)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const a=new Array(n.length-3);for(let l=0;l<a.length;l+=2){try{const c=et(n[l+3],$,t);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{const c=et(n[l+4],e,t);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[s,o,...a]}function Cx(n,e,t){const i=et(n[n.length-1],e,t),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=et(n[s+1],Xe,t);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=et(n[s+2],i.type,t);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function Rx(n,e,t){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=He}else r=$;const s=new Array(i.length);for(let a=0;a<s.length;a++)try{const l=et(i[a],r,t);s[a]=l}catch(l){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${l.message}`)}return[et(n[1],r,t),...s]}function Px(n,e,t){let i;try{i=et(n[1],$,t)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let a;try{a=et(r[o],Oe,t)}catch(l){throw new Error(`failed to parse color at index ${o} in palette expression: ${l.message}`)}if(!(a instanceof Ke))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[i,...s]}function ee(...n){return function(e,t,i){const r=e[0];let s;for(let o=0;o<n.length;o++){const a=n[o](e,t,i);if(o==n.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new jf(t,r,...s)}}function Ix(n,e,t){const i=n[0],r=xx[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,e,t)}function pa(n){if(!n)return"";const e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return pa(n.getGeometries()[0]);default:return""}}function Dc(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function pn(n,e,t){const i=et(n,e,t);return en(i)}function en(n,e){if(n instanceof Ke){if(n.type===Oe&&typeof n.value=="string"){const i=yc(n.value);return function(){return i}}return function(){return n.value}}const t=n.operator;switch(t){case C.Number:case C.String:case C.Coalesce:return Ax(n);case C.Get:case C.Var:case C.Has:return Lx(n);case C.Id:return i=>i.featureId;case C.GeometryType:return i=>i.geometryType;case C.Concat:{const i=n.args.map(r=>en(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case C.Resolution:return i=>i.resolution;case C.Any:case C.All:case C.Between:case C.In:case C.Not:return Ox(n);case C.Equal:case C.NotEqual:case C.LessThan:case C.LessThanOrEqualTo:case C.GreaterThan:case C.GreaterThanOrEqualTo:return Mx(n);case C.Multiply:case C.Divide:case C.Add:case C.Subtract:case C.Clamp:case C.Mod:case C.Pow:case C.Abs:case C.Floor:case C.Ceil:case C.Round:case C.Sin:case C.Cos:case C.Atan:case C.Sqrt:return Dx(n);case C.Case:return Fx(n);case C.Match:return kx(n);case C.Interpolate:return Nx(n);case C.ToString:return Gx(n);default:throw new Error(`Unsupported operator ${t}`)}}function Ax(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=en(n.args[s]);switch(t){case C.Coalesce:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case C.Number:case C.String:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a===t)return a}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function Lx(n,e){const i=n.args[0].value;switch(n.operator){case C.Get:return r=>{const s=n.args;let o=r.properties[i];for(let a=1,l=s.length;a<l;++a){const h=s[a].value;o=o[h]}return o};case C.Var:return r=>r.variables[i];case C.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let a=1,l=s.length;a<l;++a){const h=s[a].value;if(!o||!Object.hasOwn(o,h))return!1;o=o[h]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function Mx(n,e){const t=n.operator,i=en(n.args[0]),r=en(n.args[1]);switch(t){case C.Equal:return s=>i(s)===r(s);case C.NotEqual:return s=>i(s)!==r(s);case C.LessThan:return s=>i(s)<r(s);case C.LessThanOrEqualTo:return s=>i(s)<=r(s);case C.GreaterThan:return s=>i(s)>r(s);case C.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function Ox(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=en(n.args[s]);switch(t){case C.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case C.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case C.Between:return s=>{const o=r[0](s),a=r[1](s),l=r[2](s);return o>=a&&o<=l};case C.In:return s=>{const o=r[0](s);for(let a=1;a<i;++a)if(o===r[a](s))return!0;return!1};case C.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function Dx(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=en(n.args[s]);switch(t){case C.Multiply:return s=>{let o=1;for(let a=0;a<i;++a)o*=r[a](s);return o};case C.Divide:return s=>r[0](s)/r[1](s);case C.Add:return s=>{let o=0;for(let a=0;a<i;++a)o+=r[a](s);return o};case C.Subtract:return s=>r[0](s)-r[1](s);case C.Clamp:return s=>{const o=r[0](s),a=r[1](s);if(o<a)return a;const l=r[2](s);return o>l?l:o};case C.Mod:return s=>r[0](s)%r[1](s);case C.Pow:return s=>Math.pow(r[0](s),r[1](s));case C.Abs:return s=>Math.abs(r[0](s));case C.Floor:return s=>Math.floor(r[0](s));case C.Ceil:return s=>Math.ceil(r[0](s));case C.Round:return s=>Math.round(r[0](s));case C.Sin:return s=>Math.sin(r[0](s));case C.Cos:return s=>Math.cos(r[0](s));case C.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case C.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function Fx(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=en(n.args[r]);return r=>{for(let s=0;s<t-1;s+=2)if(i[s](r))return i[s+1](r);return i[t-1](r)}}function kx(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=en(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<t-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[t-1](r)}}function Nx(n,e){const t=n.args.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=en(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let a,l;for(let c=2;c<t;c+=2){const h=i[c](r);let u=i[c+1](r);const d=Array.isArray(u);if(d&&(u=f0(u)),h>=o)return c===2?u:d?Ux(s,o,a,l,h,u):Bs(s,o,a,l,h,u);a=h,l=u}return l}}function Gx(n,e){const t=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=en(n.args[s]);switch(t){case C.ToString:return s=>{const o=r[0](s);return n.args[0].type===Oe?xc(o):o.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function Bs(n,e,t,i,r,s){const o=r-t;if(o===0)return i;const a=e-t,l=n===1?a/o:(Math.pow(n,a)-1)/(Math.pow(n,o)-1);return i+l*(s-i)}function Ux(n,e,t,i,r,s){if(r-t===0)return i;const a=af(i),l=af(s);let c=l[2]-a[2];c>180?c-=360:c<-180&&(c+=360);const h=[Bs(n,e,t,a[0],r,l[0]),Bs(n,e,t,a[1],r,l[1]),a[2]+Bs(n,e,t,0,r,c),Bs(n,e,t,i[3],r,s[3])];return g0(h)}function Bx(n){return!0}function zx(n){const e=_a(),t=Wx(n,e),i=Dc();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,e.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=pa(r.getGeometry())),t(i)}}function Kf(n){const e=_a(),t=n.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=Fc(n[o],e);const r=Dc(),s=new Array(t);return function(o,a){if(r.properties=o.getPropertiesInternal(),r.resolution=a,e.featureId){const c=o.getId();c!==void 0?r.featureId=c:r.featureId=null}let l=0;for(let c=0;c<t;++c){const h=i[c](r);h&&(s[l]=h,l+=1)}return s.length=l,s}}function Wx(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r){const s=n[r],o="filter"in s?pn(s.filter,Xe,e):Bx;let a;if(Array.isArray(s.style)){const l=s.style.length;a=new Array(l);for(let c=0;c<l;++c)a[c]=Fc(s.style[c],e)}else a=[Fc(s.style,e)];i[r]={filter:o,styles:a}}return function(r){const s=[];let o=!1;for(let a=0;a<t;++a){const l=i[a].filter;if(l(r)&&!(n[a].else&&o)){o=!0;for(const c of i[a].styles){const h=c(r);h&&s.push(h)}}}return s}}function Fc(n,e){const t=zs(n,"",e),i=Ws(n,"",e),r=Yx(n,e),s=$x(n,e),o=Pt(n,"z-index",e);if(!t&&!i&&!r&&!s&&!Li(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const a=new _t;return function(l){let c=!0;if(t){const h=t(l);h&&(c=!1),a.setFill(h)}if(i){const h=i(l);h&&(c=!1),a.setStroke(h)}if(r){const h=r(l);h&&(c=!1),a.setText(h)}if(s){const h=s(l);h&&(c=!1),a.setImage(h)}return o&&a.setZIndex(o(l)),c?null:a}}function zs(n,e,t){let i;if(e+"fill-pattern-src"in n)i=Hx(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return s=>null;i=kc(n,e+"fill-color",t)}if(!i)return null;const r=new Gn;return function(s){const o=i(s);return o===uc?null:(r.setColor(o),r)}}function Ws(n,e,t){const i=Pt(n,e+"stroke-width",t),r=kc(n,e+"stroke-color",t);if(!i&&!r)return null;const s=zn(n,e+"stroke-line-cap",t),o=zn(n,e+"stroke-line-join",t),a=Zf(n,e+"stroke-line-dash",t),l=Pt(n,e+"stroke-line-dash-offset",t),c=Pt(n,e+"stroke-miter-limit",t),h=new kt;return function(u){if(r){const d=r(u);if(d===uc)return null;h.setColor(d)}if(i&&h.setWidth(i(u)),s){const d=s(u);if(d!=="butt"&&d!=="round"&&d!=="square")throw new Error("Expected butt, round, or square line cap");h.setLineCap(d)}if(o){const d=o(u);if(d!=="bevel"&&d!=="round"&&d!=="miter")throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(d)}return a&&h.setLineDash(a(u)),l&&h.setLineDashOffset(l(u)),c&&h.setMiterLimit(c(u)),h}}function Yx(n,e){const t="text-",i=zn(n,t+"value",e);if(!i)return null;const r=zs(n,t,e),s=zs(n,t+"background-",e),o=Ws(n,t,e),a=Ws(n,t+"background-",e),l=zn(n,t+"font",e),c=Pt(n,t+"max-angle",e),h=Pt(n,t+"offset-x",e),u=Pt(n,t+"offset-y",e),d=Or(n,t+"overflow",e),f=zn(n,t+"placement",e),g=Pt(n,t+"repeat",e),_=xa(n,t+"scale",e),m=Or(n,t+"rotate-with-view",e),y=Pt(n,t+"rotation",e),p=zn(n,t+"align",e),E=zn(n,t+"justify",e),x=zn(n,t+"baseline",e),v=Or(n,t+"keep-upright",e),S=Zf(n,t+"padding",e),w=Ea(n,t+"declutter-mode"),b=new Vi({declutterMode:w});return function(P){if(b.setText(i(P)),r&&b.setFill(r(P)),s&&b.setBackgroundFill(s(P)),o&&b.setStroke(o(P)),a&&b.setBackgroundStroke(a(P)),l&&b.setFont(l(P)),c&&b.setMaxAngle(c(P)),h&&b.setOffsetX(h(P)),u&&b.setOffsetY(u(P)),d&&b.setOverflow(d(P)),f){const D=f(P);if(D!=="point"&&D!=="line")throw new Error("Expected point or line for text-placement");b.setPlacement(D)}if(g&&b.setRepeat(g(P)),_&&b.setScale(_(P)),m&&b.setRotateWithView(m(P)),y&&b.setRotation(y(P)),p){const D=p(P);if(D!=="left"&&D!=="center"&&D!=="right"&&D!=="end"&&D!=="start")throw new Error("Expected left, right, center, start, or end for text-align");b.setTextAlign(D)}if(E){const D=E(P);if(D!=="left"&&D!=="right"&&D!=="center")throw new Error("Expected left, right, or center for text-justify");b.setJustify(D)}if(x){const D=x(P);if(D!=="bottom"&&D!=="top"&&D!=="middle"&&D!=="alphabetic"&&D!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");b.setTextBaseline(D)}return S&&b.setPadding(S(P)),v&&b.setKeepUpright(v(P)),b}}function $x(n,e){return"icon-src"in n?jx(n,e):"shape-points"in n?Vx(n,e):"circle-radius"in n?Xx(n,e):null}function jx(n,e){const t="icon-",i=t+"src",r=eg(n[i],i),s=ya(n,t+"anchor",e),o=xa(n,t+"scale",e),a=Pt(n,t+"opacity",e),l=ya(n,t+"displacement",e),c=Pt(n,t+"rotation",e),h=Or(n,t+"rotate-with-view",e),u=Jf(n,t+"anchor-origin"),d=Qf(n,t+"anchor-x-units"),f=Qf(n,t+"anchor-y-units"),g=Jx(n,t+"color"),_=Zx(n,t+"cross-origin"),m=qx(n,t+"offset"),y=Jf(n,t+"offset-origin"),p=va(n,t+"width"),E=va(n,t+"height"),x=Kx(n,t+"size"),v=Ea(n,t+"declutter-mode"),S=new Ns({src:r,anchorOrigin:u,anchorXUnits:d,anchorYUnits:f,color:g,crossOrigin:_,offset:m,offsetOrigin:y,height:E,width:p,size:x,declutterMode:v});return function(w){return a&&S.setOpacity(a(w)),l&&S.setDisplacement(l(w)),c&&S.setRotation(c(w)),h&&S.setRotateWithView(h(w)),o&&S.setScale(o(w)),s&&S.setAnchor(s(w)),S}}function Vx(n,e){const t="shape-",i=t+"points",r=t+"radius",s=Nc(n[i],i),o=Nc(n[r],r),a=zs(n,t,e),l=Ws(n,t,e),c=xa(n,t+"scale",e),h=ya(n,t+"displacement",e),u=Pt(n,t+"rotation",e),d=Or(n,t+"rotate-with-view",e),f=va(n,t+"radius2"),g=va(n,t+"angle"),_=Ea(n,t+"declutter-mode"),m=new da({points:s,radius:o,radius2:f,angle:g,declutterMode:_});return function(y){return a&&m.setFill(a(y)),l&&m.setStroke(l(y)),h&&m.setDisplacement(h(y)),u&&m.setRotation(u(y)),d&&m.setRotateWithView(d(y)),c&&m.setScale(c(y)),m}}function Xx(n,e){const t="circle-",i=zs(n,t,e),r=Ws(n,t,e),s=Pt(n,t+"radius",e),o=xa(n,t+"scale",e),a=ya(n,t+"displacement",e),l=Pt(n,t+"rotation",e),c=Or(n,t+"rotate-with-view",e),h=Ea(n,t+"declutter-mode"),u=new ji({radius:5,declutterMode:h});return function(d){return s&&u.setRadius(s(d)),i&&u.setFill(i(d)),r&&u.setStroke(r(d)),a&&u.setDisplacement(a(d)),l&&u.setRotation(l(d)),c&&u.setRotateWithView(c(d)),o&&u.setScale(o(d)),u}}function Pt(n,e,t){if(!(e in n))return;const i=pn(n[e],$,t);return function(r){return Nc(i(r),e)}}function zn(n,e,t){if(!(e in n))return null;const i=pn(n[e],He,t);return function(r){return eg(i(r),e)}}function Hx(n,e,t){const i=zn(n,e+"pattern-src",t),r=qf(n,e+"pattern-offset",t),s=qf(n,e+"pattern-size",t),o=kc(n,e+"color",t);return function(a){return{src:i(a),offset:r&&r(a),size:s&&s(a),color:o&&o(a)}}}function Or(n,e,t){if(!(e in n))return null;const i=pn(n[e],Xe,t);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function kc(n,e,t){if(!(e in n))return null;const i=pn(n[e],Oe,t);return function(r){return tg(i(r),e)}}function Zf(n,e,t){if(!(e in n))return null;const i=pn(n[e],Rt,t);return function(r){return Ys(i(r),e)}}function ya(n,e,t){if(!(e in n))return null;const i=pn(n[e],Rt,t);return function(r){const s=Ys(i(r),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function qf(n,e,t){if(!(e in n))return null;const i=pn(n[e],Rt,t);return function(r){return ng(i(r),e)}}function xa(n,e,t){if(!(e in n))return null;const i=pn(n[e],Rt|$,t);return function(r){return Qx(i(r),e)}}function va(n,e){const t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function Kx(n,e){const t=n[e];if(t!==void 0){if(typeof t=="number")return mt(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function Zx(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function Jf(n,e){const t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function Qf(n,e){const t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function qx(n,e){const t=n[e];if(t!==void 0)return Ys(t,e)}function Ea(n,e){const t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function Jx(n,e){const t=n[e];if(t!==void 0)return tg(t,e)}function Ys(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);const t=n.length;for(let i=0;i<t;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function eg(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function Nc(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function tg(n,e){if(typeof n=="string")return n;const t=Ys(n,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function ng(n,e){const t=Ys(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function Qx(n,e){return typeof n=="number"?n:ng(n,e)}const tn={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function ig(n,e,t){return function(i,r,s,o,a){if(!i)return;if(!r&&!e)return i;const l=e?0:s[0]*r,c=e?0:s[1]*r,h=a?a[0]:0,u=a?a[1]:0;let d=n[0]+l/2+h,f=n[2]-l/2+h,g=n[1]+c/2+u,_=n[3]-c/2+u;d>f&&(d=(f+d)/2,f=d),g>_&&(g=(_+g)/2,_=g);let m=Me(i[0],d,f),y=Me(i[1],g,_);if(o&&t&&r){const p=30*r;m+=-p*Math.log(1+Math.max(0,d-i[0])/p)+p*Math.log(1+Math.max(0,i[0]-f)/p),y+=-p*Math.log(1+Math.max(0,g-i[1])/p)+p*Math.log(1+Math.max(0,i[1]-_)/p)}return[m,y]}}function ev(n){return n}function rg(n){return Math.pow(n,3)}function vi(n){return 1-rg(1-n)}function Gc(n){return 3*n*n-2*n*n*n}function sg(n){return n}function tv(n){return n<.5?Gc(2*n):1-Gc(2*(n-.5))}function Uc(n,e,t,i){const r=xe(e)/t[0],s=st(e)/t[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function Bc(n,e,t){let i=Math.min(n,e);const r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),Me(i,t/2,e*2)}function nv(n,e,t,i){return e=e!==void 0?e:!0,function(r,s,o,a){if(r!==void 0){const l=n[0],c=n[n.length-1],h=t?Uc(l,t,o,i):l;if(a)return e?Bc(r,h,c):Me(r,c,h);const u=Math.min(h,r),d=Math.floor(Il(n,u,s));return n[d]>h&&d<n.length-1?n[d+1]:n[d]}}}function iv(n,e,t,i,r,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,function(o,a,l,c){if(o!==void 0){const h=r?Uc(e,r,l,s):e;if(c)return i?Bc(o,h,t):Me(o,t,h);const u=1e-9,d=Math.ceil(Math.log(e/h)/Math.log(n)-u),f=-a*(.5-u)+.5,g=Math.min(h,o),_=Math.floor(Math.log(e/g)/Math.log(n)+f),m=Math.max(d,_),y=e/Math.pow(n,m);return Me(y,t,h)}}}function og(n,e,t,i,r){return t=t!==void 0?t:!0,function(s,o,a,l){if(s!==void 0){const c=i?Uc(n,i,a,r):n;return!t||!l?Me(s,e,c):Bc(s,c,e)}}}function zc(n){if(n!==void 0)return 0}function ag(n){if(n!==void 0)return n}function rv(n){const e=2*Math.PI/n;return function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t}}function sv(n){const e=ui(5);return function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t}}const ov=42,Wc=256,Yc=0;class yn extends St{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Vl(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&Od(),e.center&&(e.center=Dn(e.center,this.projection_)),e.extent&&(e.extent=di(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const a in tn)delete t[a];this.setProperties(t,!0);const i=lv(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const r=av(e),s=i.constraint,o=cv(e);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const r=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-t[3]+t[1]-r[1]),a=s/2*(r[0]-t[0]+t[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=Dn(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=Dn(r.anchor,this.getProjection())),t[i]=r}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let r=0;for(;r<t&&!this.isDef();++r){const h=arguments[r];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(r===t){i&&Ta(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const c=[];for(;r<t;++r){const h=arguments[r],u={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||Gc,callback:i};if(h.center&&(u.sourceCenter=o,u.targetCenter=h.center.slice(),o=u.targetCenter),h.zoom!==void 0?(u.sourceResolution=a,u.targetResolution=this.getResolutionForZoom(h.zoom),a=u.targetResolution):h.resolution&&(u.sourceResolution=a,u.targetResolution=h.resolution,a=u.targetResolution),h.rotation!==void 0){u.sourceRotation=l;const d=ki(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;u.targetRotation=l+d,l=u.targetRotation}hv(u)?u.complete=!0:s+=u.duration,c.push(u)}this.animations_.push(c),this.setHint(Qe.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Qe.ANIMATING]>0}getInteracting(){return this.hints_[Qe.INTERACTING]>0}cancelAnimations(){this.setHint(Qe.ANIMATING,-this.hints_[Qe.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const r=this.animations_[t];if(r[0].callback&&Ta(r[0].callback,!1),!e)for(let s=0,o=r.length;s<o;++s){const a=r[s];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l.complete)continue;const c=e-l.start;let h=l.duration>0?c/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const u=l.easing(h);if(l.sourceCenter){const d=l.sourceCenter[0],f=l.sourceCenter[1],g=l.targetCenter[0],_=l.targetCenter[1];this.nextCenter_=l.targetCenter;const m=d+u*(g-d),y=f+u*(_-f);this.targetCenter_=[m,y]}if(l.sourceResolution&&l.targetResolution){const d=u===1?l.targetResolution:l.sourceResolution+u*(l.targetResolution-l.sourceResolution);if(l.anchor){const f=this.getViewportSize_(this.getRotation()),g=this.constraints_.resolution(d,0,f,!0);this.targetCenter_=this.calculateCenterZoom(g,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=d,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const d=u===1?ki(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+u*(l.targetRotation-l.sourceRotation);if(l.anchor){const f=this.constraints_.rotation(d,!0);this.targetCenter_=this.calculateCenterRotate(f,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=d}if(this.applyTargetState_(!0),t=!0,!l.complete)break}if(s){this.animations_[i]=null,this.setHint(Qe.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&Ta(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-t[0],r[1]-t[1]],Nl(i,e-this.getRotation()),yd(i,t)),i}calculateCenterZoom(e,t){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-r[0])/s,a=t[1]-e*(t[1]-r[1])/s;i=[o,a]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],r=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(r*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(r*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&Hl(e,this.getProjection())}getCenterInternal(){return this.get(tn.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return Fd(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();fe(t,"The view center is not defined");const i=this.getResolution();fe(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return fe(r!==void 0,"The view rotation is not defined"),Fl(t,i,r,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(tn.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(di(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=xe(e)/t[0],r=st(e)/t[1];return Math.max(i,r)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(t/i)/Math.log(e);return function(s){return t/Math.pow(e,s*r)}}getRotation(){return this.get(tn.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/t;return function(o){return Math.log(i/o)/t/s}}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=$c(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:r.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,r;if(this.resolutions_){const s=Il(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return t+Math.log(i/e)/Math.log(r)}getResolutionForZoom(e){var t;if((t=this.resolutions_)!=null&&t.length){if(this.resolutions_.length===1)return this.resolutions_[0];const i=Me(Math.floor(e),0,this.resolutions_.length-2),r=this.resolutions_[i]/this.resolutions_[i+1];return this.resolutions_[i]/Math.pow(r,Me(e-i,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(fe(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){fe(!ms(e),"Cannot fit empty extent provided as `geometry`");const r=di(e,this.getProjection());i=Qd(r)}else if(e.getType()==="Circle"){const r=di(e.getExtent(),this.getProjection());i=Qd(r),i.rotate(this.getRotation(),Kt(r))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),r=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let a=1/0,l=1/0,c=-1/0,h=-1/0;for(let u=0,d=s.length;u<d;u+=o){const f=s[u]*i-s[u+1]*r,g=s[u]*r+s[u+1]*i;a=Math.min(a,f),l=Math.min(l,g),c=Math.max(c,f),h=Math.max(h,g)}return[a,l,c,h]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const r=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const a=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(a,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,s?0:1);const c=this.getRotation(),h=Math.sin(c),u=Math.cos(c),d=Kt(a);d[0]+=(r[1]-r[3])/2*l,d[1]+=(r[0]-r[2])/2*l;const f=d[0]*u-d[1]*h,g=d[1]*u+d[0]*h,_=this.getConstrainedCenter([f,g],l),m=t.callback?t.callback:ds;t.duration!==void 0?this.animateInternal({resolution:l,center:_,duration:t.duration,easing:t.easing},m):(this.targetResolution_=l,this.targetCenter_=_,this.applyTargetState_(!1,!0),Ta(m,!0))}centerOn(e,t,i){this.centerOnInternal(Dn(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal($c(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,r){let s;const o=this.padding_;if(o&&e){const a=this.getViewportSizeMinusPadding_(-i),l=$c(e,r,[a[0]/2+o[3],a[1]/2+o[0]],t,i);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=Hl(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Dn(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,r,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Dn(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Dn(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),a=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(tn.ROTATION)!==r&&this.set(tn.ROTATION,r),this.get(tn.RESOLUTION)!==o&&(this.set(tn.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(tn.CENTER)||!Bo(this.get(tn.CENTER),a))&&this.set(tn.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const r=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,r,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!Bo(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:a,duration:e,easing:vi,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Qe.INTERACTING,1)}endInteraction(e,t,i){i=i&&Dn(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(Qe.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function Ta(n,e){setTimeout(function(){n(e)},0)}function av(n){if(n.extent!==void 0){const t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return ig(n.extent,n.constrainOnlyCenter,t)}const e=Vl(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,ig(t,!1,!1)}return ev}function lv(n){let e,t,i,o=n.minZoom!==void 0?n.minZoom:Yc,a=n.maxZoom!==void 0?n.maxZoom:28;const l=n.zoomFactor!==void 0?n.zoomFactor:2,c=n.multiWorld!==void 0?n.multiWorld:!1,h=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,u=n.showFullExtent!==void 0?n.showFullExtent:!1,d=Vl(n.projection,"EPSG:3857"),f=d.getExtent();let g=n.constrainOnlyCenter,_=n.extent;if(!c&&!_&&d.isGlobal()&&(g=!1,_=f),n.resolutions!==void 0){const m=n.resolutions;t=m[o],i=m[a]!==void 0?m[a]:m[m.length-1],n.constrainResolution?e=nv(m,h,!g&&_,u):e=og(t,i,h,!g&&_,u)}else{const y=(f?Math.max(xe(f),st(f)):360*pr.degrees/d.getMetersPerUnit())/Wc/Math.pow(2,Yc),p=y/Math.pow(2,28-Yc);t=n.maxResolution,t!==void 0?o=0:t=y/Math.pow(l,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(l,a):i=y/Math.pow(l,a):i=p),a=o+Math.floor(Math.log(t/i)/Math.log(l)),i=t/Math.pow(l,a-o),n.constrainResolution?e=iv(l,t,i,h,!g&&_,u):e=og(t,i,h,!g&&_,u)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:l}}function cv(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const t=n.constrainRotation;return t===void 0||t===!0?sv():t===!1?ag:typeof t=="number"?rv(t):ag}return zc}function hv(n){return!(n.sourceCenter&&n.targetCenter&&!Bo(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function $c(n,e,t,i,r){const s=Math.cos(-r);let o=Math.sin(-r),a=n[0]*s-n[1]*o,l=n[1]*s+n[0]*o;a+=(e[0]/2-t[0])*i,l+=(t[1]-e[1]/2)*i,o=-o;const c=a*s-l*o,h=l*s+a*o;return[c,h]}const Ee={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class Dr extends St{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[Ee.OPACITY]=e.opacity!==void 0?e.opacity:1,fe(typeof t[Ee.OPACITY]=="number","Layer opacity must be a number"),t[Ee.VISIBLE]=e.visible!==void 0?e.visible:!0,t[Ee.Z_INDEX]=e.zIndex,t[Ee.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[Ee.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[Ee.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[Ee.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=Me(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return Q()}getLayerStatesArray(e){return Q()}getExtent(){return this.get(Ee.EXTENT)}getMaxResolution(){return this.get(Ee.MAX_RESOLUTION)}getMinResolution(){return this.get(Ee.MIN_RESOLUTION)}getMinZoom(){return this.get(Ee.MIN_ZOOM)}getMaxZoom(){return this.get(Ee.MAX_ZOOM)}getOpacity(){return this.get(Ee.OPACITY)}getSourceState(){return Q()}getVisible(){return this.get(Ee.VISIBLE)}getZIndex(){return this.get(Ee.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(Ee.EXTENT,e)}setMaxResolution(e){this.set(Ee.MAX_RESOLUTION,e)}setMinResolution(e){this.set(Ee.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(Ee.MAX_ZOOM,e)}setMinZoom(e){this.set(Ee.MIN_ZOOM,e)}setOpacity(e){fe(typeof e=="number","Layer opacity must be a number"),this.set(Ee.OPACITY,e)}setVisible(e){this.set(Ee.VISIBLE,e)}setZIndex(e){this.set(Ee.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Zi extends Dr{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(Ee.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(Ee.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(be(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=he(e,re.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof yn?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(t.layerStatesArray){if(r=t.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return jc(r,t.viewState)&&(!s||gt(s,t.extent))}getAttributions(e){var s;if(!this.isVisible(e))return[];const t=(s=this.getSource())==null?void 0:s.getAttributions();if(!t)return[];const i=e instanceof yn?e.getViewStateAndExtent():e;let r=t(i);return Array.isArray(r)||(r=[r]),r}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(Ee.MAP,e)}getMapInternal(){return this.get(Ee.MAP)}setMap(e){this.mapPrecomposeKey_&&(be(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(be(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=he(e,Je.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=he(this,re.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const t=e.frameState.layerStatesArray,i=this.getLayerState(!1);fe(!t.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(i)}setSource(e){this.set(Ee.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function jc(n,e){if(!n.visible)return!1;const t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;const i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}const lg={RENDER_ORDER:"renderOrder"};class wa extends Zi{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(lg.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new Rf(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(lg.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?Of:e;const t=uv(e);this.styleFunction_=e===null?void 0:Z0(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function uv(n){if(n===void 0)return Of;if(!n)return null;if(typeof n=="function"||n instanceof _t)return n;if(!Array.isArray(n))return Kf([n]);if(n.length===0)return[];const e=n.length,t=n[0];if(t instanceof _t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!(o instanceof _t))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in t){const r=new Array(e);for(let s=0;s<e;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return zx(r)}return Kf(n)}class $s extends wa{constructor(e){super(e)}createRenderer(){return new _x(this)}}const q={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class Sa extends Lo{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(re.CHANGE)}release(){this.setState(q.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==q.EMPTY){if(this.state!==q.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){Q()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const r=t-i+1e3/60;return r>=this.transition_?1:rg(r/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}class Vc extends Sa{constructor(e,t,i,r,s,o){super(e,t,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_=new Image,r!==null&&(this.image_.crossOrigin=r),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=q.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=q.ERROR,this.unlistenImage_(),this.image_=dv(),this.changed()}handleImageLoad_(){const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=q.LOADED:this.state=q.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==q.ERROR&&(this.state=q.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==q.IDLE&&(this.state=q.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=m0(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function dv(){const n=ze(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}class fv{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}class Fr extends Ln{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class Ei extends Fr{constructor(e,t,i,r,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Fe={SINGLECLICK:"singleclick",CLICK:re.CLICK,DBLCLICK:re.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Xc={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class gv extends Lo{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=he(i,Xc.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=he(i,Xc.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(re.TOUCHMOVE,this.boundHandleTouchMove_,nf?{passive:!1}:!1)}emulateClick_(e){let t=new Ei(Fe.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Ei(Fe.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new Ei(Fe.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==Fe.POINTERUP||t.type==Fe.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==t.target){delete this.trackedTouches_[r];break}}else(t.type==Fe.POINTERDOWN||t.type==Fe.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Ei(Fe.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(be),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Ei(Fe.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(he(i,Fe.POINTERMOVE,this.handlePointerMove_,this),he(i,Fe.POINTERUP,this.handlePointerUp_,this),he(this.element_,Fe.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(he(this.element_.getRootNode(),Fe.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Ei(Fe.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Ei(Fe.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(be(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(re.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(be(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(be),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Wn={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},at={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},ba=1/0;class mv{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,dr(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(e){fe(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=ba?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,r=t.length,s=t[e],o=i[e],a=e;for(;e<r>>1;){const l=this.getLeftChildIndex_(e),c=this.getRightChildIndex_(e),h=c<r&&i[c]<i[l]?c:l;t[e]=t[h],i[e]=i[h],e=h}t[e]=s,i[e]=o,this.siftDown_(a,e)}siftDown_(e,t){const i=this.elements_,r=this.priorities_,s=i[t],o=r[t];for(;t>e;){const a=this.getParentIndex_(t);if(r[a]>o)i[t]=i[a],r[t]=r[a],t=a;else break}i[t]=s,r[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let r=0;const s=t.length;let o,a,l;for(a=0;a<s;++a)o=t[a],l=e(o),l==ba?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=l,t[r++]=o);t.length=r,i.length=r,this.heapify_()}}class _v extends mv{constructor(e,t){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(re.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===q.LOADED||i===q.ERROR||i===q.EMPTY){i!==q.ERROR&&t.removeEventListener(re.CHANGE,this.boundHandleTileChange_);const r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===q.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function pv(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return ba;const s=n.viewState.center,o=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}class qi extends St{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){var e;(e=this.element)==null||e.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){var t;this.map_&&((t=this.element)==null||t.remove());for(let i=0,r=this.listenerKeys.length;i<r;++i)be(this.listenerKeys[i]);if(this.listenerKeys.length=0,this.map_=e,e){const i=this.target_??e.getOverlayContainerStopEvent();this.element&&i.appendChild(this.element),this.render!==ds&&this.listenerKeys.push(he(e,Wn.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class yv extends qi{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",r=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"›",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=e.label!==void 0?e.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(re.CLICK,this.handleClick_.bind(this),!1);const c=t+" "+Cs+" "+Tc+(this.collapsed_&&this.collapsible_?" "+hf:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=c,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=this.getMap().getAllLayers(),i=new Set(t.flatMap(r=>r.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!t.some(s=>{var o;return((o=s.getSource())==null?void 0:o.getAttributionsCollapsible())===!1});this.setCollapsible(r)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(r=>Yp(()=>r))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!An(t,this.renderedAttributions_)){sf(this.ulElement_);for(let r=0,s=t.length;r<s;++r){const o=document.createElement("li");o.innerHTML=t[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(hf),this.collapsed_?rf(this.collapseLabel_,this.label_):rf(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class xv extends qi{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"⇧",r=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(re.CLICK,this.handleClick_.bind(this),!1);const a=t+" "+Cs+" "+Tc,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(ia)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:vi}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(ia);!s&&i===0?this.element.classList.add(ia):s&&i!==0&&this.element.classList.remove(ia)}this.label_.style.transform=r}this.rotation_=i}}class vv extends qi{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,r=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",a=e.zoomOutLabel!==void 0?e.zoomOutLabel:"–",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",c=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=r,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof o=="string"?document.createTextNode(o):o),h.addEventListener(re.CLICK,this.handleClick_.bind(this,i),!1);const u=document.createElement("button");u.className=s,u.setAttribute("type","button"),u.title=c,u.appendChild(typeof a=="string"?document.createTextNode(a):a),u.addEventListener(re.CLICK,this.handleClick_.bind(this,-i),!1);const d=t+" "+Cs+" "+Tc,f=this.element;f.className=d,f.appendChild(h),f.appendChild(u),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:vi})):i.setZoom(s)}}}function cg(n){n=n||{};const e=new fn;return(n.zoom!==void 0?n.zoom:!0)&&e.push(new vv(n.zoomOptions)),(n.rotate!==void 0?n.rotate:!0)&&e.push(new xv(n.rotateOptions)),(n.attribution!==void 0?n.attribution:!0)&&e.push(new yv(n.attributionOptions)),e}const hg={ACTIVE:"active"};class js extends St{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(hg.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(hg.ACTIVE,e)}setMap(e){this.map_=e}}function Ev(n,e,t){const i=n.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:sg,center:n.getConstrainedCenter(r)})}}function Hc(n,e,t,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+e),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:vi})}class Tv extends js{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==Fe.DBLCLICK){const i=e.originalEvent,r=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,a=r.getView();Hc(a,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}function Kc(n){const e=arguments;return function(t){let i=!0;for(let r=0,s=e.length;r<s&&(i=i&&e[r](t),!!i);++r);return i}}const wv=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Sv=function(n){const e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},bv=function(n){const e=n.map.getTargetElement(),t=e.getRootNode(),i=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(i):e.contains(i)},ug=function(n){const e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?bv(n):!0},Cv=us,dg=function(n){const e=n.originalEvent;return"pointerId"in e&&e.button==0&&!(n0&&ef&&e.ctrlKey)},fg=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Rv=function(n){const e=n.originalEvent;return ef?e.metaKey:e.ctrlKey},Pv=function(n){const e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},gg=function(n){const e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},Zc=function(n){const e=n.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},Iv=function(n){const e=n.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class Vs extends js{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Fe.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Fe.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Fe.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==Fe.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function qc(n){const e=n.length;let t=0,i=0;for(let r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return{clientX:t/e,clientY:i/e}}class Av extends Vs{constructor(e){super({stopDown:Ao}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:Kc(fg,Iv);this.condition_=e.onFocusOnly?Kc(ug,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,r=t.getEventPixel(qc(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],a=e.map.getView();xd(s,a.getResolution()),Nl(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=t.getPixelFromCoordinateInternal(o),l=t.getCoordinateFromPixelInternal([a[0]-r*Math.cos(s),a[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(l),duration:500,easing:vi})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class Lv extends Vs{constructor(e){e=e||{},super({stopDown:Ao}),this.condition_=e.condition?e.condition:Sv,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!Zc(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===zc)return;const r=t.getSize(),s=e.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(e){return Zc(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return Zc(e)&&dg(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class Mv extends hs{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(e[0],t[0])+i,r.top=Math.min(e[1],t[1])+i,r.width=Math.abs(t[0]-e[0])+i,r.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,t=this.endPixel_,r=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new gi([r])}getGeometry(){return this.geometry_}}const kr={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Xs extends Ln{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class Ov extends Vs{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new Mv(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??dg,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const r=i[0]-t[0],s=i[1]-t[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Xs(kr.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new Xs(t?kr.BOXEND:kr.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Xs(kr.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Xs(kr.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Xs(kr.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class Dv extends Ov{constructor(e){e=e||{};const t=e.condition?e.condition:Pv;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),a=i.getResolution()/o;r=r.clone(),r.scale(a*a)}i.fitInternal(r,{duration:this.duration_,easing:vi})}}const Ji={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class Fv extends js{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return fg(t)&&gg(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==re.KEYDOWN){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==Ji.DOWN||r==Ji.LEFT||r==Ji.RIGHT||r==Ji.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let l=0,c=0;r==Ji.DOWN?c=-a:r==Ji.LEFT?l=-a:r==Ji.RIGHT?l=a:c=a;const h=[l,c];Nl(h,o.getRotation()),Ev(o,h,this.duration_),i.preventDefault(),t=!0}}return!t}}class kv extends js{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!Rv(t)&&gg(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==re.KEYDOWN||e.type==re.KEYPRESS){const i=e.originalEvent,r=i.key;if(this.condition_(e)&&(r==="+"||r==="-")){const s=e.map,o=r==="+"?this.delta_:-this.delta_,a=s.getView();Hc(a,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}const Nv=40,Gv=300;class Uv extends js{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:Cv;this.condition_=e.onFocusOnly?Kc(ug,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==re.WHEEL)return!0;const i=e.map,r=e.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=Nv;break;case WheelEvent.DOM_DELTA_PAGE:s*=Gv;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=i.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),l),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-Me(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),Hc(t,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class Bv extends Vs{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Ao),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=l}this.lastAngle_=s;const o=e.map,a=o.getView();a.getConstraints().rotation!==zc&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(qc(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class zv extends Vs{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Ao),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/a),this.lastDistance_=a;const l=e.map,c=l.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(qc(this.targetPointers))),l.render(),c.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function mg(n){n=n||{};const e=new fn,t=new fv(-.005,.05,100);return(n.altShiftDragRotate!==void 0?n.altShiftDragRotate:!0)&&e.push(new Lv),(n.doubleClickZoom!==void 0?n.doubleClickZoom:!0)&&e.push(new Tv({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan!==void 0?n.dragPan:!0)&&e.push(new Av({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate!==void 0?n.pinchRotate:!0)&&e.push(new Bv),(n.pinchZoom!==void 0?n.pinchZoom:!0)&&e.push(new zv({duration:n.zoomDuration})),(n.keyboard!==void 0?n.keyboard:!0)&&(e.push(new Fv),e.push(new kv({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom!==void 0?n.mouseWheelZoom:!0)&&e.push(new Uv({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom!==void 0?n.shiftDragZoom:!0)&&e.push(new Dv({duration:n.zoomDuration})),e}class Ti extends Ln{constructor(e,t){super(e),this.layer=t}}const Jc={LAYERS:"layers"};class Wt extends Dr{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Jc.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new fn(i.slice(),{unique:!0}):fe(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new fn(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(be),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(he(e,wt.ADD,this.handleLayersAdd_,this),he(e,wt.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(be);dr(this.listenerKeys_);const t=e.getArray();for(let i=0,r=t.length;i<r;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new Ti("addlayer",s))}this.changed()}registerLayerListeners_(e){const t=[he(e,ur.PROPERTYCHANGE,this.handleLayerChange_,this),he(e,re.CHANGE,this.handleLayerChange_,this)];e instanceof Wt&&t.push(he(e,"addlayer",this.handleLayerGroupAdd_,this),he(e,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[J(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new Ti("addlayer",e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Ti("removelayer",e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new Ti("addlayer",t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=J(t);this.listenerKeys_[i].forEach(be),delete this.listenerKeys_[i],this.dispatchEvent(new Ti("removelayer",t)),this.changed()}getLayers(){return this.get(Jc.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new Ti("removelayer",i[r]))}this.set(Jc.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const r=this.getLayerState();let s=r.zIndex;!e&&r.zIndex===void 0&&(s=0);for(let o=i,a=t.length;o<a;o++){const l=t[o];l.opacity*=r.opacity,l.visible=l.visible&&r.visible,l.maxResolution=Math.min(l.maxResolution,r.maxResolution),l.minResolution=Math.max(l.minResolution,r.minResolution),l.minZoom=Math.max(l.minZoom,r.minZoom),l.maxZoom=Math.min(l.maxZoom,r.maxZoom),r.extent!==void 0&&(l.extent!==void 0?l.extent=Oi(l.extent,r.extent):l.extent=r.extent),l.zIndex===void 0&&(l.zIndex=s)}return t}getSourceState(){return"ready"}}class Wv extends hs{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){Q()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;qt(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),xs(r,i)}forEachFeatureAtCoordinate(e,t,i,r,s,o,a,l){let c;const h=t.viewState;function u(x,v,S,w){return s.call(o,v,x?S:null,w)}const d=h.projection,f=vd(e.slice(),d),g=[[0,0]];if(d.canWrapX()&&r){const x=d.getExtent(),v=xe(x);g.push([-v,0],[v,0])}const _=t.layerStatesArray,m=_.length,y=[],p=[];for(let x=0;x<g.length;x++)for(let v=m-1;v>=0;--v){const S=_[v],w=S.layer;if(w.hasRenderer()&&jc(S,h)&&a.call(l,w)){const b=w.getRenderer(),P=w.getSource();if(b&&P){const D=P.getWrapX()?f:e,G=u.bind(null,S.managed);p[0]=D[0]+g[x][0],p[1]=D[1]+g[x][1],c=b.forEachFeatureAtCoordinate(p,t,i,G,y)}if(c)return c}}if(y.length===0)return;const E=1/y.length;return y.forEach((x,v)=>x.distanceSq+=v*E),y.sort((x,v)=>x.distanceSq-v.distanceSq),y.some(x=>c=x.callback(x.feature,x.layer,x.geometry)),c}hasFeatureAtCoordinate(e,t,i,r,s,o){return this.forEachFeatureAtCoordinate(e,t,i,r,us,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){Q()}scheduleExpireIconCache(e){Bt.canExpireCache()&&e.postRenderFunctions.push(Yv)}}function Yv(n,e){Bt.expire()}class $v extends Wv{constructor(e){super(e),this.fontChangeListenerKey_=he(Cr,ur.PROPERTYCHANGE,e.redrawText,e),this.element_=document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=Cs+" ol-layers";const i=e.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const r=new Gs(e,void 0,t);i.dispatchEvent(r)}}disposeInternal(){be(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Je.PRECOMPOSE,e);const t=e.layerStatesArray.sort((a,l)=>a.zIndex-l.zIndex);t.some(a=>a.layer instanceof wa&&a.layer.getDeclutter())&&(e.declutter={});const r=e.viewState;this.children_.length=0;const s=[];let o=null;for(let a=0,l=t.length;a<l;++a){const c=t[a];e.layerIndex=a;const h=c.layer,u=h.getSourceState();if(!jc(c,r)||u!="ready"&&u!="undefined"){h.unrender();continue}const d=h.render(e,o);d&&(d!==o&&(this.children_.push(d),o=d),s.push(c))}this.declutter(e,s),o0(this.element_,this.children_),this.dispatchRenderEvent(Je.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let i=t.length-1;i>=0;--i){const r=t[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(e,r)}t.forEach(i=>i.layer.renderDeferred(e))}}}function _g(n){if(n instanceof Zi){n.setMapInternal(null);return}n instanceof Wt&&n.getLayers().forEach(_g)}function pg(n,e){if(n instanceof Zi){n.setMapInternal(e);return}if(n instanceof Wt){const t=n.getLayers().getArray();for(let i=0,r=t.length;i<r;++i)pg(t[i],e)}}let Qi=class extends St{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=jv(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:i0,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Ve(),this.pixelToCoordinateTransform_=Ve(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=t.controls||cg(),this.interactions=t.interactions||mg({onFocusOnly:!0}),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new _v(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(at.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(at.VIEW,this.handleViewChanged_),this.addChangeListener(at.SIZE,this.handleSizeChanged_),this.addChangeListener(at.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof yn)&&e.view.then(function(r){i.setView(new yn(r))}),this.controls.addEventListener(wt.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(wt.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(wt.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(wt.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(wt.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(wt.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){pg(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:us,a=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,a,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(r){i.push(r)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(r){r instanceof Wt?t(r.getLayers()):e.push(r)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const r=t.layerFilter!==void 0?t.layerFilter:us,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-i.left)/s,(a.clientY-i.top)/o]}getTarget(){return this.get(at.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return Hl(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?Ne(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(at.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof fn){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const r=e[t];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=Dn(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?Ne(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(at.SIZE)}getView(){return this.get(at.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,r){return pv(this.frameState_,e,t,i,r)}handleBrowserEvent(e,t){t=t||e.type;const i=new Ei(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===Xc.POINTERDOWN||i===re.WHEEL||i===re.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=t.target,a=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let r=this.maxTilesLoading_,s=r;if(e){const o=e.viewHints;if(o[Qe.ANIMATING]||o[Qe.INTERACTING]){const a=Date.now()-e.time>8;r=a?0:8,s=a?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Je.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Je.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Fr(Wn.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Fr(Wn.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let r=0,s=i.length;r<s;++r)i[r](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)be(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(re.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(re.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new $v(this)),this.mapBrowserEventHandler_=new gv(this,this.moveTolerance_);for(const s in Fe)this.mapBrowserEventHandler_.addEventListener(Fe[s],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(re.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(re.WHEEL,this.boundHandleBrowserEvent_,nf?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const s=t.getRootNode();i=s instanceof ShadowRoot?s.host:t}this.targetChangeHandlerKeys_=[he(i,re.KEYDOWN,this.handleBrowserEvent,this),he(i,re.KEYPRESS,this.handleBrowserEvent,this)];const r=t.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_.observe(t)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(be(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(be(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=he(e,ur.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=he(e,re.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(be),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Ti("addlayer",e)),this.layerGroupPropertyListenerKeys_=[he(e,ur.PROPERTYCHANGE,this.render,this),he(e,re.CHANGE,this.render,this),he(e,"addlayer",this.handleLayerAdd_,this),he(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let t=0,i=e.length;t<i;++t){const r=e[t].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){_g(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(t!==void 0&&Mf(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:Fl(a.center,a.resolution,a.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:J(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=Fl(a.nextCenter,a.nextResolution,l,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!ms(this.previousExtent_)&&!_r(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Fr(Wn.MOVESTART,this,r)),this.previousExtent_=mr(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Qe.ANIMATING]&&!s.viewHints[Qe.INTERACTING]&&!_r(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Fr(Wn.MOVEEND,this,s)),od(s.extent,this.previousExtent_))),this.dispatchEvent(new Fr(Wn.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Wn.LOADSTART)||this.hasListener(Wn.LOADEND)||this.hasListener(Je.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new Ti("removelayer",t)),this.set(at.LAYERGROUP,e)}setSize(e){this.set(at.SIZE,e)}setTarget(e){this.set(at.TARGET,e)}setView(e){if(!e||e instanceof yn){this.set(at.VIEW,e);return}this.set(at.VIEW,new yn);const t=this;e.then(function(i){t.setView(new yn(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){const r=getComputedStyle(e),s=e.offsetWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)-parseFloat(r.borderRightWidth),o=e.offsetHeight-parseFloat(r.borderTopWidth)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)-parseFloat(r.borderBottomWidth);!isNaN(s)&&!isNaN(o)&&(t=[Math.max(0,s),Math.max(0,o)],!Mf(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&_d("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!An(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function jv(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Wt({layers:n.layers});t[at.LAYERGROUP]=i,t[at.TARGET]=n.target,t[at.VIEW]=n.view instanceof yn?n.view:new yn;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new fn(n.controls.slice()):(fe(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new fn(n.interactions.slice()):(fe(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new fn(n.overlays.slice()):(fe(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new fn,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}const lt={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class Vv extends St{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=e.insertFirst!==void 0?e.insertFirst:!0,this.stopEvent=e.stopEvent!==void 0?e.stopEvent:!0,this.element=document.createElement("div"),this.element.className=e.className!==void 0?e.className:"ol-overlay-container "+v0,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=e.autoPan===!0?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(lt.ELEMENT,this.handleElementChanged),this.addChangeListener(lt.MAP,this.handleMapChanged),this.addChangeListener(lt.OFFSET,this.handleOffsetChanged),this.addChangeListener(lt.POSITION,this.handlePositionChanged),this.addChangeListener(lt.POSITIONING,this.handlePositioningChanged),e.element!==void 0&&this.setElement(e.element),this.setOffset(e.offset!==void 0?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),e.position!==void 0&&this.setPosition(e.position)}getElement(){return this.get(lt.ELEMENT)}getId(){return this.id}getMap(){return this.get(lt.MAP)||null}getOffset(){return this.get(lt.OFFSET)}getPosition(){return this.get(lt.POSITION)}getPositioning(){return this.get(lt.POSITIONING)}handleElementChanged(){sf(this.element);const e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){var t;this.mapPostrenderListenerKey&&((t=this.element)==null||t.remove(),be(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const e=this.getMap();if(e){this.mapPostrenderListenerKey=he(e,Wn.POSTRENDER,this.render,this),this.updatePixelPosition();const i=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?i.insertBefore(this.element,i.childNodes[0]||null):i.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(lt.ELEMENT,e)}setMap(e){this.set(lt.MAP,e)}setOffset(e){this.set(lt.OFFSET,e)}setPosition(e){this.set(lt.POSITION,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){const t=this.getMap();if(!t||!t.getTargetElement()||!this.get(lt.POSITION))return;const i=this.getRect(t.getTargetElement(),t.getSize()),r=this.getElement(),s=this.getRect(r,[r0(r),s0(r)]);e=e||{};const o=e.margin===void 0?20:e.margin;if(!gr(i,s)){const a=s[0]-i[0],l=i[2]-s[2],c=s[1]-i[1],h=i[3]-s[3],u=[0,0];if(a<0?u[0]=a-o:l<0&&(u[0]=Math.abs(l)+o),c<0?u[1]=c-o:h<0&&(u[1]=Math.abs(h)+o),u[0]!==0||u[1]!==0){const d=t.getView().getCenterInternal(),f=t.getPixelFromCoordinateInternal(d);if(!f)return;const g=[f[0]+u[0],f[1]+u[1]],_=e.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(g),duration:_.duration,easing:_.easing})}}}getRect(e,t){const i=e.getBoundingClientRect(),r=i.left+window.pageXOffset,s=i.top+window.pageYOffset;return[r,s,r+t[0],s+t[1]]}setPositioning(e){this.set(lt.POSITIONING,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){const e=this.getMap(),t=this.getPosition();if(!e||!e.isRendered()||!t){this.setVisible(!1);return}const i=e.getPixelFromCoordinate(t),r=e.getSize();this.updateRenderedPosition(i,r)}updateRenderedPosition(e,t){const i=this.element.style,r=this.getOffset(),s=this.getPositioning();this.setVisible(!0);const o=`${e[0]+r[0]}px`,a=`${e[1]+r[1]}px`;let l="0%",c="0%";s=="bottom-right"||s=="center-right"||s=="top-right"?l="-100%":(s=="bottom-center"||s=="center-center"||s=="top-center")&&(l="-50%"),s=="bottom-left"||s=="bottom-center"||s=="bottom-right"?c="-100%":(s=="center-left"||s=="center-center"||s=="center-right")&&(c="-50%");const h=`translate(${l}, ${c}) translate(${o}, ${a})`;this.rendered.transform_!=h&&(this.rendered.transform_=h,i.transform=h)}getOptions(){return this.options}}class Qc{constructor(e,t,i,r){this.minX=e,this.maxX=t,this.minY=i,this.maxY=r}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Nr(n,e,t,i,r){return r!==void 0?(r.minX=n,r.maxX=e,r.minY=t,r.maxY=i,r):new Qc(n,e,t,i)}const eh="units",Xv=[1,2,5],Hs=25.4/.28;class Hv extends qi{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const i=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+Cs,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(eh,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(eh)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(eh,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,i=e.projection,r=this.getUnits(),s=r=="degrees"?"degrees":"m";let o=Vo(i,e.resolution,t,s);const a=this.minWidth_*(this.dpi_||Hs)/Hs,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||Hs)/Hs:void 0;let c=a*o,h="";if(r=="degrees"){const E=pr.degrees;c*=E,c<E/60?(h="″",o*=3600):c<E?(h="′",o*=60):h="°"}else if(r=="imperial")c<.9144?(h="in",o/=.0254):c<1609.344?(h="ft",o/=.3048):(h="mi",o/=1609.344);else if(r=="nautical")o/=1852,h="NM";else if(r=="metric")c<1e-6?(h="nm",o*=1e9):c<.001?(h="μm",o*=1e6):c<1?(h="mm",o*=1e3):c<1e3?h="m":(h="km",o/=1e3);else if(r=="us")c<.9144?(h="in",o*=39.37):c<1609.344?(h="ft",o/=.30480061):(h="mi",o/=1609.3472);else throw new Error("Invalid units");let u=3*Math.floor(Math.log(a*o)/Math.log(10)),d,f,g,_=0,m,y;for(;;){g=Math.floor(u/3);const E=Math.pow(10,g);if(d=Xv[(u%3+3)%3]*E,f=Math.round(d/o),isNaN(f)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&f>=l){d=_,f=m,g=y;break}else if(f>=a)break;_=d,m=f,y=g,++u}const p=this.scaleBar_?this.createScaleBar(f,d,h):d.toFixed(g<0?-g:0)+" "+h;this.renderedHTML_!=p&&(this.innerElement_.innerHTML=p,this.renderedHTML_=p),this.renderedWidth_!=f&&(this.innerElement_.style.width=f+"px",this.renderedWidth_=f),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,i){const r=this.getScaleForResolution(),s=r<1?Math.round(1/r).toLocaleString()+" : 1":"1 : "+Math.round(r).toLocaleString(),o=this.scaleBarSteps_,a=e/o,l=[this.createMarker("absolute")];for(let h=0;h<o;++h){const u=h%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${u}" style="width: ${a}px;"></div>`+this.createMarker("relative")+(h%2===0||o===2?this.createStepText(h,e,!1,t,i):"")+"</div>")}return l.push(this.createStepText(o,e,!0,t,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+l.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,i,r,s){const a=(e===0?0:Math.round(r/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),l=e===0?-3:t/this.scaleBarSteps_*-1,c=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${e===0?"left":"center"};min-width: ${c}px;left: ${i?t+"px":"unset"};">`+a+"</div>"}getScaleForResolution(){const e=Vo(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||Hs,i=1e3/25.4;return e*i*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}var Kv=function(n){if(!n)return null;var e=n.getViewport().getElementsByClassName("ol-fixedoverlay")[0];return e||(n.getViewport().querySelector(".ol-layers")?(e=document.createElement("canvas"),e.className="ol-fixedoverlay",n.getViewport().querySelector(".ol-layers").after(e),n.on("precompose",function(t){e.width=n.getSize()[0]*t.frameState.pixelRatio,e.height=n.getSize()[1]*t.frameState.pixelRatio})):e=n.getViewport().querySelector("canvas")),e},th=class extends qi{constructor(e){e=e||{},super(e),this.setStyle(e.style)}setMap(e){this.getCanvas(e);var t=this.getMap();if(this._listener&&(ci(this._listener),this._listener=null),super.setMap(e),t)try{t.renderSync()}catch{}e&&(this._listener=e.on("postcompose",this._draw.bind(this)))}getCanvas(e){return Kv(e)}getContext(e){var t=e.context;if(!t&&this.getMap()){var i=this.getMap().getViewport().getElementsByClassName("ol-fixedoverlay")[0];t=i?i.getContext("2d"):null}return t}setStyle(e){this._style=e||new _t({})}getStyle(){return this._style}getStroke(){var e=this._style.getStroke();return e||this._style.setStroke(new kt({color:"#000",width:1.25})),this._style.getStroke()}getFill(){var e=this._style.getFill();return e||this._style.setFill(new Gn({color:"#fff"})),this._style.getFill()}getTextStroke(){var e=this._style.getText();return e||(e=new Vi({})),e.getStroke()||e.setStroke(new kt({color:"#fff",width:3})),e.getStroke()}getTextFill(){var e=this._style.getText();return e||(e=new Vi({})),e.getFill()||e.setFill(new Gn({color:"#fff"})),e.getFill()}getTextFont(){var e=this._style.getText();return e||(e=new Vi({})),e.getFont()||e.setFont("12px sans-serif"),e.getFont()}_draw(){console.warn("[CanvasBase] draw function not implemented.")}},Zv=class extends St{constructor(e){e=e||{},super();var t=this.input=e.input;t||(t=this.input=document.createElement("input"),e.type&&t.setAttribute("type",e.type),e.min!==void 0&&t.setAttribute("min",e.min),e.max!==void 0&&t.setAttribute("max",e.max),e.step!==void 0&&t.setAttribute("step",e.step),e.parent&&e.parent.appendChild(t)),e.disabled&&(t.disabled=!0),e.checked!==void 0&&(t.checked=!!e.checked),e.val!==void 0&&(t.value=e.val),e.hidden&&t.classList.add("ol-input-hidden"),t.addEventListener("focus",(function(){this.element&&this.element.classList.add("ol-focus")}).bind(this));var i;t.addEventListener("focusout",(function(){this.element&&(i&&clearTimeout(i),i=setTimeout((function(){this.element.classList.remove("ol-focus")}).bind(this),0))}).bind(this))}_listenDrag(e,t){var i=(function(r){this.moving=!0,this.element.classList.add("ol-moving");var s=(function(o){o.type==="pointerup"&&(document.removeEventListener("pointermove",s),document.removeEventListener("pointerup",s),document.removeEventListener("pointercancel",s),setTimeout((function(){this.moving=!1,this.element.classList.remove("ol-moving")}).bind(this))),o.target===e&&t(o),o.stopPropagation(),o.preventDefault()}).bind(this);document.addEventListener("pointermove",s,!1),document.addEventListener("pointerup",s,!1),document.addEventListener("pointercancel",s,!1),r.stopPropagation(),r.preventDefault()}).bind(this);e.addEventListener("mousedown",i,!1),e.addEventListener("touchstart",i,!1)}setValue(e){e!==void 0&&(this.input.value=e),this.input.dispatchEvent(new Event("change"))}getValue(){return this.input.value}getInputElement(){return this.input}},nh=class extends Zv{constructor(e){e=e||{},super(e);var t=this.element=document.createElement("label");e.html instanceof Element?t.appendChild(e.html):e.html!==void 0&&(t.innerHTML=e.html),t.className=("ol-ext-check ol-ext-checkbox "+(e.className||"")).trim(),this.input.parentNode&&this.input.parentNode.insertBefore(t,this.input),t.appendChild(this.input),t.appendChild(document.createElement("span")),e.after&&t.appendChild(document.createTextNode(e.after)),this.input.addEventListener("change",(function(){this.dispatchEvent({type:"check",checked:this.input.checked,value:this.input.value})}).bind(this))}isChecked(){return this.input.checked}},qv=class extends nh{constructor(e){e=e||{},super(e),this.element.className=("ol-ext-toggle-switch "+(e.className||"")).trim()}},Jv=class extends nh{constructor(e){e=e||{},super(e),this.element.className=("ol-ext-check ol-ext-radio "+(e.className||"")).trim()}},te={};te.create=function(n,e){e=e||{};var t;if(n==="TEXT")t=document.createTextNode(e.html||""),e.parent&&e.parent.appendChild(t);else{t=document.createElement(n.toLowerCase()),/button/i.test(n)&&t.setAttribute("type","button");for(var i in e)switch(i){case"className":{e.className&&e.className.trim&&t.setAttribute("class",e.className.trim());break}case"text":{t.innerText=e.text;break}case"html":{e.html instanceof Element?t.appendChild(e.html):e.html!==void 0&&(t.innerHTML=e.html);break}case"parent":{e.parent&&e.parent.appendChild(t);break}case"options":{if(/select/i.test(n))for(var r in e.options)te.create("OPTION",{html:r,value:e.options[r],parent:t});break}case"style":{te.setStyle(t,e.style);break}case"change":case"click":{te.addListener(t,i,e[i]);break}case"on":{for(var s in e.on)te.addListener(t,s,e.on[s]);break}case"checked":{t.checked=!!e.checked;break}default:{t.setAttribute(i,e[i]);break}}}return t},te.createSwitch=function(n){var e=te.create("INPUT",{type:"checkbox",on:n.on,click:n.click,change:n.change,parent:n.parent}),t=Object.assign({input:e},n||{});return new qv(t),e},te.createCheck=function(n){var e=te.create("INPUT",{name:n.name,type:n.type==="radio"?"radio":"checkbox",on:n.on,parent:n.parent}),t=Object.assign({input:e},n||{});return n.type==="radio"?new Jv(t):new nh(t),e},te.setHTML=function(n,e){e instanceof Element?n.appendChild(e):e!==void 0&&(n.innerHTML=e)},te.appendText=function(n,e){n.appendChild(document.createTextNode(e||""))},te.addListener=function(n,e,t,i){typeof e=="string"&&(e=e.split(" ")),e.forEach(function(r){n.addEventListener(r,t,i)})},te.removeListener=function(n,e,t){typeof e=="string"&&(e=e.split(" ")),e.forEach(function(i){n.removeEventListener(i,t)})},te.show=function(n){n.style.display=""},te.hide=function(n){n.style.display="none"},te.hidden=function(n){return te.getStyle(n,"display")==="none"},te.toggle=function(n){n.style.display=n.style.display==="none"?"":"none"},te.setStyle=function(n,e){for(var t in e)switch(t){case"top":case"left":case"bottom":case"right":case"minWidth":case"maxWidth":case"width":case"height":{typeof e[t]=="number"?n.style[t]=e[t]+"px":n.style[t]=e[t];break}default:n.style[t]=e[t]}},te.getStyle=function(n,e){var t,i=(n.ownerDocument||document).defaultView;if(i&&i.getComputedStyle)e=e.replace(/([A-Z])/g,"-$1").toLowerCase(),t=i.getComputedStyle(n,null).getPropertyValue(e);else if(n.currentStyle&&(e=e.replace(/-(\w)/g,function(r,s){return s.toUpperCase()}),t=n.currentStyle[e],/^\d+(em|pt|%|ex)?$/i.test(t)))return function(r){var s=n.style.left,o=n.runtimeStyle.left;return n.runtimeStyle.left=n.currentStyle.left,n.style.left=r||0,r=n.style.pixelLeft+"px",n.style.left=s,n.runtimeStyle.left=o,r}(t);return/px$/.test(t)?parseInt(t):t},te.outerHeight=function(n){return n.offsetHeight+te.getStyle(n,"marginBottom")},te.outerWidth=function(n){return n.offsetWidth+te.getStyle(n,"marginLeft")},te.offsetRect=function(n){var e=n.getBoundingClientRect();return{top:e.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:e.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0),height:e.height||e.bottom-e.top,width:e.width||e.right-e.left}},te.getFixedOffset=function(n){var e={left:0,top:0},t=function(i){if(!i)return e;if(te.getStyle(i,"position")==="absolute"&&te.getStyle(i,"transform")!=="none"){var r=i.getBoundingClientRect();return e.left+=r.left,e.top+=r.top,e}return t(i.offsetParent)};return t(n.offsetParent)},te.positionRect=function(n,e){var t=0,i=0,r=function(s){if(s)return t+=s.offsetLeft,i+=s.offsetTop,r(s.offsetParent);var o={top:n.offsetTop+i,left:n.offsetLeft+t};return e&&(o.top-=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,o.left-=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0),o.bottom=o.top+n.offsetHeight,o.right=o.top+n.offsetWidth,o};return r(n.offsetParent)},te.scrollDiv=function(n,e){e=e||{};var t=!1,i=0,r,s=0,o=typeof e.onmove=="function"?e.onmove:function(){},a=e.vertical?"screenY":"screenX",l=e.vertical?"scrollTop":"scrollLeft",c=!1,h,u,d=0,f=function(){E&&(d++,setTimeout(g))},g=function(){if(E){if(d--,d)return;var w=n.clientHeight,b=n.scrollHeight;h=w/b,E.style.height=h*100+"%",E.style.top=n.scrollTop/b*100+"%",p.style.height=w+"px",w>b-.5?p.classList.add("ol-100pc"):p.classList.remove("ol-100pc")}},_=function(w){w.target.classList.contains("ol-noscroll")||(c=!1,t=w[a],s=new Date,n.classList.add("ol-move"),w.preventDefault(),window.addEventListener("pointermove",m),te.addListener(window,["pointerup","pointercancel"],v))},m=function(w){if(t!==!1){var b=(u?-1/h:1)*(t-w[a]);c=c||Math.round(b),n[l]+=b,r=new Date,r-s&&(i=(i+b/(r-s))/2),t=w[a],s=r,b&&o(!0)}else c=!0},y=function(w){var b=w>0?Math.min(100,w/2):Math.max(-100,w/2);w-=b,n[l]+=b,-1<w&&w<1?(c?setTimeout(function(){n.classList.remove("ol-move")}):n.classList.remove("ol-move"),c=!1,o(!1)):setTimeout(function(){y(w)},40)},p,E;if(e.vertical&&e.minibar){var x=function(w){n.removeEventListener("pointermove",x),n.parentNode.classList.add("ol-miniscroll"),E=te.create("DIV"),p=te.create("DIV",{className:"ol-scroll",html:E}),n.parentNode.insertBefore(p,n),E.addEventListener("pointerdown",function(b){u=!0,_(b)}),e.mousewheel&&(te.addListener(p,["mousewheel","DOMMouseScroll","onmousewheel"],function(b){S(b)}),te.addListener(E,["mousewheel","DOMMouseScroll","onmousewheel"],function(b){S(b)})),n.parentNode.addEventListener("pointerenter",f),window.addEventListener("resize",f),w!==!1&&f()};n.parentNode?x(!1):n.addEventListener("pointermove",x),n.addEventListener("scroll",function(){f()})}n.style["touch-action"]="none",n.style.overflow="hidden",n.classList.add("ol-scrolldiv"),te.addListener(n,["pointerdown"],function(w){u=!1,_(w)}),n.addEventListener("click",function(w){n.classList.contains("ol-move")&&(w.preventDefault(),w.stopPropagation())},!0);var v=function(w){s=new Date-s,s>100||u?i=0:s>0&&(i=((i||0)+(t-w[a])/s)/2),y(e.animate===!1?0:i*200),t=!1,i=0,s=0,n.classList.contains("ol-move")?n.classList.remove("ol-hasClick"):(n.classList.add("ol-hasClick"),setTimeout(function(){n.classList.remove("ol-hasClick")},500)),u=!1,window.removeEventListener("pointermove",m),te.removeListener(window,["pointerup","pointercancel"],v)},S=function(w){var b=Math.max(-1,Math.min(1,w.wheelDelta||-w.detail));return n.classList.add("ol-move"),n[l]-=b*30,n.classList.remove("ol-move"),!1};return e.mousewheel&&te.addListener(n,["mousewheel","DOMMouseScroll","onmousewheel"],S),{refresh:f}},te.dispatchEvent=function(n,e){var t;try{t=new CustomEvent(n)}catch{t=document.createEvent("CustomEvent"),t.initCustomEvent(n,!0,!0,{})}e.dispatchEvent(t)},te.setCursor=function(n,e){n instanceof Qi&&(n=n.getTargetElement()),!("ontouchstart"in window)&&n instanceof Element&&(n.style.cursor=e)};var Qv=class extends Hv{constructor(e){e=e||{},e.bar=!1,super(e),this.element.classList.add("ol-canvas-control"),this.scaleHeight_=6,e||(e={}),e.style||(e.style=new _t),this.setStyle(e.style)}setMap(e){th.prototype.getCanvas.call(this,e);var t=this.getMap();if(this._listener&&ci(this._listener),this._listener=null,super.setMap(e),t)try{t.renderSync()}catch{}e&&(this._listener=e.on("postcompose",this.drawScale_.bind(this))),this.element.style.visibility="hidden",this.olscale=this.element.querySelector(".ol-scale-line-inner")}setStyle(e){var t=e.getStroke();this.strokeStyle_=t?Fn(t.getColor()):"#000",this.strokeWidth_=t?t.getWidth():2;var i=e.getFill();this.fillStyle_=i?Fn(i.getColor()):"#fff";var r=e.getText();this.font_=r?r.getFont():"10px Arial",t=r?r.getStroke():null,i=r?r.getFill():null,this.fontStrokeStyle_=t?Fn(t.getColor()):this.fillStyle_,this.fontStrokeWidth_=t?t.getWidth():3,this.fontFillStyle_=i?Fn(i.getColor()):this.strokeStyle_,this.getMap()&&this.getMap().render()}drawScale_(e){if(!(this.element.style.visibility!=="hidden"||te.getStyle(this.element,"display")==="none")){var t=this.getContext(e);if(t){var i=parseInt(this.olscale.style.width);if(i){var r=this.olscale.textContent,s={left:this.element.offsetLeft,top:this.element.offsetTop},o=e.frameState.pixelRatio;t.save(),t.scale(o,o),s.top+=this.element.clientHeight-this.scaleHeight_,t.beginPath(),t.strokeStyle=this.fontStrokeStyle_,t.fillStyle=this.fontFillStyle_,t.lineWidth=this.fontStrokeWidth_,t.textAlign="center",t.textBaseline="bottom",t.font=this.font_,t.lineJoin="round",t.strokeText(r,s.left+i/2,s.top),t.fillText(r,s.left+i/2,s.top),t.closePath(),s.top+=2,t.lineWidth=this.strokeWidth_,t.strokeStyle=this.strokeStyle_;for(var a=4,l=parseInt(r);l%10===0;)l/=10;l%5===0&&(a=5);for(var c=0;c<a;c++)t.beginPath(),t.fillStyle=c%2?this.fillStyle_:this.strokeStyle_,t.rect(s.left+c*i/a,s.top,i/a,this.scaleHeight_),t.stroke(),t.fill(),t.closePath();t.restore()}}}}getContext(e){return th.prototype.getContext.call(this,e)}},eE=class extends th{constructor(e){e=e||{};var t=document.createElement("div");t.className="ol-control ol-compassctrl ol-unselectable ol-hidden"+(e.className?" "+e.className:""),t.style.position="absolute",t.style.visibility="hidden";var i=e.style instanceof kt?new _t({stroke:e.style}):e.style;e.style||(i=new _t({stroke:new kt({width:0})})),super({element:t,style:i}),this.set("rotateVithView",e.rotateWithView!==!1),this.setVisible(e.visible!==!1),this.setImage(e.image||e.src)}setImage(e){if(e instanceof Image)this.img_=e,this.img_.onload=(function(){if(this.getMap())try{this.getMap().renderSync()}catch{}}).bind(this);else if(typeof e=="string")switch(e){case"compact":{this.img_=this.compactCompass_(this.element.clientWidth,this.getStroke().getColor());break}case"default":{this.img_=this.defaultCompass_(this.element.clientWidth,this.getStroke().getColor());break}default:{this.img_=new Image,this.img_.onload=(function(){if(this.getMap())try{this.getMap().renderSync()}catch{}}).bind(this),this.img_.src=e;break}}else this.img_=this.defaultCompass_(this.element.clientWidth,this.getStroke().getColor())}compactCompass_(e,t){var i=document.createElement("canvas"),r=i.getContext("2d");e=i.width=i.height=e||150;var s=e/2;return r.translate(s,s),r.fillStyle=t||"#963",r.lineWidth=5,r.lineJoin=r.lineCap="round",r.font="bold "+s*.4+"px sans-serif",r.textBaseline="bottom",r.textAlign="center",r.strokeStyle="#fff",r.globalAlpha=.75,r.strokeText("N",0,-s/2),r.globalAlpha=1,r.fillText("N",0,-s/2),r.beginPath(),r.moveTo(0,s/4),r.lineTo(s/3,s/2),r.lineTo(0,-s/2),r.lineTo(-s/3,s/2),r.lineTo(0,s/4),r.lineWidth=12,r.fillStyle="#fff",r.globalAlpha=.75,r.fill(),r.stroke(),r.globalAlpha=1,r.fillStyle=r.strokeStyle=t||"#963",r.lineWidth=5,r.beginPath(),r.moveTo(0,s/4),r.lineTo(0,-s/2),r.lineTo(s/3,s/2),r.lineTo(0,s/4),r.fill(),r.stroke(),r.beginPath(),r.moveTo(0,s/4),r.lineTo(0,-s/2),r.lineTo(-s/3,s/2),r.lineTo(0,s/4),r.stroke(),i}defaultCompass_(e,t){var i=document.createElement("canvas"),r=i.getContext("2d");e=i.width=i.height=e||150;var s=e/2,o=.22*s;function a(c,h){r.fillStyle=t||"#963",r.beginPath(),r.moveTo(0,0),r.lineTo(c,0),r.lineTo(h,h),r.moveTo(0,0),r.lineTo(-c,0),r.lineTo(-h,-h),r.moveTo(0,0),r.lineTo(0,c),r.lineTo(-h,h),r.moveTo(0,0),r.lineTo(0,-c),r.lineTo(h,-h),r.moveTo(0,0),r.fill(),r.stroke()}function l(c,h){r.globalCompositeOperation="destination-out",r.fillStyle="#fff",r.beginPath(),r.moveTo(0,0),r.lineTo(c,0),r.lineTo(h,-h),r.moveTo(0,0),r.lineTo(-c,0),r.lineTo(-h,h),r.moveTo(0,0),r.lineTo(0,c),r.lineTo(h,h),r.moveTo(0,0),r.lineTo(0,-c),r.lineTo(-h,-h),r.moveTo(0,0),r.fill(),r.globalCompositeOperation="source-over",r.beginPath(),r.moveTo(0,0),r.lineTo(c,0),r.lineTo(h,-h),r.moveTo(0,0),r.lineTo(-c,0),r.lineTo(-h,h),r.moveTo(0,0),r.lineTo(0,c),r.lineTo(h,h),r.moveTo(0,0),r.lineTo(0,-c),r.lineTo(-h,-h),r.moveTo(0,0),r.stroke()}return r.translate(s,s),r.strokeStyle=t||"#963",r.lineWidth=1.5,r.beginPath(),r.arc(0,0,e*.41,0,2*Math.PI),r.arc(0,0,e*.44,0,2*Math.PI),r.stroke(),r.rotate(Math.PI/4),a(s*.9,o*.8),l(s*.9,o*.8),r.rotate(-Math.PI/4),a(s,o),l(s,o),i}getVisible(){return te.getStyle(this.element,"display")==="block"}setVisible(e){e?this.element.classList.add("ol-visible"):this.element.classList.remove("ol-visible"),this.getMap()&&this.getMap().render()}_draw(e){var t=this.getContext(e);if(!(!t||!this.getVisible())){var i=t.canvas,r,s=[];for(r=0;r<8;r++)s[r]=[Math.cos(Math.PI*r/8),Math.sin(Math.PI*r/8)];var o=e.frameState.pixelRatio;t.save(),t.scale(o,o);var a=this.element.clientWidth,l=this.element.clientHeight,c={left:this.element.offsetLeft,top:this.element.offsetTop},h=this.img_,u=e.frameState.viewState.rotation;if(t.beginPath(),t.translate(c.left+a/2,c.top+l/2),this.get("rotateVithView")&&t.rotate(u),this.getStroke().getWidth()){t.beginPath(),t.strokeStyle=this.getStroke().getColor(),t.lineWidth=this.getStroke().getWidth();var d=Math.max(i.width,i.height);for(r=0;r<8;r++)t.moveTo(-s[r][0]*d,-s[r][1]*d),t.lineTo(s[r][0]*d,s[r][1]*d);t.stroke()}h.width&&t.drawImage(h,-a/2,-l/2,a,l),t.closePath(),t.restore()}}},tE=class extends qi{constructor(e){e=e||{};var t=te.create("DIV",{className:((e.className||"")+" ol-progress-bar ol-unselectable ol-control").trim()});super({element:t,target:e.target}),this._waiting=te.create("DIV",{html:e.label||"",className:"ol-waiting",parent:t}),this._bar=te.create("DIV",{className:"ol-bar",parent:t}),this._layerlistener=[],this.setLayers(e.layers)}setPercent(e){this._bar.style.width=(Number(e)||0)*100+"%",e===void 0?te.hide(this.element):te.show(this.element)}setLabel(e){this._waiting.innerHTML=e}setLayers(e){this._layerlistener.forEach(function(s){ci(s)}),this._layerlistener=[],this.setPercent();var t=0,i=0;if(e instanceof Zi&&(e=[e]),!(!e||!e.forEach)){var r;e.forEach((function(s){s instanceof Zi&&(this._layerlistener.push(s.getSource().on("tileloadstart",(function(){t++,this.setPercent(i/t),clearTimeout(r)}).bind(this))),this._layerlistener.push(s.getSource().on(["tileloadend","tileloaderror"],(function(){i++,i===t?(t=i=0,this.setPercent(1),r=setTimeout(this.setPercent.bind(this),300)):this.setPercent(i/t)}).bind(this))))}).bind(this))}}},nE=function(n,e){var t=n.getView(),i=t.getProjection(),r=t.getCenter(),s=n.getPixelFromCoordinate(r);s[1]+=1;var o=n.getCoordinateFromPixel(s),a=Uo(Zt(r,i,"EPSG:4326"),Zt(o,i,"EPSG:4326"));return a*=(e||96)/.0254,a},iE=function(n,e,t){if(n&&e){var i=e;if(typeof e=="string"&&(e=e.replace(":","/").split("/"),i=e[1],i||(i=e[0]||""),i=i.replace(/[^\d]/g,""),i=parseInt(i),e[1])){var r=parseInt(e[0]);r&&(i/=r)}if(!i)return;var s=n.getView(),o=s.getProjection(),a=s.getCenter(),l=n.getPixelFromCoordinate(a);l[1]+=1;var c=n.getCoordinateFromPixel(l),h=Uo(Zt(a,o,"EPSG:4326"),Zt(c,o,"EPSG:4326"));return h*=(t||96)/.0254,s.setResolution(s.getResolution()*i/h),i}},rE=class extends qi{constructor(e){e=e||{},e.typing===void 0&&(e.typing=300);var t=document.createElement("DIV"),i=(e.className||"")+" ol-scale";e.target||(i+=" ol-unselectable ol-control"),super({element:t,target:e.target}),this._input=document.createElement("INPUT"),this._input.value="-",t.setAttribute("class",i),e.editable===!1&&(this._input.readOnly=!0),t.appendChild(this._input),this._input.addEventListener("change",this.setScale.bind(this)),this.set("ppi",e.ppi||96)}setMap(e){this._listener&&ci(this._listener),this._listener=null,super.setMap(e),e&&(this._listener=e.on("moveend",this.getScale.bind(this)))}getScale(){var e=this.getMap();if(e){var t=nE(e,this.get("ppi"));return this._input.value=this.formatScale(t),t}}formatScale(e){return e>100?e=Math.round(e/100)*100:e=Math.round(e),"1 / "+e.toLocaleString()}setScale(e){var t=this.getMap();t&&e&&(e.target&&(e=e.target.value),iE(t,e,this.get("ppi"))),this.getScale()}};function ih(n){const e=n.frameState,t=Kl(n.inversePixelTransform.slice(),e.coordinateToPixelTransform);return new pf(n.context,e.pixelRatio,e.extent,t,e.viewState.rotation)}var Ks=jp.split(".");Ks=parseInt(Ks[0])*100+parseInt(Ks[1]);var rh=function(n,e){var t=n.frameState.pixelRatio;if(Ks>605&&Ks<700&&t!==1&&e.getImage()instanceof Ns){e=e.clone();var i=e.getImage();i.setScale(i.getScale()*t);var r=i.getAnchor();if(r&&i.setDisplacement){var s=i.getDisplacement();s&&(s[0]-=r[0]/t,s[1]+=r[1]/t,i.setAnchor([0,0]))}else r&&(r[0]/=t,r[1]/=t)}return e},sh=class extends St{constructor(e){e=e||{},super(),this.duration_=typeof e.duration=="number"?e.duration>=0?e.duration:0:1e3,this.fade_=typeof e.fade=="function"?e.fade:null,this.repeat_=Number(e.repeat);var t=typeof e.easing=="function"?e.easing:sg;e.revers?this.easing_=function(i){return 1-t(i)}:this.easing_=t,this.hiddenStyle=e.hiddenStyle}drawGeom_(e,t,i){var r={type:"drawing",time:e.time,feature:e.feature,start:e.start,stop:e.stop,rotation:e.rotation,style:e.style,extra:e.extra};this.dispatchEvent(r);var s=r.style instanceof Array?r.style:[r.style];this.fade_&&(e.context.globalAlpha=this.fade_(1-e.elapsed));for(var o=0;o<s.length;o++)try{var a=e.vectorContext||ih(e),l=rh(e,s[o]);a.setStyle(l),l.getZIndex()<0?a.drawGeometry(i||t):a.drawGeometry(t)}catch{}}animate(){return!1}};sh.hiddenStyle=new _t({image:new ji({}),stroke:new kt({color:"transparent"})}),Qi.prototype.animateFeature=function(n,e){var t=this._featureAnimationLayer;t||(t=this._featureAnimationLayer=new $s({source:new Fs}),t.setMap(this)),t.getSource().addFeature(n);var i=e.on("animationend",function(r){r.feature===n&&(t.getSource().removeFeature(n),ci(i))});return t.animateFeature(n,e)},Dr.prototype.animateFeature=function(n,e,t){var i=this,r,s=n.getStyle(),o=s||(this.getStyleFunction?this.getStyleFunction()(n):null);o||(o=[]),o instanceof Array||(o=[o]);var a={vectorContext:null,frameState:null,start:0,time:0,elapsed:0,extent:!1,feature:n,geom:n.getGeometry(),typeGeom:n.getGeometry().getType(),bbox:n.getGeometry().getExtent(),coord:Kt(n.getGeometry().getExtent()),style:o};e instanceof Array||(e=[e]);for(var l=e.length-1;l>=0;l--)e[l].duration_===0&&e.splice(l,1);var c=0,h=0,u=t&&this.getFilters?this.getFilters():[];function d(_){a.type=_.type;try{a.vectorContext=_.vectorContext||ih(_)}catch{}if(a.frameState=_.frameState,a.inversePixelTransform=_.inversePixelTransform,a.extent||(a.extent=_.frameState.extent,a.start=_.frameState.time,a.context=_.context),a.time=_.frameState.time-a.start,a.elapsed=a.time/e[h].duration_,a.elapsed>1&&(a.elapsed=1),_.context.save(),u.forEach(function(y){y.get("active")&&y.precompose(_)}),this.getOpacity&&(_.context.globalAlpha=this.getOpacity()),!e[h].animate(a))c++,c<e[h].repeat_?(a.extent=!1,e[h].dispatchEvent({type:"animationrepeat",feature:n})):h<e.length-1?(e[h].dispatchEvent({type:"animationend",feature:n}),h++,c=0,a.extent=!1):f();else{var m={type:"animating",step:h,start:a.start,time:a.time,elapsed:a.elapsed,rotation:a.rotation||0,geom:a.geom,coordinate:a.coord,feature:n,extra:a.extra||{},style:o};e[h].dispatchEvent(m),i.dispatchEvent(m)}u.forEach(function(y){y.get("active")&&y.postcompose(_)}),_.context.restore(),_.frameState.animate=!0}function f(_){ci(r),r=null,n.setStyle(s),a.stop=new Date().getTime();var m={type:"animationend",feature:n};if(_)for(var y in _)_.hasOwnProperty(y)&&(m[y]=_[y]);e[h].dispatchEvent(m),i.dispatchEvent(m)}function g(_){if(e.length&&!r){if(a.stop&&(a.start=new Date().getTime()-a.stop+a.start,a.stop=0),r=i.on(["postcompose","postrender"],d.bind(i)),i.renderSync)try{i.renderSync()}catch{}else i.changed();n.setStyle(e[h].hiddenStyle||sh.hiddenStyle);var m={type:"animationstart",feature:n};if(_)for(var y in _)_.hasOwnProperty(y)&&(m[y]=_[y]);e[h].dispatchEvent(m),i.dispatchEvent(m)}}return g(),{start:g,stop:f,isPlaying:function(){return!!r}}};var sE=class extends sh{constructor(e){e=e||{},super(e),this.set("zoomout",e.zoomOut)}animate(e){var t=this.easing_(e.elapsed);if(t){this.get("zoomout")&&(t=1/t);var i=e.style,r,s,o=[];for(r=0;r<i.length;r++)s=i[r].getImage(),s&&(o[r]=s.getScale(),e.type==="postrender"?s.setScale(o[r]*t/e.frameState.pixelRatio):s.setScale(o[r]*t));for(this.drawGeom_(e,e.geom),r=0;r<i.length;r++)s=i[r].getImage(),s&&s.setScale(o[r])}return e.time<=this.duration_}},oE=class extends $s{constructor(e){var t=e||{};super(t),this.oldcluster=new Fs,this.clusters=[],this.animation={start:!1},this.set("animationDuration",typeof t.animationDuration=="number"?t.animationDuration:700),this.set("animationMethod",t.animationMethod||vi),this.on(["precompose","prerender"],this.animate.bind(this)),this.on(["postcompose","postrender"],this.postanimate.bind(this))}setSource(e){this._saveClusterFn||(this._saveClusterFn=this.saveCluster.bind(this)),this.getSource()&&this.getSource().un("change",this._saveClusterFn),$s.prototype.setSource.call(this,e),this.getSource()&&this.getSource().on("change",this._saveClusterFn)}saveCluster(){if(this.oldcluster){if(this.oldcluster.clear(),!this.get("animationDuration"))return;var e=this.getSource().getFeatures();e.length&&e[0].get("features")&&(this.oldcluster.addFeatures(this.clusters),this.clusters=e.slice(0),this.sourceChanged=!0)}}getClusterForFeature(e,t){for(var i=0,r;r=t[i];i++){var s=r.get("features");if(s&&s.length){for(var o=0,a;a=s[o];o++)if(e===a)return r}}return!1}stopAnimation(){this.animation.start=!1,this.animation.cA=[],this.animation.cB=[]}animate(e){var t=this.get("animationDuration");if(t){var i=e.frameState.viewState.resolution,r,s,o=this.animation,a=e.frameState.time;if(o.resolution!=i&&this.sourceChanged){var l=e.frameState.extent;for(o.resolution<i?(l=Mn(l,100*i),o.cA=this.oldcluster.getFeaturesInExtent(l),o.cB=this.getSource().getFeaturesInExtent(l),o.revers=!1):(l=Mn(l,100*i),o.cA=this.getSource().getFeaturesInExtent(l),o.cB=this.oldcluster.getFeaturesInExtent(l),o.revers=!0),o.clusters=[],r=0,s;s=o.cA[r];r++){var c=s.get("features");if(c&&c.length){var h=this.getClusterForFeature(c[0],o.cB);h&&o.clusters.push({f:s,pt:h.getGeometry().getCoordinates()})}}if(o.resolution=i,this.sourceChanged=!1,!o.clusters.length||o.clusters.length>1e3){this.stopAnimation();return}a=o.start=new Date().getTime()}if(o.start){var u=e.vectorContext||ih(e),d=(a-o.start)/t;d>1&&(this.stopAnimation(),d=1),d=this.get("animationMethod")(d);var f=this.getStyle(),g=typeof f=="function"?f:f.length?function(){return f}:function(){return[f]};for(e.context.save(),e.context.globalAlpha=this.getOpacity(),r=0,h;h=o.clusters[r];r++){var _=h.f.getGeometry().getCoordinates(),m=_[0]-h.pt[0],y=_[1]-h.pt[1];o.revers?(_[0]=h.pt[0]+d*m,_[1]=h.pt[1]+d*y):(_[0]=_[0]-d*m,_[1]=_[1]-d*y);var p=g(h.f,i,!0);if(Array.isArray(p)||(p=[p]),h.f.get("features").length===1&&!m&&!y)c=h.f.get("features")[0];else{var E=new Jt(_);c=new hi(E)}for(var x=0,v;v=p[x];x++)if(v.getText()&&/\n/.test(v.getText().getText())){var S=v.getText().getOffsetX(),w=v.getText().getOffsetY(),b=v.getText().getRotation()||0,P=Number((v.getText().getFont()||"10px").match(/\d+/))*1.2,D=v.getText().getText().split(`
`),G,N=D.length-1,F=v.clone();D.forEach(function(B,H){switch(H==1&&(F.setImage(),F.setFill(),F.setStroke()),v.getText().getTextBaseline()){case"alphabetic":case"ideographic":case"bottom":{G=N;break}case"hanging":case"top":{G=0;break}default:{G=N/2;break}}F.getText().setOffsetX(S-Math.sin(b)*P*(H-G)),F.getText().setOffsetY(w+Math.cos(b)*P*(H-G)),F.getText().setText(B),u.drawFeature(c,rh(e,F))})}else u.drawFeature(c,rh(e,v))}e.context.restore(),e.frameState.animate=!0,e.context.save(),e.context.beginPath(),e.context.rect(0,0,0,0),e.context.clip(),this.clip_=!0}}}postanimate(e){this.clip_&&(e.context.restore(),this.clip_=!1)}};class aE{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof hs&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return fe(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return fe(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){var t;return(t=this.entries_[e])==null?void 0:t.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){fe(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function Zs(n,e,t,i){return i!==void 0?(i[0]=n,i[1]=e,i[2]=t,i):[n,e,t]}function lE(n,e,t){return n+"/"+e+"/"+t}function yg(n){return cE(n[0],n[1],n[2])}function cE(n,e,t){return(e<<n)+t}function hE(n,e){const t=n[0],i=n[1],r=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,r):!0}const Gr=[0,0,0],wi=5;class xg{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,fe(Wp(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,fe(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Di(i)),fe(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,fe(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:Wc,fe(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((r,s)=>{const o=new Qc(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const r=this.getTileRangeForExtentAndZ(e,t);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let a=r.minY,l=r.maxY;a<=l;++a)i([t,s,a])}forEachTileCoordParentTileRange(e,t,i,r){let s,o,a,l=null,c=e[0]-1;for(this.zoomFactor_===2?(o=e[1],a=e[2]):l=this.getTileCoordExtent(e,r);c>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=Nr(o,o,a,a,i)):s=this.getTileRangeForExtentAndZ(l,c,i),t(c,s))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Nr(s,s+1,o,o+1,t)}const r=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const r=e[0],s=e[1],o=e[2];if(t===r)return Nr(s,o,s,o,i);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,t-r),c=Math.floor(s*l),h=Math.floor(o*l);if(t<r)return Nr(c,c,h,h,i);const u=Math.floor(l*(s+1))-1,d=Math.floor(l*(o+1))-1;return Nr(c,u,h,d,i)}const a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,Gr);const r=Gr[1],s=Gr[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,Gr);const o=Gr[1],a=Gr[2];return Nr(r,o,s,a,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),r=mt(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*r[0]*i,t[1]-(e[2]+.5)*r[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),r=this.getResolution(e[0]),s=mt(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*r,a=i[1]-(e[2]+1)*s[1]*r,l=o+s[0]*r,c=a+s[1]*r;return On(o,a,l,c,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,r,s){const o=this.getZForResolution(i),a=i/this.getResolution(o),l=this.getOrigin(o),c=mt(this.getTileSize(o),this.tmpSize_);let h=a*(e-l[0])/i/c[0],u=a*(l[1]-t)/i/c[1];return r?(h=Go(h,wi)-1,u=Go(u,wi)-1):(h=No(h,wi),u=No(u,wi)),Zs(o,h,u,s)}getTileCoordForXYAndZ_(e,t,i,r,s){const o=this.getOrigin(i),a=this.getResolution(i),l=mt(this.getTileSize(i),this.tmpSize_);let c=(e-o[0])/a/l[0],h=(o[1]-t)/a/l[1];return r?(c=Go(c,wi)-1,h=Go(h,wi)-1):(c=No(c,wi),h=No(h,wi)),Zs(i,c,h,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=Il(this.resolutions_,e,t||0);return Me(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return Kd(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let r=this.minZoom;r<t;++r)i[r]=this.getTileRangeForExtentAndZ(e,r);this.fullTileRanges_=i}}function vg(n){let e=n.getDefaultTileGrid();return e||(e=fE(n),n.setDefaultTileGrid(e)),e}function uE(n,e,t){const i=e[0],r=n.getTileCoordCenter(e),s=Ca(t);if(!fr(s,r)){const o=xe(s),a=Math.ceil((s[0]-r[0])/o);return r[0]+=o*a,n.getTileCoordForCoordAndZ(r,i)}return e}function dE(n,e,t,i){i=i!==void 0?i:"top-left";const r=Tg(n,e,t);return new xg({extent:n,origin:Kp(n,i),resolutions:r,tileSize:t})}function Eg(n){const e=n||{},t=e.extent||Pe("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Tg(t,e.maxZoom,e.tileSize,e.maxResolution)};return new xg(i)}function Tg(n,e,t,i){e=e!==void 0?e:ov,t=mt(t!==void 0?t:Wc);const r=st(n),s=xe(n);i=i>0?i:Math.max(s/t[0],r/t[1]);const o=e+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=i/Math.pow(2,l);return a}function fE(n,e,t,i){const r=Ca(n);return dE(r,e,t,i)}function Ca(n){n=Pe(n);let e=n.getExtent();if(!e){const t=180*pr.degrees/n.getMetersPerUnit();e=On(-t,-t,t,t)}return e}function wg(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}const gE=/\{z\}/g,mE=/\{x\}/g,_E=/\{y\}/g,pE=/\{-y\}/g;function yE(n,e,t,i,r){return n.replace(gE,e.toString()).replace(mE,t.toString()).replace(_E,i.toString()).replace(pE,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function xE(n){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(n);if(t){const i=t[1].charCodeAt(0),r=t[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(n.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){const i=parseInt(t[2],10);for(let r=parseInt(t[1],10);r<=i;r++)e.push(n.replace(t[0],r.toString()));return e}return e.push(n),e}function vE(n,e){return function(t,i,r){if(!t)return;let s;const o=t[0];if(e){const a=e.getFullTileRange(o);a&&(s=a.getHeight()-1)}return yE(n,o,t[1],t[2],s)}}function EE(n,e){const t=n.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=vE(n[r],e);return Sg(i)}function Sg(n){return n.length===1?n[0]:function(e,t,i){if(!e)return;const r=yg(e),s=ki(r,n.length);return n[s](e,t,i)}}let oh;const Ur=[];function bg(n,e,t,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,i)+1,Math.max(t,r)),n.restore()}function ah(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function TE(){if(oh===void 0){const n=ze(6,6,Ur);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",bg(n,4,5,4,0),bg(n,4,5,0,5);const e=n.getImageData(0,0,3,3).data;oh=ah(e,0)||ah(e,4)||ah(e,8),ta(n),Ur.push(n.canvas)}return oh}function lh(n,e,t,i){const r=Zt(t,e,n);let s=Vo(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const a=n.getMetersPerUnit();a!==void 0&&(s/=a);const l=n.getExtent();if(!l||fr(l,r)){const c=Vo(n,s,r)/s;isFinite(c)&&c>0&&(s/=c)}return s}function wE(n,e,t,i){const r=Kt(t);let s=lh(n,e,r,i);return(!isFinite(s)||s<=0)&&cd(t,function(o){return s=lh(n,e,o,i),isFinite(s)&&s>0}),s}function SE(n,e,t,i,r,s,o,a,l,c,h,u,d,f){const g=ze(Math.round(t*n),Math.round(t*e),Ur);if(u||(g.imageSmoothingEnabled=!1),l.length===0)return g.canvas;g.scale(t,t);function _(v){return Math.round(v*t)/t}g.globalCompositeOperation="lighter";const m=ft();l.forEach(function(v,S,w){ad(m,v.extent)});let y;const p=t/i,E=(u?1:1+Math.pow(2,-24))/p;y=ze(Math.round(xe(m)*p),Math.round(st(m)*p),Ur),u||(y.imageSmoothingEnabled=!1),l.forEach(function(v,S,w){if(v.image.width>0&&v.image.height>0){if(v.clipExtent){y.save();const N=(v.clipExtent[0]-m[0])*p,F=-(v.clipExtent[3]-m[3])*p,B=xe(v.clipExtent)*p,H=st(v.clipExtent)*p;y.rect(u?N:Math.round(N),u?F:Math.round(F),u?B:Math.round(N+B)-Math.round(N),u?H:Math.round(F+H)-Math.round(F)),y.clip()}const b=(v.extent[0]-m[0])*p,P=-(v.extent[3]-m[3])*p,D=xe(v.extent)*p,G=st(v.extent)*p;y.drawImage(v.image,c,c,v.image.width-2*c,v.image.height-2*c,u?b:Math.round(b),u?P:Math.round(P),u?D:Math.round(b+D)-Math.round(b),u?G:Math.round(P+G)-Math.round(P)),v.clipExtent&&y.restore()}});const x=Di(o);return a.getTriangles().forEach(function(v,S,w){const b=v.source,P=v.target;let D=b[0][0],G=b[0][1],N=b[1][0],F=b[1][1],B=b[2][0],H=b[2][1];const A=_((P[0][0]-x[0])/s),k=_(-(P[0][1]-x[1])/s),z=_((P[1][0]-x[0])/s),V=_(-(P[1][1]-x[1])/s),K=_((P[2][0]-x[0])/s),oe=_(-(P[2][1]-x[1])/s),L=D,ke=G;D=0,G=0,N-=L,F-=ke,B-=L,H-=ke;const We=[[N,F,0,0,z-A],[B,H,0,0,K-A],[0,0,N,F,V-k],[0,0,B,H,oe-k]],Re=Qp(We);if(!Re)return;if(g.save(),g.beginPath(),TE()||!u){g.moveTo(z,V);const Ye=4,yt=A-z,xt=k-V;for(let tt=0;tt<Ye;tt++)g.lineTo(z+_((tt+1)*yt/Ye),V+_(tt*xt/(Ye-1))),tt!=Ye-1&&g.lineTo(z+_((tt+1)*yt/Ye),V+_((tt+1)*xt/(Ye-1)));g.lineTo(K,oe)}else g.moveTo(z,V),g.lineTo(A,k),g.lineTo(K,oe);g.clip(),g.transform(Re[0],Re[2],Re[1],Re[3],A,k),g.translate(m[0]-L,m[3]-ke);let nt;if(y)nt=y.canvas,g.scale(E,-E);else{const Ye=l[0],yt=Ye.extent;nt=Ye.image,g.scale(xe(yt)/nt.width,-st(yt)/nt.height)}g.drawImage(nt,0,0),g.restore()}),y&&(ta(y),Ur.push(y.canvas)),h&&(g.save(),g.globalCompositeOperation="source-over",g.strokeStyle="black",g.lineWidth=1,a.getTriangles().forEach(function(v,S,w){const b=v.target,P=(b[0][0]-x[0])/s,D=-(b[0][1]-x[1])/s,G=(b[1][0]-x[0])/s,N=-(b[1][1]-x[1])/s,F=(b[2][0]-x[0])/s,B=-(b[2][1]-x[1])/s;g.beginPath(),g.moveTo(G,N),g.lineTo(P,D),g.lineTo(F,B),g.closePath(),g.stroke()}),g.restore()),g.canvas}const bE=10,Cg=.25;class CE{constructor(e,t,i,r,s,o,a){this.sourceProj_=e,this.targetProj_=t;let l={};const c=a?Py(E=>Ne(a,Zt(E,this.targetProj_,this.sourceProj_))):Tr(this.targetProj_,this.sourceProj_);this.transformInv_=function(E){const x=E[0]+"/"+E[1];return l[x]||(l[x]=c(E)),l[x]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&xe(r)>=xe(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?xe(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?xe(this.targetProj_.getExtent()):null;const h=Di(i),u=ko(i),d=Fo(i),f=Do(i),g=this.transformInv_(h),_=this.transformInv_(u),m=this.transformInv_(d),y=this.transformInv_(f),p=bE+(o?Math.max(0,Math.ceil(Math.log2(Dl(i)/(o*o*256*256)))):0);if(this.addQuad_(h,u,d,f,g,_,m,y,p),this.wrapsXInSource_){let E=1/0;this.triangles_.forEach(function(x,v,S){E=Math.min(E,x.source[0][0],x.source[1][0],x.source[2][0])}),this.triangles_.forEach(x=>{if(Math.max(x.source[0][0],x.source[1][0],x.source[2][0])-E>this.sourceWorldWidth_/2){const v=[[x.source[0][0],x.source[0][1]],[x.source[1][0],x.source[1][1]],[x.source[2][0],x.source[2][1]]];v[0][0]-E>this.sourceWorldWidth_/2&&(v[0][0]-=this.sourceWorldWidth_),v[1][0]-E>this.sourceWorldWidth_/2&&(v[1][0]-=this.sourceWorldWidth_),v[2][0]-E>this.sourceWorldWidth_/2&&(v[2][0]-=this.sourceWorldWidth_);const S=Math.min(v[0][0],v[1][0],v[2][0]);Math.max(v[0][0],v[1][0],v[2][0])-S<this.sourceWorldWidth_/2&&(x.source=v)}})}l={}}addTriangle_(e,t,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[e,t,i]})}addQuad_(e,t,i,r,s,o,a,l,c){const h=sd([s,o,a,l]),u=this.sourceWorldWidth_?xe(h)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&u>.5&&u<1;let g=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const m=sd([e,t,i,r]);g=xe(m)/this.targetWorldWidth_>Cg||g}!f&&this.sourceProj_.isGlobal()&&u&&(g=u>Cg||g)}if(!g&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!gt(h,this.maxSourceExtent_))return;let _=0;if(!g&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)g=!0;else if(_=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),_!=1&&_!=2&&_!=4&&_!=8)return}if(c>0){if(!g){const m=[(e[0]+i[0])/2,(e[1]+i[1])/2],y=this.transformInv_(m);let p;f?p=(ki(s[0],d)+ki(a[0],d))/2-ki(y[0],d):p=(s[0]+a[0])/2-y[0];const E=(s[1]+a[1])/2-y[1];g=p*p+E*E>this.errorThresholdSquared_}if(g){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const m=[(t[0]+i[0])/2,(t[1]+i[1])/2],y=this.transformInv_(m),p=[(r[0]+e[0])/2,(r[1]+e[1])/2],E=this.transformInv_(p);this.addQuad_(e,t,m,p,s,o,y,E,c-1),this.addQuad_(p,m,i,r,E,y,a,l,c-1)}else{const m=[(e[0]+t[0])/2,(e[1]+t[1])/2],y=this.transformInv_(m),p=[(i[0]+r[0])/2,(i[1]+r[1])/2],E=this.transformInv_(p);this.addQuad_(e,m,p,r,s,y,E,l,c-1),this.addQuad_(m,t,i,p,y,o,a,E,c-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}_&11||this.addTriangle_(e,i,r,s,a,l),_&14||this.addTriangle_(e,i,t,s,a,o),_&&(_&13||this.addTriangle_(t,r,e,o,l,s),_&7||this.addTriangle_(t,r,i,o,l,a))}calculateSourceExtent(){const e=ft();return this.triangles_.forEach(function(t,i,r){const s=t.source;gs(e,s[0]),gs(e,s[1]),gs(e,s[2])}),e}getTriangles(){return this.triangles_}}const RE=.5;class Rg extends Sa{constructor(e,t,i,r,s,o,a,l,c,h,u,d){super(s,q.IDLE,d),this.renderEdges_=u!==void 0?u:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const f=r.getTileCoordExtent(this.wrappedTileCoord_),g=this.targetTileGrid_.getExtent();let _=this.sourceTileGrid_.getExtent();const m=g?Oi(f,g):f;if(Dl(m)===0){this.state=q.EMPTY;return}const y=e.getExtent();y&&(_?_=Oi(_,y):_=y);const p=r.getResolution(this.wrappedTileCoord_[0]),E=wE(e,i,m,p);if(!isFinite(E)||E<=0){this.state=q.EMPTY;return}const x=h!==void 0?h:RE;if(this.triangulation_=new CE(e,i,m,_,E*x,p),this.triangulation_.getTriangles().length===0){this.state=q.EMPTY;return}this.sourceZ_=t.getZForResolution(E);let v=this.triangulation_.calculateSourceExtent();if(_&&(e.canWrapX()?(v[1]=Me(v[1],_[1],_[3]),v[3]=Me(v[3],_[1],_[3])):v=Oi(v,_)),!Dl(v))this.state=q.EMPTY;else{let S=0,w=0;e.canWrapX()&&(S=xe(y),w=Math.floor((v[0]-y[0])/S)),fd(v.slice(),e,!0).forEach(P=>{const D=t.getTileRangeForExtentAndZ(P,this.sourceZ_);for(let G=D.minX;G<=D.maxX;G++)for(let N=D.minY;N<=D.maxY;N++){const F=c(this.sourceZ_,G,N,a);if(F){const B=w*S;this.sourceTiles_.push({tile:F,offset:B})}}++w}),this.sourceTiles_.length===0&&(this.state=q.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{var r;const i=t.tile;if(i&&i.getState()==q.LOADED){const s=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);s[0]+=t.offset,s[2]+=t.offset;const o=(r=this.clipExtent_)==null?void 0:r.slice();o&&(o[0]+=t.offset,o[2]+=t.offset),e.push({extent:s,clipExtent:o,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=q.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=SE(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=q.LOADED}this.changed()}load(){if(this.state==q.IDLE){this.state=q.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{const i=t.getState();if(i==q.IDLE||i==q.LOADING){e++;const r=he(t,re.CHANGE,s=>{const o=t.getState();(o==q.LOADED||o==q.ERROR||o==q.EMPTY)&&(be(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},i,r){t.getState()==q.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(be),this.sourcesListenerKeys_=null}release(){this.canvas_&&(ta(this.canvas_.getContext("2d")),Ur.push(this.canvas_),this.canvas_=null),super.release()}}class PE extends Af{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&mt(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||J(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,r,s){return Q()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:vg(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=mt(r.getTileSize(e),this.tmpSize);return s==1?o:K0(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){const i=t!==void 0?t:this.getProjection(),r=t!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=uE(r,e,i)),hE(e,r)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class IE extends Ln{constructor(e,t){super(e),this.tile=t}}const ch={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class hh extends PE{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===hh.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=J(t),r=t.getState();let s;r==q.LOADING?(this.tileLoadingKeys_[i]=!0,s=ch.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==q.ERROR?ch.TILELOADERROR:r==q.LOADED?ch.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new IE(s,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=xE(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(EE(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}}class uh extends hh{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:AE,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:Vc,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Xo(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||Xo(t,e)))return this.tileGrid;const i=J(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=vg(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,s,o){const a=[e,t,i],l=this.getTileCoordForTileUrlFunction(a,s),c=l?this.tileUrlFunction(l,r,s):void 0,h=new this.tileClass(a,c!==void 0?q.IDLE:q.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=o,h.addEventListener(re.CHANGE,this.handleTileChange.bind(this)),h}getTile(e,t,i,r,s){const o=this.getProjection();if(!o||!s||Xo(o,s))return this.getTileInternal(e,t,i,r,o||s);const a=[e,t,i],l=this.getKey(),c=this.getTileGridForProjection(o),h=this.getTileGridForProjection(s),u=this.getTileCoordForTileUrlFunction(a,s),d=new Rg(o,c,s,h,a,u,this.getTilePixelRatio(r),this.getGutter(),(f,g,_,m)=>this.getTileInternal(f,g,_,m,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return d.key=l,d}getTileInternal(e,t,i,r,s){const o=this.getKey();return this.createTile_(e,t,i,r,s,o)}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){const i=Pe(e);if(i){const r=J(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}}function AE(n,e){n.getImage().src=e}function LE(n){const e=n[0],t=new Array(e);let i=1<<e-1,r,s;for(r=0;r<e;++r)s=48,n[1]&i&&(s+=1),n[2]&i&&(s+=2),t[r]=String.fromCharCode(s),i>>=1;return t.join("")}const ME='<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use</a>';class OE extends uh{constructor(e){const t=e.hidpi!==void 0?e.hidpi:!1;super({cacheSize:e.cacheSize,crossOrigin:"anonymous",interpolate:e.interpolate,projection:Pe("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:"loading",tileLoadFunction:e.tileLoadFunction,tilePixelRatio:t?2:1,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.hidpi_=t,this.culture_=e.culture!==void 0?e.culture:"en-us",this.maxZoom_=e.maxZoom!==void 0?e.maxZoom:-1,this.apiKey_=e.key,this.imagerySet_=e.imagerySet,this.placeholderTiles_=e.placeholderTiles;const i="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+this.apiKey_+"&c="+this.culture_;fetch(i).then(r=>r.json()).then(r=>this.handleImageryMetadataResponse(r))}getApiKey(){return this.apiKey_}getImagerySet(){return this.imagerySet_}handleImageryMetadataResponse(e){if(e.statusCode!=200||e.statusDescription!="OK"||e.authenticationResultCode!="ValidCredentials"||e.resourceSets.length!=1||e.resourceSets[0].resources.length!=1){this.setState("error");return}const t=e.resourceSets[0].resources[0],i=this.maxZoom_==-1?t.zoomMax:this.maxZoom_,r=this.getProjection(),s=Ca(r),o=this.hidpi_?2:1,a=t.imageWidth==t.imageHeight?t.imageWidth/o:[t.imageWidth/o,t.imageHeight/o],l=Eg({extent:s,minZoom:t.zoomMin,maxZoom:i,tileSize:a});this.tileGrid=l;const c=this.culture_,h=this.hidpi_,u=this.placeholderTiles_;if(this.tileUrlFunction=Sg(t.imageUrlSubdomains.map(function(d){const f=[0,0,0],g=t.imageUrl.replace("{subdomain}",d).replace("{culture}",c);return function(_,m,y){if(!_)return;Zs(_[0],_[1],_[2],f);const p=new URL(g.replace("{quadkey}",LE(f))),E=p.searchParams;return h&&(E.set("dpi","d1"),E.set("device","mobile")),u===!0?E.delete("n"):u===!1&&E.set("n","z"),p.toString()}})),t.imageryProviders){const d=Ho(Pe("EPSG:4326"),this.getProjection());this.setAttributions(f=>{const g=[],_=f.viewState,m=this.getTileGrid(),y=m.getZForResolution(_.resolution,this.zDirection),E=m.getTileCoordForCoordAndZ(_.center,y)[0];return t.imageryProviders.map(function(x){let v=!1;const S=x.coverageAreas;for(let w=0,b=S.length;w<b;++w){const P=S[w];if(E>=P.zoomMin&&E<=P.zoomMax){const D=P.bbox,G=[D[1],D[0],D[3],D[2]],N=ud(G,d);if(gt(N,f.extent)){v=!0;break}}}v&&g.push(x.attribution)}),g.push(ME),g})}this.setState("ready")}}class Pg extends uh{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:Eg({extent:Ca(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}class DE extends Fs{constructor(e){e=e||{},super({attributions:e.attributions,wrapX:e.wrapX}),this.resolution=void 0,this.distance=e.distance!==void 0?e.distance:20,this.minDistance=e.minDistance||0,this.interpolationRatio=0,this.features=[],this.geometryFunction=e.geometryFunction||function(t){const i=t.getGeometry();return fe(!i||i.getType()==="Point","The default `geometryFunction` can only handle `Point` or null geometries"),i},this.createCustomCluster_=e.createCluster,this.source=null,this.boundRefresh_=this.refresh.bind(this),this.updateDistance(this.distance,this.minDistance),this.setSource(e.source||null)}clear(e){this.features.length=0,super.clear(e)}getDistance(){return this.distance}getSource(){return this.source}loadFeatures(e,t,i){var r;(r=this.source)==null||r.loadFeatures(e,t,i),t!==this.resolution&&(this.resolution=t,this.refresh())}setDistance(e){this.updateDistance(e,this.minDistance)}setMinDistance(e){this.updateDistance(this.distance,e)}getMinDistance(){return this.minDistance}setSource(e){this.source&&this.source.removeEventListener(re.CHANGE,this.boundRefresh_),this.source=e,e&&e.addEventListener(re.CHANGE,this.boundRefresh_),this.refresh()}refresh(){this.clear(),this.cluster(),this.addFeatures(this.features)}updateDistance(e,t){const i=e===0?0:Math.min(t,e)/e,r=e!==this.distance||this.interpolationRatio!==i;this.distance=e,this.minDistance=t,this.interpolationRatio=i,r&&this.refresh()}cluster(){if(this.resolution===void 0||!this.source)return;const e=ft(),t=this.distance*this.resolution,i=this.source.getFeatures(),r={};for(let s=0,o=i.length;s<o;s++){const a=i[s];if(!(J(a)in r)){const l=this.geometryFunction(a);if(l){const c=l.getCoordinates();Ml(c,e),Mn(e,t,e);const h=this.source.getFeaturesInExtent(e).filter(function(u){const d=J(u);return d in r?!1:(r[d]=!0,!0)});this.features.push(this.createCluster(h,e))}}}}createCluster(e,t){const i=[0,0];for(let a=e.length-1;a>=0;--a){const l=this.geometryFunction(e[a]);l?yd(i,l.getCoordinates()):e.splice(a,1)}xd(i,1/e.length);const r=Kt(t),s=this.interpolationRatio,o=new Jt([i[0]*(1-s)+r[0]*s,i[1]*(1-s)+r[1]*s]);return this.createCustomCluster_?this.createCustomCluster_(o,e):new hi({geometry:o,features:e})}}function dh(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const FE=new Error("disposed"),kE=[256,256];class Ig extends Sa{constructor(e){const t=q.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=dh(this.data_);return e?[e.width,e.height]:kE}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==q.IDLE&&this.state!==q.ERROR)return;this.state=q.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=q.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=q.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(FE),this.controller_=null),super.disposeInternal()}}function Ag(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function fh(n,e){return n[0]=e[0],n[1]=e[1],n[4]=e[2],n[5]=e[3],n[12]=e[4],n[13]=e[5],n}const Lg=4,gh="1.3.0";function NE(n,e,t,i,r){r.WIDTH=t[0],r.HEIGHT=t[1];const s=i.getAxisOrientation(),o=pd(r.VERSION,"1.3")>=0;r[o?"CRS":"SRS"]=i.getCode();const a=o&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return r.BBOX=a.join(","),wg(n,r)}function GE(n,e,t,i,r,s,o){s=Object.assign({REQUEST:"GetMap"},s);const a=e/t,l=[md(xe(n)/a,Lg),md(st(n)/a,Lg)];if(t!=1)switch(o){case"geoserver":const h=90*t+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+h:s.FORMAT_OPTIONS="dpi:"+h;break;case"mapserver":s.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":s.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return NE(r,n,l,i,s)}function Mg(n,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:gh,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},n)}function mh(n,e,t,i,r){return`${J(n)},${e},${lE(t,i,r)}`}function _h(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;const i=n[t],r=i.has(e);return r||i.add(e),!r}function UE(n,e,t){const i=n[t];return i?i.delete(e):!1}function Og(n,e){const t=n.layerStatesArray[n.layerIndex];t.extent&&(e=Oi(e,di(t.extent,n.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(e=Oi(e,r))}return e}class BE extends $f{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=ft(),this.tempTileRange_=new Qc(0,0,0,0),this.tempTileCoord_=Zs(0,0,0);const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new aE(i),this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getOrCreateTile(e,t,i,r){const s=this.tileCache_,a=this.getLayer().getSource(),l=mh(a,a.getKey(),e,t,i);let c;if(s.containsKey(l))c=s.get(l);else{if(c=a.getTile(e,t,i,r.pixelRatio,r.viewState.projection),!c)return null;s.set(l,c)}return c}getTile(e,t,i,r){const s=this.getOrCreateTile(e,t,i,r);return s||null}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=Ne(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!fr(s,r))return null;const o=t.viewState,a=i.getRenderSource(),l=a.getTileGridForProjection(o.projection),c=a.getTilePixelRatio(t.pixelRatio);for(let h=l.getZForResolution(o.resolution);h>=l.getMinZoom();--h){const u=l.getTileCoordForCoordAndZ(r,h),d=this.getTile(h,u[1],u[2],t);if(!d||d.getState()!==q.LOADED)continue;const f=l.getOrigin(h),g=mt(l.getTileSize(h)),_=l.getResolution(h);let m;if(d instanceof Vc||d instanceof Rg)m=d.getImage();else if(d instanceof Ig){if(m=dh(d.getData()),!m)continue}else continue;const y=Math.floor(c*((r[0]-f[0])/_-u[1]*g[0])),p=Math.floor(c*((f[1]-r[1])/_-u[2]*g[1])),E=Math.round(c*a.getGutterForProjection(o.projection));return this.getImageData(m,y+E,p+E)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const t=this.getLayer().getSource();if(!t)return!1;const i=t.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===t.getKey()&&this.tileCache_.clear()):this.renderedSourceRevision_=i,!0}enqueueTiles(e,t,i,r,s){const o=e.viewState,a=this.getLayer(),l=a.getRenderSource(),c=l.getTileGridForProjection(o.projection),h=J(l);h in e.wantedTiles||(e.wantedTiles[h]={});const u=e.wantedTiles[h],d=a.getMapInternal(),f=Math.max(i-s,c.getMinZoom(),c.getZForResolution(Math.min(a.getMaxResolution(),d?d.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),g=o.rotation,_=g?hd(o.center,o.resolution,g,e.size):void 0;for(let m=i;m>=f;--m){const y=c.getTileRangeForExtentAndZ(t,m,this.tempTileRange_),p=c.getResolution(m);for(let E=y.minX;E<=y.maxX;++E)for(let x=y.minY;x<=y.maxY;++x){if(g&&!c.tileCoordIntersectsViewport([m,E,x],_))continue;const v=this.getTile(m,E,x,e);if(!v||!_h(r,v,m))continue;const w=v.getKey();if(u[w]=!0,v.getState()===q.IDLE&&!e.tileQueue.isKeyQueued(w)){const b=Zs(m,E,x,this.tempTileCoord_);e.tileQueue.enqueue([v,h,c.getTileCoordCenter(b),p])}}}}findStaleTile_(e,t){const i=this.tileCache_,r=e[0],s=e[1],o=e[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){const c=mh(this.getLayer().getSource(),a[l],r,s,o);if(i.containsKey(c)){const h=i.peek(c);if(h.getState()===q.LOADED)return h.endTransition(J(this)),_h(t,h,r),!0}}return!1}findAltTiles_(e,t,i,r){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,l=this.getLayer().getRenderSource(),c=l.getKey();for(let h=s.minX;h<=s.maxX;++h)for(let u=s.minY;u<=s.maxY;++u){const d=mh(l,c,i,h,u);let f=!1;if(a.containsKey(d)){const g=a.peek(d);g.getState()===q.LOADED&&(_h(r,g,i),f=!0)}f||(o=!1)}return o}renderFrame(e,t){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],r=e.viewState,s=r.projection,o=r.resolution,a=r.center,l=e.pixelRatio,c=this.getLayer(),h=c.getSource(),u=h.getTileGridForProjection(s),d=u.getZForResolution(o,h.zDirection),f=u.getResolution(d),g=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==g&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=g):this.renderedSourceKey_=g;let _=e.extent;const m=h.getTilePixelRatio(l);this.prepareContainer(e,t);const y=this.context.canvas.width,p=this.context.canvas.height,E=i.extent&&di(i.extent);E&&(_=Oi(_,di(i.extent)));const x=f*y/2/m,v=f*p/2/m,S=[a[0]-x,a[1]-v,a[0]+x,a[1]+v],w={};this.renderedTiles.length=0;const b=c.getPreload();if(e.nextExtent){const z=u.getZForResolution(r.nextResolution,h.zDirection),V=Og(e,e.nextExtent);this.enqueueTiles(e,V,z,w,b)}const P=Og(e,_);if(this.enqueueTiles(e,P,d,w,0),b>0&&setTimeout(()=>{this.enqueueTiles(e,P,d-1,w,b-1)},0),!(d in w))return this.container;const D=J(this),G=e.time;for(const z of w[d]){const V=z.getState();if(V===q.EMPTY)continue;const K=z.tileCoord;if(V===q.LOADED&&z.getAlpha(D,G)===1){z.endTransition(D);continue}if(V!==q.ERROR&&(this.renderComplete=!1),this.findStaleTile_(K,w)){UE(w,z,d),e.animate=!0;continue}if(this.findAltTiles_(u,K,d+1,w))continue;const ke=u.getMinZoom();for(let We=d-1;We>=ke&&!this.findAltTiles_(u,K,We,w);--We);}const N=f/o*l/m,F=this.getRenderContext(e);qt(this.tempTransform,y/2,p/2,N,N,0,-y/2,-p/2),i.extent&&this.clipUnrotated(F,e,E),h.getInterpolate()||(F.imageSmoothingEnabled=!1),this.preRender(F,e);const B=Object.keys(w).map(Number);B.sort(In);let H;const A=[],k=[];for(let z=B.length-1;z>=0;--z){const V=B[z],K=h.getTilePixelSize(V,l,s),L=u.getResolution(V)/f,ke=K[0]*L*N,We=K[1]*L*N,Re=u.getTileCoordForCoordAndZ(Di(S),V),nt=u.getTileCoordExtent(Re),Ye=Ne(this.tempTransform,[m*(nt[0]-S[0])/f,m*(S[3]-nt[3])/f]),yt=m*h.getGutterForProjection(s);for(const xt of w[V]){if(xt.getState()!==q.LOADED)continue;const tt=xt.tileCoord,es=Re[1]-tt[1],ts=Math.round(Ye[0]-(es-1)*ke),ar=Re[2]-tt[2],ti=Math.round(Ye[1]-(ar-1)*We),it=Math.round(Ye[0]-es*ke),ut=Math.round(Ye[1]-ar*We),ni=ts-it,ii=ti-ut,Cn=B.length===1;let ri=!1;H=[it,ut,it+ni,ut,it+ni,ut+ii,it,ut+ii];for(let Pi=0,Rn=A.length;Pi<Rn;++Pi)if(!Cn&&V<k[Pi]){const $e=A[Pi];gt([it,ut,it+ni,ut+ii],[$e[0],$e[3],$e[4],$e[7]])&&(ri||(F.save(),ri=!0),F.beginPath(),F.moveTo(H[0],H[1]),F.lineTo(H[2],H[3]),F.lineTo(H[4],H[5]),F.lineTo(H[6],H[7]),F.moveTo($e[6],$e[7]),F.lineTo($e[4],$e[5]),F.lineTo($e[2],$e[3]),F.lineTo($e[0],$e[1]),F.clip())}A.push(H),k.push(V),this.drawTile(xt,e,it,ut,ni,ii,yt,Cn),ri&&F.restore(),this.renderedTiles.unshift(xt),this.updateUsedTiles(e.usedTiles,h,xt)}}if(this.renderedResolution=f,this.extentChanged=!this.renderedExtent_||!_r(this.renderedExtent_,S),this.renderedExtent_=S,this.renderedPixelRatio=l,this.postRender(this.context,e),i.extent&&F.restore(),F.imageSmoothingEnabled=!0,this.renderComplete){const z=(V,K)=>{const oe=J(h),L=K.wantedTiles[oe],ke=L?Object.keys(L).length:0;this.updateCacheSize(ke),this.tileCache_.expireCache()};e.postRenderFunctions.push(z)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,i,r,s,o,a,l){let c;if(e instanceof Ig){if(c=dh(e.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(e);if(!c)return;const h=this.getRenderContext(t),u=J(this),d=t.layerStatesArray[t.layerIndex],f=d.opacity*(l?e.getAlpha(u,t.time):1),g=f!==h.globalAlpha;g&&(h.save(),h.globalAlpha=f),h.drawImage(c,a,a,c.width-2*a,c.height-2*a,i,r,s,o),g&&h.restore(),f!==d.opacity?t.animate=!0:l&&e.endTransition(u)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,i){const r=J(t);r in e||(e[r]={}),e[r][i.getKey()]=!0}}const Ra={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class zE extends Zi{constructor(e){e=e||{};const t=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Ra.PRELOAD)}setPreload(e){this.set(Ra.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Ra.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Ra.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class Pa extends zE{constructor(e){super(e)}createRenderer(){return new BE(this,{cacheSize:this.getCacheSize()})}}class Dg extends uh{constructor(e){e=e||{};const t=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=ft(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,i,r){const s=Pe(i),o=this.getProjection()||s;let a=this.getTileGrid();a||(a=this.getTileGridForProjection(o));const l=Zt(e,s,o),c=lh(o,s,e,t),h=a.getZForResolution(c,this.zDirection),u=a.getResolution(h),d=a.getTileCoordForCoordAndZ(l,h);if(a.getResolutions().length<=d[0])return;let f=a.getTileCoordExtent(d,this.tmpExtent_);const g=this.gutter_;g!==0&&(f=Mn(f,u*g,f));const _={QUERY_LAYERS:this.params_.LAYERS};Object.assign(_,Mg(this.params_,"GetFeatureInfo"),r);const m=Math.floor((l[0]-f[0])/u),y=Math.floor((f[3]-l[1])/u);return _[this.v13_?"I":"X"]=m,_[this.v13_?"J":"Y"]=y,this.getRequestUrl_(d,f,1,o||s,_)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const i={SERVICE:"WMS",VERSION:gh,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const r=this.params_.LAYERS;if(!(!Array.isArray(r)||r.length===1))return;i.LAYER=r}if(e!==void 0){const r=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;i.SCALE=e*r/s}return Object.assign(i,t),wg(this.urls[0],i)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,i,r,s){const o=this.urls;if(!o)return;let a;if(o.length==1)a=o[0];else{const l=ki(yg(e),o.length);a=o[l]}return GE(t,(this.tileGrid||this.getTileGridForProjection(r)).getResolution(e[0]),i,r,a,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const i in this.params_)t[e++]=i+"-"+this.params_[i];return t.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||gh;this.v13_=pd(e,"1.3")>=0}tileUrlFunction(e,t,i){let r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(i)),r.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const s=r.getResolution(e[0]);let o=r.getTileCoordExtent(e,this.tmpExtent_);const a=this.gutter_;a!==0&&(o=Mn(o,s*a,o));const l=Object.assign({},Mg(this.params_,"GetMap"));return this.getRequestUrl_(e,o,t,i,l)}}const ph={map:"_map_ck8zd_1",latLon:"_latLon_ck8zd_7",layersLegend:"_layersLegend_ck8zd_18"},WE={map:"_map_11did_1"},yh=34962,xh=34963,YE=35044,Fg=35048,$E=5121,jE=5123,VE=5125,kg=5126,Ng=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function XE(n,e){e=Object.assign({preserveDrawingBuffer:!0,antialias:!t0},e);const t=Ng.length;for(let i=0;i<t;++i)try{const r=n.getContext(Ng[i],e);if(r)return r}catch{}return null}const HE={STATIC_DRAW:YE};class Gg{constructor(e,t){this.array_=null,this.type_=e,fe(e===yh||e===xh,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=t!==void 0?t:HE.STATIC_DRAW}ofSize(e){return this.array_=new(Ia(this.type_))(e),this}fromArray(e){return this.array_=Ia(this.type_).from(e),this}fromArrayBuffer(e){return this.array_=new(Ia(this.type_))(e),this}getType(){return this.type_}getArray(){return this.array_}setArray(e){const t=Ia(this.type_);if(!(e instanceof t))throw new Error(`Expected ${t}`);this.array_=e}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}}function Ia(n){switch(n){case yh:return Float32Array;case xh:return Uint32Array;default:return Float32Array}}const Aa={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},KE=`
  precision mediump float;

  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;

  uniform vec2 u_screenSize;

  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,ZE=`
  precision mediump float;

  uniform sampler2D u_image;
  uniform float u_opacity;

  varying vec2 v_texCoord;

  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class Ug{constructor(e){this.gl_=e.webGlContext;const t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer(),this.depthBuffer_=t.createRenderbuffer();const i=t.createShader(t.VERTEX_SHADER);t.shaderSource(i,e.vertexShader||KE),t.compileShader(i);const r=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(r,e.fragmentShader||ZE),t.compileShader(r),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,i),t.attachShader(this.renderTargetProgram_,r),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer();const s=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array(s),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(o=>{this.uniforms_.push({value:e.uniforms[o],location:t.getUniformLocation(this.renderTargetProgram_,o)})})}getRenderTargetTexture(){return this.renderTargetTexture_}getGL(){return this.gl_}init(e){const t=this.getGL(),i=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.bindRenderbuffer(t.RENDERBUFFER,this.getDepthBuffer()),t.viewport(0,0,i[0],i[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==i[0]||this.renderTargetTextureSize_[1]!==i[1]){this.renderTargetTextureSize_=i;const r=0,s=t.RGBA,o=0,a=t.RGBA,l=t.UNSIGNED_BYTE,c=null;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,r,s,i[0],i[1],o,a,l,c),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,i[0],i[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthBuffer_)}}apply(e,t,i,r){const s=this.getGL(),o=e.size;if(s.bindFramebuffer(s.FRAMEBUFFER,t?t.getFrameBuffer():null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.renderTargetTexture_),!t){const l=J(s.canvas);if(!e.renderTargets[l]){const c=s.getContextAttributes();c&&c.preserveDrawingBuffer&&(s.clearColor(0,0,0,0),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)),e.renderTargets[l]=!0}}s.disable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),s.bindBuffer(s.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),s.useProgram(this.renderTargetProgram_),s.enableVertexAttribArray(this.renderTargetAttribLocation_),s.vertexAttribPointer(this.renderTargetAttribLocation_,2,s.FLOAT,!1,0,0),s.uniform2f(this.renderTargetUniformLocation_,o[0],o[1]),s.uniform1i(this.renderTargetTextureLocation_,0);const a=e.layerStatesArray[e.layerIndex].opacity;s.uniform1f(this.renderTargetOpacityLocation_,a),this.applyUniforms(e),i&&i(s,e),s.drawArrays(s.TRIANGLES,0,6),r&&r(s,e)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(e){const t=this.getGL();let i,r=1;this.uniforms_.forEach(function(s){if(i=typeof s.value=="function"?s.value(e):s.value,i instanceof HTMLCanvasElement||i instanceof ImageData)s.texture||(s.texture=t.createTexture()),t.activeTexture(t[`TEXTURE${r}`]),t.bindTexture(t.TEXTURE_2D,s.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),i instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,i.width,i.height,0,t.UNSIGNED_BYTE,new Uint8Array(i.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i),t.uniform1i(s.location,r++);else if(Array.isArray(i))switch(i.length){case 2:t.uniform2f(s.location,i[0],i[1]);return;case 3:t.uniform3f(s.location,i[0],i[1],i[2]);return;case 4:t.uniform4f(s.location,i[0],i[1],i[2],i[3]);return;default:return}else typeof i=="number"&&t.uniform1f(s.location,i)})}}const Yn={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},pt={UNSIGNED_BYTE:$E,UNSIGNED_SHORT:jE,UNSIGNED_INT:VE,FLOAT:kg},La={};function Bg(n){return"shared/"+n}let zg=0;function qE(){const n="unique/"+zg;return zg+=1,n}function JE(n){let e=La[n];if(!e){const t=document.createElement("canvas");t.width=1,t.height=1,t.style.position="absolute",t.style.left="0",e={users:0,context:XE(t)},La[n]=e}return e.users+=1,e.context}function QE(n){const e=La[n];if(!e||(e.users-=1,e.users>0))return;const t=e.context,i=t.getExtension("WEBGL_lose_context");i&&i.loseContext();const r=t.canvas;r.width=1,r.height=1,delete La[n]}class e1 extends hs{constructor(e){super(),e=e||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=e.canvasCacheKey?Bg(e.canvasCacheKey):qE(),this.gl_=JE(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const t=this.gl_.canvas;t.addEventListener(Aa.LOST,this.boundHandleWebGLContextLost_),t.addEventListener(Aa.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=Ve(),this.offsetScaleMatrix_=Ve(),this.tmpMat4_=Ag(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],e.uniforms&&this.setUniforms(e.uniforms),this.postProcessPasses_=e.postProcesses?e.postProcesses.map(i=>new Ug({webGlContext:this.gl_,scaleRatio:i.scaleRatio,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,uniforms:i.uniforms})):[new Ug({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now(),this.maxAttributeCount_=this.gl_.getParameter(this.gl_.MAX_VERTEX_ATTRIBS)}setUniforms(e){this.uniforms_=[],this.addUniforms(e)}addUniforms(e){for(const t in e)this.uniforms_.push({name:t,value:e[t]})}canvasCacheKeyMatches(e){return this.canvasCacheKey_===Bg(e)}getExtension(e){if(e in this.extensionCache_)return this.extensionCache_[e];const t=this.gl_.getExtension(e);return this.extensionCache_[e]=t,t}bindBuffer(e){const t=this.gl_,i=J(e);let r=this.bufferCache_[i];if(!r){const s=t.createBuffer();r={buffer:e,webGlBuffer:s},this.bufferCache_[i]=r}t.bindBuffer(e.getType(),r.webGlBuffer)}flushBufferData(e){const t=this.gl_;this.bindBuffer(e),t.bufferData(e.getType(),e.getArray(),e.getUsage())}deleteBuffer(e){const t=J(e);delete this.bufferCache_[t]}disposeInternal(){const e=this.gl_.canvas;e.removeEventListener(Aa.LOST,this.boundHandleWebGLContextLost_),e.removeEventListener(Aa.RESTORED,this.boundHandleWebGLContextRestored_),QE(this.canvasCacheKey_),delete this.gl_}prepareDraw(e,t,i){const r=this.gl_,s=this.getCanvas(),o=e.size,a=e.pixelRatio;(s.width!==o[0]*a||s.height!==o[1]*a)&&(s.width=o[0]*a,s.height=o[1]*a,s.style.width=o[0]+"px",s.style.height=o[1]+"px");for(let l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(e);r.bindTexture(r.TEXTURE_2D,null),r.clearColor(0,0,0,0),r.depthRange(0,1),r.clearDepth(1),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,t?r.ZERO:r.ONE_MINUS_SRC_ALPHA),i?(r.enable(r.DEPTH_TEST),r.depthFunc(r.LEQUAL)):r.disable(r.DEPTH_TEST)}bindFrameBuffer(e,t){const i=this.getGL();i.bindFramebuffer(i.FRAMEBUFFER,e),t&&i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,t,0)}bindInitialFrameBuffer(){const e=this.getGL(),t=this.postProcessPasses_[0].getFrameBuffer();e.bindFramebuffer(e.FRAMEBUFFER,t);const i=this.postProcessPasses_[0].getRenderTargetTexture();e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0)}bindTexture(e,t,i){const r=this.gl_;r.activeTexture(r.TEXTURE0+t),r.bindTexture(r.TEXTURE_2D,e),r.uniform1i(this.getUniformLocation(i),t)}bindAttribute(e,t,i){const r=this.getGL();this.bindBuffer(e);const s=this.getAttributeLocation(t);r.enableVertexAttribArray(s),r.vertexAttribPointer(s,i,r.FLOAT,!1,0,0)}prepareDrawToRenderTarget(e,t,i,r){const s=this.gl_,o=t.getSize();s.bindFramebuffer(s.FRAMEBUFFER,t.getFramebuffer()),s.bindRenderbuffer(s.RENDERBUFFER,t.getDepthbuffer()),s.viewport(0,0,o[0],o[1]),s.bindTexture(s.TEXTURE_2D,t.getTexture()),s.clearColor(0,0,0,0),s.depthRange(0,1),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.enable(s.BLEND),s.blendFunc(s.ONE,i?s.ZERO:s.ONE_MINUS_SRC_ALPHA),r?(s.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL)):s.disable(s.DEPTH_TEST)}drawElements(e,t){const i=this.gl_;this.getExtension("OES_element_index_uint");const r=i.UNSIGNED_INT,s=4,o=t-e,a=e*s;i.drawElements(i.TRIANGLES,o,r,a)}finalizeDraw(e,t,i){for(let r=0,s=this.postProcessPasses_.length;r<s;r++)r===s-1?this.postProcessPasses_[r].apply(e,null,t,i):this.postProcessPasses_[r].apply(e,this.postProcessPasses_[r+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(e){const t=e.size,i=e.viewState.rotation,r=e.pixelRatio;this.setUniformFloatValue(Yn.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(Yn.ZOOM,e.viewState.zoom),this.setUniformFloatValue(Yn.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(Yn.PIXEL_RATIO,r),this.setUniformFloatVec2(Yn.VIEWPORT_SIZE_PX,[t[0],t[1]]),this.setUniformFloatValue(Yn.ROTATION,i)}applyHitDetectionUniform(e){const t=this.getUniformLocation(Yn.HIT_DETECTION);this.getGL().uniform1i(t,e?1:0),e&&this.setUniformFloatValue(Yn.PIXEL_RATIO,.5)}applyUniforms(e){const t=this.gl_;let i,r=0;this.uniforms_.forEach(s=>{if(i=typeof s.value=="function"?s.value(e):s.value,i instanceof HTMLCanvasElement||i instanceof HTMLImageElement||i instanceof ImageData||i instanceof WebGLTexture){i instanceof WebGLTexture&&!s.texture?(s.prevValue=void 0,s.texture=i):s.texture||(s.prevValue=void 0,s.texture=t.createTexture()),this.bindTexture(s.texture,r,s.name),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);const o=!(i instanceof HTMLImageElement)||i.complete;!(i instanceof WebGLTexture)&&o&&s.prevValue!==i&&(s.prevValue=i,t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i)),r++}else if(Array.isArray(i)&&i.length===6)this.setUniformMatrixValue(s.name,fh(this.tmpMat4_,i));else if(Array.isArray(i)&&i.length<=4)switch(i.length){case 2:t.uniform2f(this.getUniformLocation(s.name),i[0],i[1]);return;case 3:t.uniform3f(this.getUniformLocation(s.name),i[0],i[1],i[2]);return;case 4:t.uniform4f(this.getUniformLocation(s.name),i[0],i[1],i[2],i[3]);return;default:return}else typeof i=="number"&&t.uniform1f(this.getUniformLocation(s.name),i)})}useProgram(e,t){this.disableAllAttributes_(),this.gl_.useProgram(e),this.currentProgram_=e,t&&(this.applyFrameState(t),this.applyUniforms(t))}compileShader(e,t){const i=this.gl_,r=i.createShader(t);return i.shaderSource(r,e),i.compileShader(r),r}getProgram(e,t){const i=this.gl_,r=this.compileShader(e,i.FRAGMENT_SHADER),s=this.compileShader(t,i.VERTEX_SHADER),o=i.createProgram();if(i.attachShader(o,r),i.attachShader(o,s),i.linkProgram(o),!i.getShaderParameter(r,i.COMPILE_STATUS)){const a=`Fragment shader compilation failed: ${i.getShaderInfoLog(r)}`;throw new Error(a)}if(i.deleteShader(r),!i.getShaderParameter(s,i.COMPILE_STATUS)){const a=`Vertex shader compilation failed: ${i.getShaderInfoLog(s)}`;throw new Error(a)}if(i.deleteShader(s),!i.getProgramParameter(o,i.LINK_STATUS)){const a=`GL program linking failed: ${i.getProgramInfoLog(o)}`;throw new Error(a)}return o}getUniformLocation(e){const t=J(this.currentProgram_);return this.uniformLocationsByProgram_[t]===void 0&&(this.uniformLocationsByProgram_[t]={}),this.uniformLocationsByProgram_[t][e]===void 0&&(this.uniformLocationsByProgram_[t][e]=this.gl_.getUniformLocation(this.currentProgram_,e)),this.uniformLocationsByProgram_[t][e]}getAttributeLocation(e){const t=J(this.currentProgram_);return this.attribLocationsByProgram_[t]===void 0&&(this.attribLocationsByProgram_[t]={}),this.attribLocationsByProgram_[t][e]===void 0&&(this.attribLocationsByProgram_[t][e]=this.gl_.getAttribLocation(this.currentProgram_,e)),this.attribLocationsByProgram_[t][e]}makeProjectionTransform(e,t){const i=e.size,r=e.viewState.rotation,s=e.viewState.resolution,o=e.viewState.center;return qt(t,0,0,2/(s*i[0]),2/(s*i[1]),-r,-o[0],-o[1]),t}setUniformFloatValue(e,t){this.gl_.uniform1f(this.getUniformLocation(e),t)}setUniformFloatVec2(e,t){this.gl_.uniform2fv(this.getUniformLocation(e),t)}setUniformFloatVec4(e,t){this.gl_.uniform4fv(this.getUniformLocation(e),t)}setUniformMatrixValue(e,t){this.gl_.uniformMatrix4fv(this.getUniformLocation(e),!1,t)}disableAllAttributes_(){for(let e=0;e<this.maxAttributeCount_;e++)this.gl_.disableVertexAttribArray(e)}enableAttributeArray_(e,t,i,r,s){const o=this.getAttributeLocation(e);o<0||(this.gl_.enableVertexAttribArray(o),this.gl_.vertexAttribPointer(o,t,i,!1,r,s))}enableAttributes(e){const t=t1(e);let i=0;for(let r=0;r<e.length;r++){const s=e[r];this.enableAttributeArray_(s.name,s.size,s.type||kg,t,i),i+=s.size*Wg(s.type)}}handleWebGLContextLost(e){dr(this.bufferCache_),this.currentProgram_=null,e.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(e,t,i,r){const s=this.gl_;i=i||s.createTexture();const o=r?s.NEAREST:s.LINEAR;s.bindTexture(s.TEXTURE_2D,i),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,o),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,o),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE);const a=0,l=s.RGBA,c=0,h=s.RGBA,u=s.UNSIGNED_BYTE;return t instanceof Uint8Array?s.texImage2D(s.TEXTURE_2D,a,l,e[0],e[1],c,h,u,t):t?s.texImage2D(s.TEXTURE_2D,a,l,h,u,t):s.texImage2D(s.TEXTURE_2D,a,l,e[0],e[1],c,h,u,null),i}}function t1(n){let e=0;for(let t=0;t<n.length;t++){const i=n[t];e+=i.size*Wg(i.type)}return e}function Wg(n){switch(n){case pt.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case pt.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case pt.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case pt.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}class vh extends Wf{constructor(e,t){super(e),t=t||{},this.inversePixelTransform_=Ve(),this.postProcesses_=t.postProcesses,this.uniforms_=t.uniforms,this.helper,this.onMapChanged_=()=>{this.clearCache(),this.removeHelper()},e.addChangeListener(Ee.MAP,this.onMapChanged_),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(e,t){const i=this.getLayer();if(i.hasListener(Je.PRECOMPOSE)){const r=new Gs(Je.PRECOMPOSE,void 0,t,e);i.dispatchEvent(r)}}dispatchPostComposeEvent(e,t){const i=this.getLayer();if(i.hasListener(Je.POSTCOMPOSE)){const r=new Gs(Je.POSTCOMPOSE,void 0,t,e);i.dispatchEvent(r)}}reset(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(e){if(this.getLayer().getRenderSource()){let t=!0,i=-1,r;for(let o=0,a=e.layerStatesArray.length;o<a;o++){const l=e.layerStatesArray[o].layer,c=l.getRenderer();if(!(c instanceof vh)){t=!0;continue}const h=l.getClassName();if((t||h!==r)&&(i+=1,t=!1),r=h,c===this)break}const s="map/"+e.mapId+"/group/"+i;(!this.helper||!this.helper.canvasCacheKeyMatches(s)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new e1({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:s}),r&&(this.helper.getCanvas().className=r),this.afterHelperCreated())}return this.prepareFrameInternal(e)}afterHelperCreated(){}prepareFrameInternal(e){return!0}clearCache(){}disposeInternal(){var e;this.clearCache(),this.removeHelper(),(e=this.getLayer())==null||e.removeChangeListener(Ee.MAP,this.onMapChanged_),super.disposeInternal()}dispatchRenderEvent_(e,t,i){const r=this.getLayer();if(r.hasListener(e)){qt(this.inversePixelTransform_,0,0,i.pixelRatio,-i.pixelRatio,0,0,-i.size[1]);const s=new Gs(e,this.inversePixelTransform_,i,t);r.dispatchEvent(s)}}preRender(e,t){this.dispatchRenderEvent_(Je.PRERENDER,e,t)}postRender(e,t){this.dispatchRenderEvent_(Je.POSTRENDER,e,t)}}const Eh={TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight"};class n1{constructor(e,t){this.name=e,this.data=t,this.texture_=null}getTexture(e){if(!this.texture_){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=t}return this.texture_}delete(e){this.texture_&&e.deleteTexture(this.texture_),this.texture_=null}}function i1(n,e){return`operator_${n}_${Object.keys(e.functions).length}`}function Si(n){const e=n.toString();return e.includes(".")?e:e+".0"}function Th(n){if(n.length<2||n.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${n.length}(${n.map(Si).join(", ")})`}function Ma(n){const e=Qt(n),t=e.length>3?e[3]:1;return Th([e[0]/255,e[1]/255,e[2]/255,t])}function r1(n){const e=mt(n);return Th(e)}const wh={};let s1=0;function qs(n){return n in wh||(wh[n]=s1++),wh[n]}function $n(n){return Si(qs(n))}function Sh(n){return"u_var_"+n}function Yg(){return{variables:{},properties:{},functions:{},bandCount:0,featureId:!1,geometryType:!1}}const bh="getBandValue",o1="u_paletteTextures",$g="featureId",jg="geometryType",Ch=-9999999;function a1(n,e,t,i){const r=et(n,e,t);return Rh(r,e,i)}function _e(n){return(e,t,i)=>{const r=t.args.length,s=new Array(r);for(let o=0;o<r;++o)s[o]=Rh(t.args[o],i,e);return n(s,e)}}const l1={[C.Get]:(n,e)=>{const i=e.args[0].value;return i in n.properties||(n.properties[i]={name:i,type:e.type}),"a_prop_"+i},[C.Id]:n=>(n.featureId=!0,"a_"+$g),[C.GeometryType]:n=>(n.geometryType=!0,"a_"+jg),[C.LineMetric]:()=>"currentLineMetric",[C.Var]:(n,e)=>{const i=e.args[0].value;return i in n.variables||(n.variables[i]={name:i,type:e.type}),Sh(i)},[C.Has]:(n,e)=>{const i=e.args[0].value;return i in n.properties||(n.properties[i]={name:i,type:e.type}),`(a_prop_${i} != ${Si(Ch)})`},[C.Resolution]:()=>"u_resolution",[C.Zoom]:()=>"u_zoom",[C.Time]:()=>"u_time",[C.Any]:_e(n=>`(${n.join(" || ")})`),[C.All]:_e(n=>`(${n.join(" && ")})`),[C.Not]:_e(([n])=>`(!${n})`),[C.Equal]:_e(([n,e])=>`(${n} == ${e})`),[C.NotEqual]:_e(([n,e])=>`(${n} != ${e})`),[C.GreaterThan]:_e(([n,e])=>`(${n} > ${e})`),[C.GreaterThanOrEqualTo]:_e(([n,e])=>`(${n} >= ${e})`),[C.LessThan]:_e(([n,e])=>`(${n} < ${e})`),[C.LessThanOrEqualTo]:_e(([n,e])=>`(${n} <= ${e})`),[C.Multiply]:_e(n=>`(${n.join(" * ")})`),[C.Divide]:_e(([n,e])=>`(${n} / ${e})`),[C.Add]:_e(n=>`(${n.join(" + ")})`),[C.Subtract]:_e(([n,e])=>`(${n} - ${e})`),[C.Clamp]:_e(([n,e,t])=>`clamp(${n}, ${e}, ${t})`),[C.Mod]:_e(([n,e])=>`mod(${n}, ${e})`),[C.Pow]:_e(([n,e])=>`pow(${n}, ${e})`),[C.Abs]:_e(([n])=>`abs(${n})`),[C.Floor]:_e(([n])=>`floor(${n})`),[C.Ceil]:_e(([n])=>`ceil(${n})`),[C.Round]:_e(([n])=>`floor(${n} + 0.5)`),[C.Sin]:_e(([n])=>`sin(${n})`),[C.Cos]:_e(([n])=>`cos(${n})`),[C.Atan]:_e(([n,e])=>e!==void 0?`atan(${n}, ${e})`:`atan(${n})`),[C.Sqrt]:_e(([n])=>`sqrt(${n})`),[C.Match]:_e(n=>{const e=n[0],t=n[n.length-1];let i=null;for(let r=n.length-3;r>=1;r-=2){const s=n[r],o=n[r+1];i=`(${e} == ${s} ? ${o} : ${i||t})`}return i}),[C.Between]:_e(([n,e,t])=>`(${n} >= ${e} && ${n} <= ${t})`),[C.Interpolate]:_e(([n,e,...t])=>{let i="";for(let r=0;r<t.length-2;r+=2){const s=t[r],o=i||t[r+1],a=t[r+2],l=t[r+3];let c;n===Si(1)?c=`(${e} - ${s}) / (${a} - ${s})`:c=`(pow(${n}, (${e} - ${s})) - 1.0) / (pow(${n}, (${a} - ${s})) - 1.0)`,i=`mix(${o}, ${l}, clamp(${c}, 0.0, 1.0))`}return i}),[C.Case]:_e(n=>{const e=n[n.length-1];let t=null;for(let i=n.length-3;i>=0;i-=2){const r=n[i],s=n[i+1];t=`(${r} ? ${s} : ${t||e})`}return t}),[C.In]:_e(([n,...e],t)=>{const i=i1("in",t),r=[];for(let s=0;s<e.length;s+=1)r.push(`  if (inputValue == ${e[s]}) { return true; }`);return t.functions[i]=`bool ${i}(float inputValue) {
${r.join(`
`)}
  return false;
}`,`${i}(${n})`}),[C.Array]:_e(n=>`vec${n.length}(${n.join(", ")})`),[C.Color]:_e(n=>{if(n.length===1)return`vec4(vec3(${n[0]} / 255.0), 1.0)`;if(n.length===2)return`vec4(vec3(${n[0]} / 255.0), ${n[1]})`;const e=n.slice(0,3).map(i=>`${i} / 255.0`);if(n.length===3)return`vec4(${e.join(", ")}, 1.0)`;const t=n[3];return`vec4(${e.join(", ")}, ${t})`}),[C.Band]:_e(([n,e,t],i)=>{if(!(bh in i.functions)){let r="";const s=i.bandCount||1;for(let o=0;o<s;o++){const a=Math.floor(o/4);let l=o%4;o===s-1&&l===1&&(l=3);const c=`${Eh.TILE_TEXTURE_ARRAY}[${a}]`;r+=`  if (band == ${o+1}.0) {
    return texture2D(${c}, v_textureCoord + vec2(dx, dy))[${l}];
  }
`}i.functions[bh]=`float getBandValue(float band, float xOffset, float yOffset) {
  float dx = xOffset / ${Eh.TEXTURE_PIXEL_WIDTH};
  float dy = yOffset / ${Eh.TEXTURE_PIXEL_HEIGHT};
${r}
}`}return`${bh}(${n}, ${e??"0.0"}, ${t??"0.0"})`}),[C.Palette]:(n,e)=>{const[t,...i]=e.args,r=i.length,s=new Uint8Array(r*4);for(let c=0;c<i.length;c++){const h=i[c].value,u=Qt(h),d=c*4;s[d]=u[0],s[d+1]=u[1],s[d+2]=u[2],s[d+3]=u[3]*255}n.paletteTextures||(n.paletteTextures=[]);const o=`${o1}[${n.paletteTextures.length}]`,a=new n1(o,s);n.paletteTextures.push(a);const l=Rh(t,$,n);return`texture2D(${o}, vec2((${l} + 0.5) / ${r}.0, 0.5))`}};function Rh(n,e,t){if(n instanceof jf){const i=l1[n.operator];if(i===void 0)throw new Error(`No compiler defined for this operator: ${JSON.stringify(n.operator)}`);return i(t,n,e)}if((n.type&$)>0)return Si(n.value);if((n.type&Xe)>0)return n.value.toString();if((n.type&He)>0)return $n(n.value.toString());if((n.type&Oe)>0)return Ma(n.value);if((n.type&Rt)>0)return Th(n.value);if((n.type&zt)>0)return r1(n.value);throw new Error(`Unexpected expression ${n.value} (expected type ${Lr(e)})`)}function c1(){return{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"#3399CC","stroke-width":1.25,"circle-radius":5,"circle-fill-color":"rgba(255,255,255,0.4)","circle-stroke-width":1.25,"circle-stroke-color":"#3399CC"}}const Vg=.985,Br=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
uniform mat4 u_projectionMatrix;
uniform mat4 u_screenToWorldMatrix;
uniform vec2 u_viewportSizePx;
uniform float u_pixelRatio;
uniform float u_globalAlpha;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
uniform float u_rotation;
uniform vec4 u_renderExtent;
uniform vec2 u_patternOrigin;
uniform float u_depth;
uniform mediump int u_hitDetection;

const float PI = 3.141592653589793238;
const float TWO_PI = 2.0 * PI;
float currentLineMetric = 0.; // an actual value will be used in the stroke shaders
`,zr=c1();class Xg{constructor(){this.uniforms_=[],this.attributes_=[],this.hasSymbol_=!1,this.symbolSizeExpression_=`vec2(${Si(zr["circle-radius"])} + ${Si(zr["circle-stroke-width"]*.5)})`,this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_=Ma(zr["circle-fill-color"]),this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.hasStroke_=!1,this.strokeWidthExpression_=Si(zr["stroke-width"]),this.strokeColorExpression_=Ma(zr["stroke-color"]),this.strokeOffsetExpression_="0.",this.strokeCapExpression_=$n("round"),this.strokeJoinExpression_=$n("round"),this.strokeMiterLimitExpression_="10.",this.strokeDistanceFieldExpression_="-1000.",this.hasFill_=!1,this.fillColorExpression_=Ma(zr["fill-color"]),this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]}addUniform(e,t){return this.uniforms_.push({name:e,type:t}),this}addAttribute(e,t,i,r){return this.attributes_.push({name:e,type:t,varyingName:e.replace(/^a_/,"v_"),varyingType:r??t,varyingExpression:i??e}),this}setSymbolSizeExpression(e){return this.hasSymbol_=!0,this.symbolSizeExpression_=e,this}getSymbolSizeExpression(){return this.symbolSizeExpression_}setSymbolRotationExpression(e){return this.symbolRotationExpression_=e,this}setSymbolOffsetExpression(e){return this.symbolOffsetExpression_=e,this}getSymbolOffsetExpression(){return this.symbolOffsetExpression_}setSymbolColorExpression(e){return this.hasSymbol_=!0,this.symbolColorExpression_=e,this}getSymbolColorExpression(){return this.symbolColorExpression_}setTextureCoordinateExpression(e){return this.texCoordExpression_=e,this}setFragmentDiscardExpression(e){return this.discardExpression_=e,this}getFragmentDiscardExpression(){return this.discardExpression_}setSymbolRotateWithView(e){return this.symbolRotateWithView_=e,this}setStrokeWidthExpression(e){return this.hasStroke_=!0,this.strokeWidthExpression_=e,this}setStrokeColorExpression(e){return this.hasStroke_=!0,this.strokeColorExpression_=e,this}getStrokeColorExpression(){return this.strokeColorExpression_}setStrokeOffsetExpression(e){return this.strokeOffsetExpression_=e,this}setStrokeCapExpression(e){return this.strokeCapExpression_=e,this}setStrokeJoinExpression(e){return this.strokeJoinExpression_=e,this}setStrokeMiterLimitExpression(e){return this.strokeMiterLimitExpression_=e,this}setStrokeDistanceFieldExpression(e){return this.strokeDistanceFieldExpression_=e,this}setFillColorExpression(e){return this.hasFill_=!0,this.fillColorExpression_=e,this}getFillColorExpression(){return this.fillColorExpression_}addVertexShaderFunction(e){return this.vertexShaderFunctions_.includes(e)?this:(this.vertexShaderFunctions_.push(e),this)}addFragmentShaderFunction(e){return this.fragmentShaderFunctions_.includes(e)?this:(this.fragmentShaderFunctions_.push(e),this)}getSymbolVertexShader(){return this.hasSymbol_?`${Br}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute float a_index;
attribute vec4 a_hitColor;

varying vec2 v_texCoord;
varying vec2 v_quadCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 pxToScreen(vec2 coordPx) {
  vec2 scaled = coordPx / u_viewportSizePx / 0.5;
  return scaled;
}

vec2 screenToPx(vec2 coordScreen) {
  return (coordScreen * 0.5 + 0.5) * u_viewportSizePx;
}

void main(void) {
  v_quadSizePx = ${this.symbolSizeExpression_};
  vec2 halfSizePx = v_quadSizePx * 0.5;
  vec2 centerOffsetPx = ${this.symbolOffsetExpression_};
  vec2 offsetPx = centerOffsetPx;
  if (a_index == 0.0) {
    offsetPx -= halfSizePx;
  } else if (a_index == 1.0) {
    offsetPx += halfSizePx * vec2(1., -1.);
  } else if (a_index == 2.0) {
    offsetPx += halfSizePx;
  } else {
    offsetPx += halfSizePx * vec2(-1., 1.);
  }
  float angle = ${this.symbolRotationExpression_}${this.symbolRotateWithView_?" + u_rotation":""};
  float c = cos(-angle);
  float s = sin(-angle);
  offsetPx = vec2(c * offsetPx.x - s * offsetPx.y, s * offsetPx.x + c * offsetPx.y);
  vec4 center = u_projectionMatrix * vec4(a_position, 0.0, 1.0);
  gl_Position = center + vec4(pxToScreen(offsetPx), u_depth, 0.);
  vec4 texCoord = ${this.texCoordExpression_};
  float u = a_index == 0.0 || a_index == 3.0 ? texCoord.s : texCoord.p;
  float v = a_index == 2.0 || a_index == 3.0 ? texCoord.t : texCoord.q;
  v_texCoord = vec2(u, v);
  v_hitColor = a_hitColor;
  v_angle = angle;
  c = cos(-v_angle);
  s = sin(-v_angle);
  centerOffsetPx = vec2(c * centerOffsetPx.x - s * centerOffsetPx.y, s * centerOffsetPx.x + c * centerOffsetPx.y);
  v_centerPx = screenToPx(center.xy) + centerOffsetPx;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getSymbolFragmentShader(){return this.hasSymbol_?`${Br}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_texCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  if (${this.discardExpression_}) { discard; }
  vec2 coordsPx = gl_FragCoord.xy / u_pixelRatio - v_centerPx; // relative to center
  float c = cos(v_angle);
  float s = sin(v_angle);
  coordsPx = vec2(c * coordsPx.x - s * coordsPx.y, s * coordsPx.x + c * coordsPx.y);
  gl_FragColor = ${this.symbolColorExpression_};
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.05) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getStrokeVertexShader(){return this.hasStroke_?`${Br}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_segmentStart;
attribute vec2 a_segmentEnd;
attribute float a_measureStart;
attribute float a_measureEnd;
attribute float a_parameters;
attribute float a_distance;
attribute vec2 a_joinAngles;
attribute vec4 a_hitColor;

varying vec2 v_segmentStart;
varying vec2 v_segmentEnd;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distanceOffsetPx;
varying float v_measureStart;
varying float v_measureEnd;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

vec4 pxToScreen(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return vec4(screenPos, u_depth, 1.0);
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

vec2 getJoinOffsetDirection(vec2 normalPx, float joinAngle) {
  float halfAngle = joinAngle / 2.0;
  float c = cos(halfAngle);
  float s = sin(halfAngle);
  vec2 angleBisectorNormal = vec2(s * normalPx.x + c * normalPx.y, -c * normalPx.x + s * normalPx.y);
  float length = 1.0 / s;
  return angleBisectorNormal * length;
}

vec2 getOffsetPoint(vec2 point, vec2 normal, float joinAngle, float offsetPx) {
  // if on a cap or the join angle is too high, offset the line along the segment normal
  if (cos(joinAngle) > 0.998 || isCap(joinAngle)) {
    return point - normal * offsetPx;
  }
  // offset is applied along the inverted normal (positive offset goes "right" relative to line direction)
  return point - getJoinOffsetDirection(normal, joinAngle) * offsetPx;
}

void main(void) {
  v_angleStart = a_joinAngles.x;
  v_angleEnd = a_joinAngles.y;
  float vertexNumber = floor(abs(a_parameters) / 10000. + 0.5);
  currentLineMetric = vertexNumber < 1.5 ? a_measureStart : a_measureEnd;
  // we're reading the fractional part while keeping the sign (so -4.12 gives -0.12, 3.45 gives 0.45)
  float angleTangentSum = fract(abs(a_parameters) / 10000.) * 10000. * sign(a_parameters);

  float lineWidth = ${this.strokeWidthExpression_};
  float lineOffsetPx = ${this.strokeOffsetExpression_};

  // compute segment start/end in px with offset
  vec2 segmentStartPx = worldToPx(a_segmentStart);
  vec2 segmentEndPx = worldToPx(a_segmentEnd);
  vec2 tangentPx = normalize(segmentEndPx - segmentStartPx);
  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);
  segmentStartPx = getOffsetPoint(segmentStartPx, normalPx, v_angleStart, lineOffsetPx),
  segmentEndPx = getOffsetPoint(segmentEndPx, normalPx, v_angleEnd, lineOffsetPx);

  // compute current vertex position
  float normalDir = vertexNumber < 0.5 || (vertexNumber > 1.5 && vertexNumber < 2.5) ? 1.0 : -1.0;
  float tangentDir = vertexNumber < 1.5 ? 1.0 : -1.0;
  float angle = vertexNumber < 1.5 ? v_angleStart : v_angleEnd;
  vec2 joinDirection;
  vec2 positionPx = vertexNumber < 1.5 ? segmentStartPx : segmentEndPx;
  // if angle is too high, do not make a proper join
  if (cos(angle) > ${Vg} || isCap(angle)) {
    joinDirection = normalPx * normalDir - tangentPx * tangentDir;
  } else {
    joinDirection = getJoinOffsetDirection(normalPx * normalDir, angle);
  }
  positionPx = positionPx + joinDirection * (lineWidth * 0.5 + 1.); // adding 1 pixel for antialiasing
  gl_Position = pxToScreen(positionPx);

  v_segmentStart = segmentStartPx;
  v_segmentEnd = segmentEndPx;
  v_width = lineWidth;
  v_hitColor = a_hitColor;
  v_distanceOffsetPx = a_distance / u_resolution - (lineOffsetPx * angleTangentSum);
  v_measureStart = a_measureStart;
  v_measureEnd = a_measureEnd;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getStrokeFragmentShader(){return this.hasStroke_?`${Br}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_segmentStart;
varying vec2 v_segmentEnd;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distanceOffsetPx;
varying float v_measureStart;
varying float v_measureEnd;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

float segmentDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  vec2 tangent = normalize(end - start);
  vec2 normal = vec2(-tangent.y, tangent.x);
  vec2 startToPoint = point - start;
  return abs(dot(startToPoint, normal)) - width * 0.5;
}

float buttCapDistanceField(vec2 point, vec2 start, vec2 end) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  return dot(startToPoint, -tangent);
}

float squareCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return buttCapDistanceField(point, start, end) - width * 0.5;
}

float roundCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  float onSegment = max(0., 1000. * dot(point - start, end - start)); // this is very high when inside the segment
  return length(point - start) - width * 0.5 - onSegment;
}

float roundJoinDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return roundCapDistanceField(point, start, end, width);
}

float bevelJoinField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  float c = cos(joinAngle * 0.5);
  float s = sin(joinAngle * 0.5);
  float direction = -sign(sin(joinAngle));
  vec2 bisector = vec2(c * tangent.x - s * tangent.y, s * tangent.x + c * tangent.y);
  float radius = width * 0.5 * s;
  return dot(startToPoint, bisector * direction) - radius;
}

float miterJoinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  if (cos(joinAngle) > ${Vg}) { // avoid risking a division by zero
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  float miterLength = 1. / sin(joinAngle * 0.5);
  float miterLimit = ${this.strokeMiterLimitExpression_};
  if (miterLength > miterLimit) {
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  return -1000.;
}

float capDistanceField(vec2 point, vec2 start, vec2 end, float width, float capType) {
   if (capType == ${$n("butt")}) {
    return buttCapDistanceField(point, start, end);
  } else if (capType == ${$n("square")}) {
    return squareCapDistanceField(point, start, end, width);
  }
  return roundCapDistanceField(point, start, end, width);
}

float joinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float joinType) {
  if (joinType == ${$n("bevel")}) {
    return bevelJoinField(point, start, end, width, joinAngle);
  } else if (joinType == ${$n("miter")}) {
    return miterJoinDistanceField(point, start, end, width, joinAngle);
  }
  return roundJoinDistanceField(point, start, end, width);
}

float computeSegmentPointDistance(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float capType, float joinType) {
  if (isCap(joinAngle)) {
    return capDistanceField(point, start, end, width, capType);
  }
  return joinDistanceField(point, start, end, width, joinAngle, joinType);
}

float distanceFromSegment(vec2 point, vec2 start, vec2 end) {
  vec2 tangent = end - start;
  vec2 startToPoint = point - start;
  // inspire by capsule fn in https://iquilezles.org/articles/distfunctions/
  float h = clamp(dot(startToPoint, tangent) / dot(tangent, tangent), 0.0, 1.0);
  return length(startToPoint - tangent * h);
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}

  vec2 currentPoint = gl_FragCoord.xy / u_pixelRatio;
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(currentPoint);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif

  float segmentLength = length(v_segmentEnd - v_segmentStart);
  vec2 segmentTangent = (v_segmentEnd - v_segmentStart) / segmentLength;
  vec2 segmentNormal = vec2(-segmentTangent.y, segmentTangent.x);
  vec2 startToPoint = currentPoint - v_segmentStart;
  float lengthToPoint = max(0., min(dot(segmentTangent, startToPoint), segmentLength));
  float currentLengthPx = lengthToPoint + v_distanceOffsetPx;
  float currentRadiusPx = distanceFromSegment(currentPoint, v_segmentStart, v_segmentEnd);
  float currentRadiusRatio = dot(segmentNormal, startToPoint) * 2. / v_width;
  currentLineMetric = mix(
    v_measureStart,
    v_measureEnd,
    lengthToPoint / max(segmentLength, 1.17549429e-38)
  );

  if (${this.discardExpression_}) { discard; }

  float capType = ${this.strokeCapExpression_};
  float joinType = ${this.strokeJoinExpression_};
  float segmentStartDistance = computeSegmentPointDistance(currentPoint, v_segmentStart, v_segmentEnd, v_width, v_angleStart, capType, joinType);
  float segmentEndDistance = computeSegmentPointDistance(currentPoint, v_segmentEnd, v_segmentStart, v_width, v_angleEnd, capType, joinType);
  float distanceField = max(
    segmentDistanceField(currentPoint, v_segmentStart, v_segmentEnd, v_width),
    max(segmentStartDistance, segmentEndDistance)
  );
  distanceField = max(distanceField, ${this.strokeDistanceFieldExpression_});

  vec4 color = ${this.strokeColorExpression_};
  color.a *= smoothstep(0.5, -0.5, distanceField);
  gl_FragColor = color;
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getFillVertexShader(){return this.hasFill_?`${Br}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec4 a_hitColor;

varying vec4 v_hitColor;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
void main(void) {
  gl_Position = u_projectionMatrix * vec4(a_position, u_depth, 1.0);
  v_hitColor = a_hitColor;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getFillFragmentShader(){return this.hasFill_?`${Br}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec4 v_hitColor;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}
vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  vec2 pxPos = gl_FragCoord.xy / u_pixelRatio;
  vec2 pxOrigin = worldToPx(u_patternOrigin);
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(pxPos);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.fillColorExpression_};
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}}function ne(n,e,t){const i=_a();return a1(e,t,i,n)}function h1(n){const e=Qt(n),t=e[0]*256,i=e[1],r=e[2]*256,s=Math.round(e[3]*255);return[t+i,r+s]}const u1=`vec4 unpackColor(vec2 packedColor) {
  return vec4(
    fract(floor(packedColor[0] / 256.0) / 256.0),
    fract(packedColor[0] / 256.0),
    fract(floor(packedColor[1] / 256.0) / 256.0),
    fract(packedColor[1] / 256.0)
  );
}`;function Ph(n){return n===Oe||n===zt?2:n===Rt?4:1}function Ih(n){const e=Ph(n);return e>1?`vec${e}`:"float"}function Hg(n,e){for(const t in e.variables){const i=e.variables[t],r=Sh(i.name);let s=Ih(i.type);i.type===Oe&&(s="vec4"),n.addUniform(r,s)}for(const t in e.properties){const i=e.properties[t],r=Ih(i.type),s=`a_prop_${i.name}`;i.type===Oe?(n.addAttribute(s,r,`unpackColor(${s})`,"vec4"),n.addVertexShaderFunction(u1)):n.addAttribute(s,r)}for(const t in e.functions)n.addVertexShaderFunction(e.functions[t]),n.addFragmentShaderFunction(e.functions[t])}function Kg(n,e){const t={};for(const i in n.variables){const r=n.variables[i],s=Sh(r.name);t[s]=()=>{const o=e[r.name];if(typeof o=="number")return o;if(typeof o=="boolean")return o?1:0;if(r.type===Oe){const a=[...Qt(o||"#eee")];return a[0]/=255,a[1]/=255,a[2]/=255,a[3]??(a[3]=1),a}return typeof o=="string"?qs(o):o}}return t}function Zg(n){const e={};for(const t in n.properties){const i=n.properties[t],r=s=>{const o=s.get(i.name);return i.type===Oe?h1([...Qt(o||"#eee")]):typeof o=="string"?qs(o):typeof o=="boolean"?o?1:0:o};e[`prop_${i.name}`]={size:Ph(i.type),callback:r}}return e}class Oa{constructor(){this.globalCounter_=0,this.refToFeature_=new Map,this.uidToRef_=new Map,this.freeGlobalRef_=[],this.polygonBatch={entries:{},geometriesCount:0,verticesCount:0,ringsCount:0},this.pointBatch={entries:{},geometriesCount:0},this.lineStringBatch={entries:{},geometriesCount:0,verticesCount:0}}addFeatures(e,t){for(let i=0;i<e.length;i++)this.addFeature(e[i],t)}addFeature(e,t){let i=e.getGeometry();i&&(t&&(i=i.clone(),i.applyTransform(t)),this.addGeometry_(i,e))}clearFeatureEntryInPointBatch_(e){const t=J(e),i=this.pointBatch.entries[t];if(i)return this.pointBatch.geometriesCount-=i.flatCoordss.length,delete this.pointBatch.entries[t],i}clearFeatureEntryInLineStringBatch_(e){const t=J(e),i=this.lineStringBatch.entries[t];if(i)return this.lineStringBatch.verticesCount-=i.verticesCount,this.lineStringBatch.geometriesCount-=i.flatCoordss.length,delete this.lineStringBatch.entries[t],i}clearFeatureEntryInPolygonBatch_(e){const t=J(e),i=this.polygonBatch.entries[t];if(i)return this.polygonBatch.verticesCount-=i.verticesCount,this.polygonBatch.ringsCount-=i.ringsCount,this.polygonBatch.geometriesCount-=i.flatCoordss.length,delete this.polygonBatch.entries[t],i}addGeometry_(e,t){var r;const i=e.getType();switch(i){case"GeometryCollection":{const s=e.getGeometriesArray();for(const o of s)this.addGeometry_(o,t);break}case"MultiPolygon":{const s=e;this.addCoordinates_(i,s.getFlatCoordinates(),s.getEndss(),t,J(t),s.getStride());break}case"MultiLineString":{const s=e;this.addCoordinates_(i,s.getFlatCoordinates(),s.getEnds(),t,J(t),s.getStride());break}case"MultiPoint":{const s=e;this.addCoordinates_(i,s.getFlatCoordinates(),null,t,J(t),s.getStride());break}case"Polygon":{const s=e;this.addCoordinates_(i,s.getFlatCoordinates(),s.getEnds(),t,J(t),s.getStride());break}case"Point":{const s=e;this.addCoordinates_(i,s.getFlatCoordinates(),null,t,J(t),s.getStride());break}case"LineString":case"LinearRing":{const s=e,o=s.getStride();this.addCoordinates_(i,s.getFlatCoordinates(),null,t,J(t),o,(r=s.getLayout)==null?void 0:r.call(s));break}}}addCoordinates_(e,t,i,r,s,o,a){let l;switch(e){case"MultiPolygon":{const c=i;for(let h=0,u=c.length;h<u;h++){let d=c[h];const f=h>0?c[h-1]:null,g=f?f[f.length-1]:0,_=d[d.length-1];d=g>0?d.map(m=>m-g):d,this.addCoordinates_("Polygon",t.slice(g,_),d,r,s,o,a)}break}case"MultiLineString":{const c=i;for(let h=0,u=c.length;h<u;h++){const d=h>0?c[h-1]:0;this.addCoordinates_("LineString",t.slice(d,c[h]),null,r,s,o,a)}break}case"MultiPoint":for(let c=0,h=t.length;c<h;c+=o)this.addCoordinates_("Point",t.slice(c,c+2),null,r,s,null,null);break;case"Polygon":{const c=i;if(r instanceof Ct){const d=Jd(t,c);if(d.length>1){this.addCoordinates_("MultiPolygon",t,d,r,s,o,a);return}}this.polygonBatch.entries[s]||(this.polygonBatch.entries[s]=this.addRefToEntry_(s,{feature:r,flatCoordss:[],verticesCount:0,ringsCount:0,ringsVerticesCounts:[]})),l=t.length/o;const h=i.length,u=i.map((d,f,g)=>f>0?(d-g[f-1])/o:d/o);this.polygonBatch.verticesCount+=l,this.polygonBatch.ringsCount+=h,this.polygonBatch.geometriesCount++,this.polygonBatch.entries[s].flatCoordss.push(d1(t,o)),this.polygonBatch.entries[s].ringsVerticesCounts.push(u),this.polygonBatch.entries[s].verticesCount+=l,this.polygonBatch.entries[s].ringsCount+=h;for(let d=0,f=c.length;d<f;d++){const g=d>0?c[d-1]:0;this.addCoordinates_("LinearRing",t.slice(g,c[d]),null,r,s,o,a)}break}case"Point":this.pointBatch.entries[s]||(this.pointBatch.entries[s]=this.addRefToEntry_(s,{feature:r,flatCoordss:[]})),this.pointBatch.geometriesCount++,this.pointBatch.entries[s].flatCoordss.push(t);break;case"LineString":case"LinearRing":this.lineStringBatch.entries[s]||(this.lineStringBatch.entries[s]=this.addRefToEntry_(s,{feature:r,flatCoordss:[],verticesCount:0})),l=t.length/o,this.lineStringBatch.verticesCount+=l,this.lineStringBatch.geometriesCount++,this.lineStringBatch.entries[s].flatCoordss.push(f1(t,o,a)),this.lineStringBatch.entries[s].verticesCount+=l;break}}addRefToEntry_(e,t){const i=this.uidToRef_.get(e),r=i||this.freeGlobalRef_.pop()||++this.globalCounter_;return t.ref=r,i||(this.refToFeature_.set(r,t.feature),this.uidToRef_.set(e,r)),t}removeRef_(e,t){if(!e)throw new Error("This feature has no ref: "+t);this.refToFeature_.delete(e),this.uidToRef_.delete(t),this.freeGlobalRef_.push(e)}changeFeature(e,t){if(!this.uidToRef_.get(J(e)))return;this.removeFeature(e);let i=e.getGeometry();i&&(t&&(i=i.clone(),i.applyTransform(t)),this.addGeometry_(i,e))}removeFeature(e){let t=this.clearFeatureEntryInPointBatch_(e);t=this.clearFeatureEntryInPolygonBatch_(e)||t,t=this.clearFeatureEntryInLineStringBatch_(e)||t,t&&this.removeRef_(t.ref,J(t.feature))}clear(){this.polygonBatch.entries={},this.polygonBatch.geometriesCount=0,this.polygonBatch.verticesCount=0,this.polygonBatch.ringsCount=0,this.lineStringBatch.entries={},this.lineStringBatch.geometriesCount=0,this.lineStringBatch.verticesCount=0,this.pointBatch.entries={},this.pointBatch.geometriesCount=0,this.globalCounter_=0,this.freeGlobalRef_=[],this.refToFeature_.clear(),this.uidToRef_.clear()}getFeatureFromRef(e){return this.refToFeature_.get(e)}isEmpty(){return this.globalCounter_===0}filter(e){const t=new Oa;t.globalCounter_=this.globalCounter_,t.uidToRef_=this.uidToRef_,t.refToFeature_=this.refToFeature_;let i=!0;for(const r of this.refToFeature_.values())e(r)&&(t.addFeature(r),i=!1);return i?new Oa:t}}function d1(n,e){return e===2?n:n.filter((t,i)=>i%e<2)}function f1(n,e,t){return e===3&&t==="XYM"?n:e===4?n.filter((i,r)=>r%e!==2):e===3?n.map((i,r)=>r%e!==2?i:0):new Array(n.length*1.5).fill(0).map((i,r)=>r%3===2?0:n[Math.round(r/1.5)])}function g1(){const n='function t(t,n,x=2){const o=n&&n.length,i=o?n[0]*x:t.length;let u=e(t,0,i,x,!0);const l=[];if(!u||u.next===u.prev)return l;let c,h,y;if(o&&(u=function(t,n,r,x){const o=[];for(let r=0,i=n.length;r<i;r++){const u=e(t,n[r]*x,r<i-1?n[r+1]*x:t.length,x,!1);u===u.next&&(u.steiner=!0),o.push(a(u))}o.sort(f);for(let t=0;t<o.length;t++)r=s(o[t],r);return r}(t,n,u,x)),t.length>80*x){c=1/0,h=1/0;let e=-1/0,n=-1/0;for(let r=x;r<i;r+=x){const x=t[r],o=t[r+1];x<c&&(c=x),o<h&&(h=o),x>e&&(e=x),o>n&&(n=o)}y=Math.max(e-c,n-h),y=0!==y?32767/y:0}return r(u,l,x,c,h,y,0),l}function e(t,e,n,r,x){let o;if(x===function(t,e,n,r){let x=0;for(let o=e,i=n-r;o<n;o+=r)x+=(t[i]-t[o])*(t[o+1]+t[i+1]),i=o;return x}(t,e,n,r)>0)for(let x=e;x<n;x+=r)o=w(x/r|0,t[x],t[x+1],o);else for(let x=n-r;x>=e;x-=r)o=w(x/r|0,t[x],t[x+1],o);return o&&g(o,o.next)&&(A(o),o=o.next),o}function n(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!g(r,r.next)&&0!==v(r.prev,r,r.next))r=r.next;else{if(A(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function r(t,e,f,s,l,a,h){if(!t)return;!h&&a&&function(t,e,n,r){let x=t;do{0===x.z&&(x.z=c(x.x,x.y,e,n,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==t);x.prevZ.nextZ=null,x.prevZ=null,function(t){let e,n=1;do{let r,x=t;t=null;let o=null;for(e=0;x;){e++;let i=x,u=0;for(let t=0;t<n&&(u++,i=i.nextZ,i);t++);let f=n;for(;u>0||f>0&&i;)0!==u&&(0===f||!i||x.z<=i.z)?(r=x,x=x.nextZ,u--):(r=i,i=i.nextZ,f--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;x=i}o.nextZ=null,n*=2}while(e>1)}(x)}(t,s,l,a);let y=t;for(;t.prev!==t.next;){const c=t.prev,p=t.next;if(a?o(t,s,l,a):x(t))e.push(c.i,t.i,p.i),A(t),t=p.next,y=p.next;else if((t=p)===y){h?1===h?r(t=i(n(t),e),e,f,s,l,a,2):2===h&&u(t,e,f,s,l,a):r(n(t),e,f,s,l,a,1);break}}}function x(t){const e=t.prev,n=t,r=t.next;if(v(e,n,r)>=0)return!1;const x=e.x,o=n.x,i=r.x,u=e.y,f=n.y,s=r.y,l=Math.min(x,o,i),c=Math.min(u,f,s),a=Math.max(x,o,i),h=Math.max(u,f,s);let p=r.next;for(;p!==e;){if(p.x>=l&&p.x<=a&&p.y>=c&&p.y<=h&&y(x,u,o,f,i,s,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function o(t,e,n,r){const x=t.prev,o=t,i=t.next;if(v(x,o,i)>=0)return!1;const u=x.x,f=o.x,s=i.x,l=x.y,a=o.y,h=i.y,p=Math.min(u,f,s),g=Math.min(l,a,h),b=Math.max(u,f,s),M=Math.max(l,a,h),m=c(p,g,e,n,r),Z=c(b,M,e,n,r);let d=t.prevZ,w=t.nextZ;for(;d&&d.z>=m&&w&&w.z<=Z;){if(d.x>=p&&d.x<=b&&d.y>=g&&d.y<=M&&d!==x&&d!==i&&y(u,l,f,a,s,h,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,w.x>=p&&w.x<=b&&w.y>=g&&w.y<=M&&w!==x&&w!==i&&y(u,l,f,a,s,h,w.x,w.y)&&v(w.prev,w,w.next)>=0)return!1;w=w.nextZ}for(;d&&d.z>=m;){if(d.x>=p&&d.x<=b&&d.y>=g&&d.y<=M&&d!==x&&d!==i&&y(u,l,f,a,s,h,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;w&&w.z<=Z;){if(w.x>=p&&w.x<=b&&w.y>=g&&w.y<=M&&w!==x&&w!==i&&y(u,l,f,a,s,h,w.x,w.y)&&v(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function i(t,e){let r=t;do{const n=r.prev,x=r.next.next;!g(n,x)&&b(n,r,r.next,x)&&Z(n,x)&&Z(x,n)&&(e.push(n.i,r.i,x.i),A(r),A(r.next),r=t=x),r=r.next}while(r!==t);return n(r)}function u(t,e,x,o,i,u){let f=t;do{let t=f.next.next;for(;t!==f.prev;){if(f.i!==t.i&&p(f,t)){let s=d(f,t);return f=n(f,f.next),s=n(s,s.next),r(f,e,x,o,i,u,0),void r(s,e,x,o,i,u,0)}t=t.next}f=f.next}while(f!==t)}function f(t,e){let n=t.x-e.x;if(0===n&&(n=t.y-e.y,0===n)){n=(t.next.y-t.y)/(t.next.x-t.x)-(e.next.y-e.y)/(e.next.x-e.x)}return n}function s(t,e){const r=function(t,e){let n=e;const r=t.x,x=t.y;let o,i=-1/0;if(g(t,n))return n;do{if(g(t,n.next))return n.next;if(x<=n.y&&x>=n.next.y&&n.next.y!==n.y){const t=n.x+(x-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>i&&(i=t,o=n.x<n.next.x?n:n.next,t===r))return o}n=n.next}while(n!==e);if(!o)return null;const u=o,f=o.x,s=o.y;let c=1/0;n=o;do{if(r>=n.x&&n.x>=f&&r!==n.x&&h(x<s?r:i,x,f,s,x<s?i:r,x,n.x,n.y)){const e=Math.abs(x-n.y)/(r-n.x);Z(n,t)&&(e<c||e===c&&(n.x>o.x||n.x===o.x&&l(o,n)))&&(o=n,c=e)}n=n.next}while(n!==u);return o}(t,e);if(!r)return e;const x=d(r,t);return n(x,x.next),n(r,r.next)}function l(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function c(t,e,n,r,x){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*x|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function a(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function h(t,e,n,r,x,o,i,u){return(x-i)*(e-u)>=(t-i)*(o-u)&&(t-i)*(r-u)>=(n-i)*(e-u)&&(n-i)*(o-u)>=(x-i)*(r-u)}function y(t,e,n,r,x,o,i,u){return!(t===i&&e===u)&&h(t,e,n,r,x,o,i,u)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&b(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Z(t,e)&&Z(e,t)&&function(t,e){let n=t,r=!1;const x=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&x<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||g(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function g(t,e){return t.x===e.x&&t.y===e.y}function b(t,e,n,r){const x=m(v(t,e,n)),o=m(v(t,e,r)),i=m(v(n,r,t)),u=m(v(n,r,e));return x!==o&&i!==u||(!(0!==x||!M(t,n,e))||(!(0!==o||!M(t,r,e))||(!(0!==i||!M(n,t,r))||!(0!==u||!M(n,e,r)))))}function M(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function m(t){return t>0?1:t<0?-1:0}function Z(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function d(t,e){const n=E(t.i,t.x,t.y),r=E(e.i,e.x,e.y),x=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=x,x.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function w(t,e,n,r){const x=E(t,e,n);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function A(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function E(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function I(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function z(t,e){const n=(r=e)[0]*r[3]-r[1]*r[2];var r;!function(t,e){if(!t)throw new Error(e)}(0!==n,"Transformation matrix cannot be inverted");const x=e[0],o=e[1],i=e[2],u=e[3],f=e[4],s=e[5];return t[0]=u/n,t[1]=-o/n,t[2]=-i/n,t[3]=x/n,t[4]=(i*s-u*f)/n,t[5]=-(x*s-o*f)/n,t}new Array(6);const F=[],P={vertexPosition:0,indexPosition:0};function B(t,e,n,r,x){t[e+0]=n,t[e+1]=r,t[e+2]=x}function N(t,e,n,r,x,o){const i=3+x,u=t[e+0],f=t[e+1],s=F;s.length=x;for(let n=0;n<s.length;n++)s[n]=t[e+2+n];let l=o?o.vertexPosition:0,c=o?o.indexPosition:0;const a=l/i;return B(n,l,u,f,0),s.length&&n.set(s,l+3),l+=i,B(n,l,u,f,1),s.length&&n.set(s,l+3),l+=i,B(n,l,u,f,2),s.length&&n.set(s,l+3),l+=i,B(n,l,u,f,3),s.length&&n.set(s,l+3),l+=i,r[c++]=a,r[c++]=a+1,r[c++]=a+3,r[c++]=a+1,r[c++]=a+2,r[c++]=a+3,P.vertexPosition=l,P.indexPosition=c,P}function R(t,e,n,r,x,o,i,u,f,s,l){const c=10+u.length,a=o.length/c,h=[t[e+0],t[e+1]],y=[t[n],t[n+1]],p=t[e+2],v=t[n+2],g=I(f,[...h]),b=I(f,[...y]);function M(t,e,n){const r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),x=[(e[0]-t[0])/r,(e[1]-t[1])/r],o=[-x[1],x[0]],i=Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])),u=[(n[0]-t[0])/i,(n[1]-t[1])/i],f=0===r||0===i?0:Math.acos((s=u[0]*x[0]+u[1]*x[1],l=-1,c=1,Math.min(Math.max(s,l),c)));var s,l,c;return u[0]*o[0]+u[1]*o[1]>0?f:2*Math.PI-f}let m=-1,Z=-1,d=l;const w=null!==x;if(null!==r){m=M(g,b,I(f,[...[t[r],t[r+1]]])),Math.cos(m)<=.985&&(d+=Math.tan((m-Math.PI)/2))}if(w){Z=M(b,g,I(f,[...[t[x],t[x+1]]])),Math.cos(Z)<=.985&&(d+=Math.tan((Math.PI-Z)/2))}function A(t,e){return 0===e?1e4*t:Math.sign(e)*(1e4*t+Math.abs(e))}return o.push(h[0],h[1],p,y[0],y[1],v,m,Z,s,A(0,l)),o.push(...u),o.push(h[0],h[1],p,y[0],y[1],v,m,Z,s,A(1,l)),o.push(...u),o.push(h[0],h[1],p,y[0],y[1],v,m,Z,s,A(2,l)),o.push(...u),o.push(h[0],h[1],p,y[0],y[1],v,m,Z,s,A(3,l)),o.push(...u),i.push(a,a+1,a+2,a+1,a+3,a+2),{length:s+Math.sqrt((b[0]-g[0])*(b[0]-g[0])+(b[1]-g[1])*(b[1]-g[1])),angle:d}}function S(e,n,r,x,o){const i=2+o;let u=n;const f=e.slice(u,u+o);u+=o;const s=e[u++];let l=0;const c=new Array(s-1);for(let t=0;t<s;t++)l+=e[u++],t<s-1&&(c[t]=l);const a=e.slice(u,u+2*l),h=t(a,c,2);for(let t=0;t<h.length;t++)x.push(h[t]+r.length/i);for(let t=0;t<a.length;t+=2)r.push(a[t],a[t+1],...f);return u+2*l}const T="GENERATE_POLYGON_BUFFERS",_="GENERATE_POINT_BUFFERS",O="GENERATE_LINE_STRING_BUFFERS",U=self;U.onmessage=t=>{const e=t.data;switch(e.type){case _:{const t=3,n=2,r=e.customAttributesSize,x=n+r,o=new Float32Array(e.renderInstructions),i=o.length/x,u=4*i*(r+t),f=new Uint32Array(6*i),s=new Float32Array(u);let l;for(let t=0;t<o.length;t+=x)l=N(o,t,s,f,r,l);const c=Object.assign({vertexBuffer:s.buffer,indexBuffer:f.buffer,renderInstructions:o.buffer},e);U.postMessage(c,[s.buffer,f.buffer,o.buffer]);break}case O:{const t=[],n=[],r=e.customAttributesSize,x=3,o=new Float32Array(e.renderInstructions);let i=0;const u=[1,0,0,1,0,0];let f,s;for(z(u,e.renderInstructionsTransform);i<o.length;){s=Array.from(o.slice(i,i+r)),i+=r,f=o[i++];const e=i,l=i+(f-1)*x,c=o[e]===o[l]&&o[e+1]===o[l+1];let a=0,h=0;for(let r=0;r<f-1;r++){let y=null;r>0?y=i+(r-1)*x:c&&(y=l-x);let p=null;r<f-2?p=i+(r+2)*x:c&&(p=e+x);const v=R(o,i+r*x,i+(r+1)*x,y,p,t,n,s,u,a,h);a=v.length,h=v.angle}i+=f*x}const l=Uint32Array.from(n),c=Float32Array.from(t),a=Object.assign({vertexBuffer:c.buffer,indexBuffer:l.buffer,renderInstructions:o.buffer},e);U.postMessage(a,[c.buffer,l.buffer,o.buffer]);break}case T:{const t=[],n=[],r=e.customAttributesSize,x=new Float32Array(e.renderInstructions);let o=0;for(;o<x.length;)o=S(x,o,t,n,r);const i=Uint32Array.from(n),u=Float32Array.from(t),f=Object.assign({vertexBuffer:u.buffer,indexBuffer:i.buffer,renderInstructions:x.buffer},e);U.postMessage(f,[u.buffer,i.buffer,x.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+Buffer.from(n,"binary").toString("base64"):URL.createObjectURL(new Blob([n],{type:"application/javascript"})))}const Ah={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"};function m1(n,e){e=e||[];const t=256,i=t-1;return e[0]=Math.floor(n/t/t/t)/i,e[1]=Math.floor(n/t/t)%t/i,e[2]=Math.floor(n/t)%t/i,e[3]=n%t/i,e}function _1(n){let e=0;const t=256,i=t-1;return e+=Math.round(n[0]*t*t*t*i),e+=Math.round(n[1]*t*t*i),e+=Math.round(n[2]*t*i),e+=Math.round(n[3]*i),e}function Lh(n,e,t,i){let r=0;for(const s in e){const o=e[s],a=o.callback.call(t,t.feature);let l=(a==null?void 0:a[0])??a;l===Ch&&console.warn('The "has" operator might return false positives.'),l===void 0?l=Ch:l===null&&(l=0),n[i+r++]=l,!(!o.size||o.size===1)&&(n[i+r++]=a[1],!(o.size<3)&&(n[i+r++]=a[2],!(o.size<4)&&(n[i+r++]=a[3])))}return r}function Da(n){return Object.keys(n).reduce((e,t)=>e+(n[t].size||1),0)}function p1(n,e,t,i){const r=(2+Da(t))*n.geometriesCount;(!e||e.length!==r)&&(e=new Float32Array(r));const s=[];let o=0;for(const a in n.entries){const l=n.entries[a];for(let c=0,h=l.flatCoordss.length;c<h;c++)s[0]=l.flatCoordss[c][0],s[1]=l.flatCoordss[c][1],Ne(i,s),e[o++]=s[0],e[o++]=s[1],o+=Lh(e,t,l,o)}return e}function y1(n,e,t,i){const r=3*n.verticesCount+(1+Da(t))*n.geometriesCount;(!e||e.length!==r)&&(e=new Float32Array(r));const s=[];let o=0;for(const a in n.entries){const l=n.entries[a];for(let c=0,h=l.flatCoordss.length;c<h;c++){s.length=l.flatCoordss[c].length,gn(l.flatCoordss[c],0,s.length,3,i,s,3),o+=Lh(e,t,l,o),e[o++]=s.length/3;for(let u=0,d=s.length;u<d;u+=3)e[o++]=s[u],e[o++]=s[u+1],e[o++]=s[u+2]}}return e}function x1(n,e,t,i){const r=2*n.verticesCount+(1+Da(t))*n.geometriesCount+n.ringsCount;(!e||e.length!==r)&&(e=new Float32Array(r));const s=[];let o=0;for(const a in n.entries){const l=n.entries[a];for(let c=0,h=l.flatCoordss.length;c<h;c++){s.length=l.flatCoordss[c].length,gn(l.flatCoordss[c],0,s.length,2,i,s),o+=Lh(e,t,l,o),e[o++]=l.ringsVerticesCounts[c].length;for(let u=0,d=l.ringsVerticesCounts[c].length;u<d;u++)e[o++]=l.ringsVerticesCounts[c][u];for(let u=0,d=s.length;u<d;u+=2)e[o++]=s[u],e[o++]=s[u+1]}}return e}function Fa(n){return(JSON.stringify(n).split("").reduce((t,i)=>(t<<5)-t+i.charCodeAt(0),0)>>>0).toString()}function Mh(n,e,t,i){if(`${i}radius`in n&&i!=="icon-"){let r=ne(t,n[`${i}radius`],$);if(`${i}radius2`in n){const s=ne(t,n[`${i}radius2`],$);r=`max(${r}, ${s})`}`${i}stroke-width`in n&&(r=`(${r} + ${ne(t,n[`${i}stroke-width`],$)} * 0.5)`),e.setSymbolSizeExpression(`vec2(${r} * 2. + 0.5)`)}if(`${i}scale`in n){const r=ne(t,n[`${i}scale`],zt);e.setSymbolSizeExpression(`${e.getSymbolSizeExpression()} * ${r}`)}`${i}displacement`in n&&e.setSymbolOffsetExpression(ne(t,n[`${i}displacement`],Rt)),`${i}rotation`in n&&e.setSymbolRotationExpression(ne(t,n[`${i}rotation`],$)),`${i}rotate-with-view`in n&&e.setSymbolRotateWithView(!!n[`${i}rotate-with-view`])}function qg(n,e,t,i,r){let s="vec4(0.)";if(e!==null&&(s=e),t!==null&&i!==null){const l=`smoothstep(-${i} + 0.63, -${i} - 0.58, ${n})`;s=`mix(${t}, ${s}, ${l})`}const o=`(1.0 - smoothstep(-0.63, 0.58, ${n}))`;let a=`${s} * vec4(1.0, 1.0, 1.0, ${o})`;return r!==null&&(a=`${a} * vec4(1.0, 1.0, 1.0, ${r})`),a}function Oh(n,e,t,i,r){const s=new Image;s.crossOrigin=n[`${i}cross-origin`]===void 0?"anonymous":n[`${i}cross-origin`],fe(typeof n[`${i}src`]=="string",`WebGL layers do not support expressions for the ${i}src style property`),s.src=n[`${i}src`],t[`u_texture${r}_size`]=()=>s.complete?[s.width,s.height]:[0,0],e.addUniform(`u_texture${r}_size`,"vec2");const o=`u_texture${r}_size`;return t[`u_texture${r}`]=s,e.addUniform(`u_texture${r}`,"sampler2D"),o}function Dh(n,e,t,i,r){let s=ne(t,n[`${e}offset`],zt);if(`${e}offset-origin`in n)switch(n[`${e}offset-origin`]){case"top-right":s=`vec2(${i}.x, 0.) + ${r} * vec2(-1., 0.) + ${s} * vec2(-1., 1.)`;break;case"bottom-left":s=`vec2(0., ${i}.y) + ${r} * vec2(0., -1.) + ${s} * vec2(1., -1.)`;break;case"bottom-right":s=`${i} - ${r} - ${s}`;break}return s}function v1(n,e,t,i){i.functions.circleDistanceField=`float circleDistanceField(vec2 point, float radius) {
  return length(point) - radius;
}`,Mh(n,e,i,"circle-");let r=null;"circle-opacity"in n&&(r=ne(i,n["circle-opacity"],$));let s="coordsPx";"circle-scale"in n&&(s=`coordsPx / ${ne(i,n["circle-scale"],zt)}`);let o=null;"circle-fill-color"in n&&(o=ne(i,n["circle-fill-color"],Oe));let a=null;"circle-stroke-color"in n&&(a=ne(i,n["circle-stroke-color"],Oe));let l=ne(i,n["circle-radius"],$),c=null;"circle-stroke-width"in n&&(c=ne(i,n["circle-stroke-width"],$),l=`(${l} + ${c} * 0.5)`);const h=`circleDistanceField(${s}, ${l})`,u=qg(h,o,a,c,r);e.setSymbolColorExpression(u)}function E1(n,e,t,i){i.functions.round=`float round(float v) {
  return sign(v) * floor(abs(v) + 0.5);
}`,i.functions.starDistanceField=`float starDistanceField(vec2 point, float numPoints, float radius, float radius2, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round(beta / alpha) * alpha; // angle in sector
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  vec2 tipToPoint = inSector + vec2(-radius, 0.);
  vec2 edgeNormal = vec2(radius2 * sin(alpha * 0.5), -radius2 * cos(alpha * 0.5) + radius);
  return dot(normalize(edgeNormal), tipToPoint);
}`,i.functions.regularDistanceField=`float regularDistanceField(vec2 point, float numPoints, float radius, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float radiusIn = radius * cos(PI / numPoints);
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round((beta - alpha * 0.5) / alpha) * alpha + alpha * 0.5; // angle in sector from mid
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  return inSector.x - radiusIn;
}`,Mh(n,e,i,"shape-");let r=null;"shape-opacity"in n&&(r=ne(i,n["shape-opacity"],$));let s="coordsPx";"shape-scale"in n&&(s=`coordsPx / ${ne(i,n["shape-scale"],zt)}`);let o=null;"shape-fill-color"in n&&(o=ne(i,n["shape-fill-color"],Oe));let a=null;"shape-stroke-color"in n&&(a=ne(i,n["shape-stroke-color"],Oe));let l=null;"shape-stroke-width"in n&&(l=ne(i,n["shape-stroke-width"],$));const c=ne(i,n["shape-points"],$);let h="0.";"shape-angle"in n&&(h=ne(i,n["shape-angle"],$));let u,d=ne(i,n["shape-radius"],$);if(l!==null&&(d=`${d} + ${l} * 0.5`),"shape-radius2"in n){let g=ne(i,n["shape-radius2"],$);l!==null&&(g=`${g} + ${l} * 0.5`),u=`starDistanceField(${s}, ${c}, ${d}, ${g}, ${h})`}else u=`regularDistanceField(${s}, ${c}, ${d}, ${h})`;const f=qg(u,o,a,l,r);e.setSymbolColorExpression(f)}function T1(n,e,t,i){let r="vec4(1.0)";"icon-color"in n&&(r=ne(i,n["icon-color"],Oe)),"icon-opacity"in n&&(r=`${r} * vec4(1.0, 1.0, 1.0, ${ne(i,n["icon-opacity"],$)})`);const s=Fa(n["icon-src"]),o=Oh(n,e,t,"icon-",s);if(e.setSymbolColorExpression(`${r} * texture2D(u_texture${s}, v_texCoord)`).setSymbolSizeExpression(o),"icon-width"in n&&"icon-height"in n&&e.setSymbolSizeExpression(`vec2(${ne(i,n["icon-width"],$)}, ${ne(i,n["icon-height"],$)})`),"icon-offset"in n&&"icon-size"in n){const a=ne(i,n["icon-size"],Rt),l=e.getSymbolSizeExpression();e.setSymbolSizeExpression(a);const c=Dh(n,"icon-",i,"v_quadSizePx",a);e.setTextureCoordinateExpression(`(vec4((${c}).xyxy) + vec4(0., 0., ${a})) / (${l}).xyxy`)}if(Mh(n,e,i,"icon-"),"icon-anchor"in n){const a=ne(i,n["icon-anchor"],Rt);let l="1.0";"icon-scale"in n&&(l=ne(i,n["icon-scale"],zt));let c;n["icon-anchor-x-units"]==="pixels"&&n["icon-anchor-y-units"]==="pixels"?c=`${a} * ${l}`:n["icon-anchor-x-units"]==="pixels"?c=`${a} * vec2(vec2(${l}).x, v_quadSizePx.y)`:n["icon-anchor-y-units"]==="pixels"?c=`${a} * vec2(v_quadSizePx.x, vec2(${l}).x)`:c=`${a} * v_quadSizePx`;let h=`v_quadSizePx * vec2(0.5, -0.5) + ${c} * vec2(-1., 1.)`;if("icon-anchor-origin"in n)switch(n["icon-anchor-origin"]){case"top-right":h=`v_quadSizePx * -0.5 + ${c}`;break;case"bottom-left":h=`v_quadSizePx * 0.5 - ${c}`;break;case"bottom-right":h=`v_quadSizePx * vec2(-0.5, 0.5) + ${c} * vec2(1., -1.)`;break}e.setSymbolOffsetExpression(`${e.getSymbolOffsetExpression()} + ${h}`)}}function w1(n,e,t,i){if("stroke-color"in n&&e.setStrokeColorExpression(ne(i,n["stroke-color"],Oe)),"stroke-pattern-src"in n){const r=Fa(n["stroke-pattern-src"]),s=Oh(n,e,t,"stroke-pattern-",r);let o=s,a="vec2(0.)";"stroke-pattern-offset"in n&&"stroke-pattern-size"in n&&(o=ne(i,n["stroke-pattern-size"],Rt),a=Dh(n,"stroke-pattern-",i,s,o));let l="0.";"stroke-pattern-spacing"in n&&(l=ne(i,n["stroke-pattern-spacing"],$)),i.functions.sampleStrokePattern=`vec4 sampleStrokePattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, float spacingPx, float currentLengthPx, float currentRadiusRatio, float lineWidth) {
  float currentLengthScaled = currentLengthPx * sampleSize.y / lineWidth;
  float spacingScaled = spacingPx * sampleSize.y / lineWidth;
  float uCoordPx = mod(currentLengthScaled, (sampleSize.x + spacingScaled));
  // make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  uCoordPx = clamp(uCoordPx, 0.5, sampleSize.x - 0.5);
  float vCoordPx = (-currentRadiusRatio * 0.5 + 0.5) * sampleSize.y;
  vec2 texCoord = (vec2(uCoordPx, vCoordPx) + textureOffset) / textureSize;
  return texture2D(texture, texCoord);
}`;const c=`u_texture${r}`;let h="1.";"stroke-color"in n&&(h=e.getStrokeColorExpression()),e.setStrokeColorExpression(`${h} * sampleStrokePattern(${c}, ${s}, ${a}, ${o}, ${l}, currentLengthPx, currentRadiusRatio, v_width)`)}if("stroke-width"in n&&e.setStrokeWidthExpression(ne(i,n["stroke-width"],$)),"stroke-offset"in n&&e.setStrokeOffsetExpression(ne(i,n["stroke-offset"],$)),"stroke-line-cap"in n&&e.setStrokeCapExpression(ne(i,n["stroke-line-cap"],He)),"stroke-line-join"in n&&e.setStrokeJoinExpression(ne(i,n["stroke-line-join"],He)),"stroke-miter-limit"in n&&e.setStrokeMiterLimitExpression(ne(i,n["stroke-miter-limit"],$)),"stroke-line-dash"in n){i.functions.getSingleDashDistance=`float getSingleDashDistance(float distance, float radius, float dashOffset, float dashLength, float dashLengthTotal, float capType, float lineWidth) {
  float localDistance = mod(distance, dashLengthTotal);
  float distanceSegment = abs(localDistance - dashOffset - dashLength * 0.5) - dashLength * 0.5;
  distanceSegment = min(distanceSegment, dashLengthTotal - localDistance);
  if (capType == ${$n("square")}) {
    distanceSegment -= lineWidth * 0.5;
  } else if (capType == ${$n("round")}) {
    distanceSegment = min(distanceSegment, sqrt(distanceSegment * distanceSegment + radius * radius) - lineWidth * 0.5);
  }
  return distanceSegment;
}`;let r=n["stroke-line-dash"].map(f=>ne(i,f,$));r.length%2===1&&(r=[...r,...r]);let s="0.";"stroke-line-dash-offset"in n&&(s=ne(i,n["stroke-line-dash-offset"],$));const a=`dashDistanceField_${Fa(n["stroke-line-dash"])}`,l=r.map((f,g)=>`float dashLength${g}`).join(", "),c=r.map((f,g)=>`dashLength${g}`).join(" + ");let h="0.",u=`getSingleDashDistance(distance, radius, ${h}, dashLength0, totalDashLength, capType, lineWidth)`;for(let f=2;f<r.length;f+=2)h=`${h} + dashLength${f-2} + dashLength${f-1}`,u=`min(${u}, getSingleDashDistance(distance, radius, ${h}, dashLength${f}, totalDashLength, capType, lineWidth))`;i.functions[a]=`float ${a}(float distance, float radius, float capType, float lineWidth, ${l}) {
  float totalDashLength = ${c};
  return ${u};
}`;const d=r.map((f,g)=>`${f}`).join(", ");e.setStrokeDistanceFieldExpression(`${a}(currentLengthPx + ${s}, currentRadiusPx, capType, v_width, ${d})`)}}function S1(n,e,t,i){if("fill-color"in n&&e.setFillColorExpression(ne(i,n["fill-color"],Oe)),"fill-pattern-src"in n){const r=Fa(n["fill-pattern-src"]),s=Oh(n,e,t,"fill-pattern-",r);let o=s,a="vec2(0.)";"fill-pattern-offset"in n&&"fill-pattern-size"in n&&(o=ne(i,n["fill-pattern-size"],Rt),a=Dh(n,"fill-pattern-",i,s,o)),i.functions.sampleFillPattern=`vec4 sampleFillPattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, vec2 pxOrigin, vec2 pxPosition) {
  float scaleRatio = pow(2., mod(u_zoom + 0.5, 1.) - 0.5);
  vec2 pxRelativePos = pxPosition - pxOrigin;
  // rotate the relative position from origin by the current view rotation
  pxRelativePos = vec2(pxRelativePos.x * cos(u_rotation) - pxRelativePos.y * sin(u_rotation), pxRelativePos.x * sin(u_rotation) + pxRelativePos.y * cos(u_rotation));
  // sample position is computed according to the sample offset & size
  vec2 samplePos = mod(pxRelativePos / scaleRatio, sampleSize);
  // also make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  samplePos = clamp(samplePos, vec2(0.5), sampleSize - vec2(0.5));
  samplePos.y = sampleSize.y - samplePos.y; // invert y axis so that images appear upright
  return texture2D(texture, (samplePos + textureOffset) / textureSize);
}`;const l=`u_texture${r}`;let c="1.";"fill-color"in n&&(c=e.getFillColorExpression()),e.setFillColorExpression(`${c} * sampleFillPattern(${l}, ${s}, ${a}, ${o}, pxOrigin, pxPos)`)}}function b1(n,e,t){const i=Yg(),r=new Xg,s={};if("icon-src"in n?T1(n,r,s,i):"shape-points"in n?E1(n,r,s,i):"circle-radius"in n&&v1(n,r,s,i),w1(n,r,s,i),S1(n,r,s,i),t){const l=ne(i,t,Xe);r.setFragmentDiscardExpression(`!${l}`)}const o={};function a(l,c,h,u){if(!i[l])return;const d=Ih(h),f=Ph(h);r.addAttribute(`a_${c}`,d),o[c]={size:f,callback:u}}return a("geometryType",jg,He,l=>qs(pa(l.getGeometry()))),a("featureId",$g,He|$,l=>{const c=l.getId()??null;return typeof c=="string"?qs(c):c}),Hg(r,i),{builder:r,attributes:{...o,...Zg(i)},uniforms:{...s,...Kg(i,e)}}}function C1(n){const e=Array.isArray(n)?n:[n];if("style"in e[0]){const t=[],i=e,r=[];for(const s of i){const o=Array.isArray(s.style)?s.style:[s.style];let a=s.filter;s.else&&r.length&&(a=["all",...r.map(c=>["!",c])],s.filter&&a.push(s.filter),a.length<3&&(a=a[1])),s.filter&&r.push(s.filter);const l=o.map(c=>({style:c,...a&&{filter:a}}));t.push(...l)}return t}return"builder"in e[0]?e:e.map(t=>({style:t}))}const R1=[];let Fh;function P1(){return Fh||(Fh=g1()),Fh}let I1=0;const xn={POSITION:"a_position",INDEX:"a_index",SEGMENT_START:"a_segmentStart",SEGMENT_END:"a_segmentEnd",MEASURE_START:"a_measureStart",MEASURE_END:"a_measureEnd",PARAMETERS:"a_parameters",JOIN_ANGLES:"a_joinAngles",DISTANCE:"a_distance"};class A1{constructor(e,t,i,r,s){this.helper_,this.hitDetectionEnabled_=!!r;let o=e;if(!("builder"in e)){const h=e,u=b1(h.style,t,h.filter);o={builder:u.builder,attributes:u.attributes,uniforms:u.uniforms}}this.fillProgram_,this.strokeProgram_,this.symbolProgram_,this.hasFill_=!!o.builder.getFillVertexShader(),this.hasFill_&&(this.fillVertexShader_=o.builder.getFillVertexShader(),this.fillFragmentShader_=o.builder.getFillFragmentShader()),this.hasStroke_=!!o.builder.getStrokeVertexShader(),this.hasStroke_&&(this.strokeVertexShader_=o.builder.getStrokeVertexShader(),this.strokeFragmentShader_=o.builder.getStrokeFragmentShader()),this.hasSymbol_=!!o.builder.getSymbolVertexShader(),this.hasSymbol_&&(this.symbolVertexShader_=o.builder.getSymbolVertexShader(),this.symbolFragmentShader_=o.builder.getSymbolFragmentShader()),this.featureFilter_=null,s&&(this.featureFilter_=this.computeFeatureFilter(s));const l=this.hitDetectionEnabled_?{hitColor:{callback(){return m1(this.ref,R1)},size:4}}:{};this.customAttributes_=Object.assign({},l,o.attributes),this.uniforms_=o.uniforms;const c=Object.entries(this.customAttributes_).map(([h,u])=>({name:`a_${h}`,size:u.size||1,type:pt.FLOAT}));this.polygonAttributesDesc_=[{name:xn.POSITION,size:2,type:pt.FLOAT},...c],this.lineStringAttributesDesc_=[{name:xn.SEGMENT_START,size:2,type:pt.FLOAT},{name:xn.MEASURE_START,size:1,type:pt.FLOAT},{name:xn.SEGMENT_END,size:2,type:pt.FLOAT},{name:xn.MEASURE_END,size:1,type:pt.FLOAT},{name:xn.JOIN_ANGLES,size:2,type:pt.FLOAT},{name:xn.DISTANCE,size:1,type:pt.FLOAT},{name:xn.PARAMETERS,size:1,type:pt.FLOAT},...c],this.pointAttributesDesc_=[{name:xn.POSITION,size:2,type:pt.FLOAT},{name:xn.INDEX,size:1,type:pt.FLOAT},...c],this.setHelper(i)}computeFeatureFilter(e){const t=_a();let i;try{i=pn(e,Xe,t)}catch{return null}if(t.mapState||t.variables.size>0)return null;const r=Dc();return s=>{if(r.properties=s.getPropertiesInternal(),t.featureId){const o=s.getId();o!==void 0?r.featureId=o:r.featureId=null}return r.geometryType=pa(s.getGeometry()),i(r)}}async generateBuffers(e,t){let i=e;if(this.featureFilter_&&(i=i.filter(this.featureFilter_),i.isEmpty()))return null;const r=this.generateRenderInstructions_(i,t),[s,o,a]=await Promise.all([this.generateBuffersForType_(r.polygonInstructions,"Polygon",t),this.generateBuffersForType_(r.lineStringInstructions,"LineString",t),this.generateBuffersForType_(r.pointInstructions,"Point",t)]),l=xs(Ve(),t);return{polygonBuffers:s,lineStringBuffers:o,pointBuffers:a,invertVerticesTransform:l}}generateRenderInstructions_(e,t){const i=this.hasFill_?x1(e.polygonBatch,new Float32Array(0),this.customAttributes_,t):null,r=this.hasStroke_?y1(e.lineStringBatch,new Float32Array(0),this.customAttributes_,t):null,s=this.hasSymbol_?p1(e.pointBatch,new Float32Array(0),this.customAttributes_,t):null;return{polygonInstructions:i,lineStringInstructions:r,pointInstructions:s}}generateBuffersForType_(e,t,i){if(e===null)return null;const r=I1++;let s;switch(t){case"Polygon":s=Ah.GENERATE_POLYGON_BUFFERS;break;case"LineString":s=Ah.GENERATE_LINE_STRING_BUFFERS;break;case"Point":s=Ah.GENERATE_POINT_BUFFERS;break}const o={id:r,type:s,renderInstructions:e.buffer,renderInstructionsTransform:i,customAttributesSize:Da(this.customAttributes_)},a=P1();return a.postMessage(o,[e.buffer]),e=null,new Promise(l=>{const c=h=>{const u=h.data;if(u.id!==r||(a.removeEventListener("message",c),!this.helper_.getGL()))return;const d=new Gg(yh,Fg).fromArrayBuffer(u.vertexBuffer),f=new Gg(xh,Fg).fromArrayBuffer(u.indexBuffer);this.helper_.flushBufferData(d),this.helper_.flushBufferData(f),l([f,d])};a.addEventListener("message",c)})}render(e,t,i){this.hasFill_&&this.renderInternal_(e.polygonBuffers[0],e.polygonBuffers[1],this.fillProgram_,this.polygonAttributesDesc_,t,i),this.hasStroke_&&this.renderInternal_(e.lineStringBuffers[0],e.lineStringBuffers[1],this.strokeProgram_,this.lineStringAttributesDesc_,t,i),this.hasSymbol_&&this.renderInternal_(e.pointBuffers[0],e.pointBuffers[1],this.symbolProgram_,this.pointAttributesDesc_,t,i)}renderInternal_(e,t,i,r,s,o){const a=e.getSize();a!==0&&(this.helper_.useProgram(i,s),this.helper_.bindBuffer(t),this.helper_.bindBuffer(e),this.helper_.enableAttributes(r),o(),this.helper_.drawElements(0,a))}setHelper(e,t=null){this.helper_=e,this.hasFill_&&(this.fillProgram_=this.helper_.getProgram(this.fillFragmentShader_,this.fillVertexShader_)),this.hasStroke_&&(this.strokeProgram_=this.helper_.getProgram(this.strokeFragmentShader_,this.strokeVertexShader_)),this.hasSymbol_&&(this.symbolProgram_=this.helper_.getProgram(this.symbolFragmentShader_,this.symbolVertexShader_)),this.helper_.addUniforms(this.uniforms_),t&&(t.polygonBuffers&&(this.helper_.flushBufferData(t.polygonBuffers[0]),this.helper_.flushBufferData(t.polygonBuffers[1])),t.lineStringBuffers&&(this.helper_.flushBufferData(t.lineStringBuffers[0]),this.helper_.flushBufferData(t.lineStringBuffers[1])),t.pointBuffers&&(this.helper_.flushBufferData(t.pointBuffers[0]),this.helper_.flushBufferData(t.pointBuffers[1])))}}const vn=new Uint8Array(4);class L1{constructor(e,t){this.helper_=e;const i=e.getGL();this.texture_=i.createTexture(),this.framebuffer_=i.createFramebuffer(),this.depthbuffer_=i.createRenderbuffer(),this.size_=t||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(e){An(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const e=this.size_,t=this.helper_.getGL();t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.readPixels(0,0,e[0],e[1],t.RGBA,t.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(e,t){if(e<0||t<0||e>this.size_[0]||t>=this.size_[1])return vn[0]=0,vn[1]=0,vn[2]=0,vn[3]=0,vn;this.readAll();const i=Math.floor(e)+(this.size_[1]-Math.floor(t)-1)*this.size_[0];return vn[0]=this.data_[i*4],vn[1]=this.data_[i*4+1],vn[2]=this.data_[i*4+2],vn[3]=this.data_[i*4+3],vn}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}getDepthbuffer(){return this.depthbuffer_}updateSize_(){const e=this.size_,t=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.viewport(0,0,e[0],e[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture_,0),t.bindRenderbuffer(t.RENDERBUFFER,this.depthbuffer_),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,e[0],e[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthbuffer_),this.data_=new Uint8Array(e[0]*e[1]*4)}}function M1(n,e){const t=n.viewState.projection,r=e.getSource().getWrapX()&&t.canWrapX(),s=t.getExtent(),o=n.extent,a=r?xe(s):null,l=r?Math.ceil((o[2]-s[2])/a)+1:1;return[r?Math.floor((o[0]-s[0])/a):0,l,a]}const Wr={...Yn,RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",GLOBAL_ALPHA:"u_globalAlpha"};class O1 extends vh{constructor(e,t){const i={[Wr.RENDER_EXTENT]:[0,0,0,0],[Wr.PATTERN_ORIGIN]:[0,0],[Wr.GLOBAL_ALPHA]:1};super(e,{uniforms:i,postProcesses:t.postProcesses}),this.hitDetectionEnabled_=!t.disableHitDetection,this.hitRenderTarget_,this.sourceRevision_=-1,this.previousExtent_=ft(),this.currentTransform_=Ve(),this.tmpCoords_=[0,0],this.tmpTransform_=Ve(),this.tmpMat4_=Ag(),this.currentFrameStateTransform_=Ve(),this.styleVariables_={},this.styles_=[],this.styleRenderers_=[],this.buffers_=[],this.applyOptions_(t),this.batch_=new Oa,this.initialFeaturesAdded_=!1,this.sourceListenKeys_=null}addInitialFeatures_(e){const t=this.getLayer().getSource();let i;this.batch_.addFeatures(t.getFeatures(),i),this.sourceListenKeys_=[he(t,ot.ADDFEATURE,this.handleSourceFeatureAdded_.bind(this,i)),he(t,ot.CHANGEFEATURE,this.handleSourceFeatureChanged_.bind(this,i),this),he(t,ot.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),he(t,ot.CLEAR,this.handleSourceFeatureClear_,this)]}applyOptions_(e){this.styleVariables_=e.variables,this.styles_=C1(e.style)}createRenderers_(){this.buffers_=[],this.styleRenderers_=this.styles_.map(e=>new A1(e,this.styleVariables_,this.helper,this.hitDetectionEnabled_,"filter"in e?e.filter:null))}reset(e){this.applyOptions_(e),this.helper&&this.createRenderers_(),super.reset(e)}afterHelperCreated(){this.styleRenderers_.length?this.styleRenderers_.forEach((e,t)=>e.setHelper(this.helper,this.buffers_[t])):this.createRenderers_(),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new L1(this.helper))}handleSourceFeatureAdded_(e,t){const i=t.feature;this.batch_.addFeature(i,e)}handleSourceFeatureChanged_(e,t){const i=t.feature;this.batch_.changeFeature(i,e)}handleSourceFeatureDelete_(e){const t=e.feature;this.batch_.removeFeature(t)}handleSourceFeatureClear_(){this.batch_.clear()}applyUniforms_(e){kd(this.tmpTransform_,this.currentFrameStateTransform_),Kl(this.tmpTransform_,e),this.helper.setUniformMatrixValue(Wr.PROJECTION_MATRIX,fh(this.tmpMat4_,this.tmpTransform_)),xs(this.tmpTransform_,this.tmpTransform_),this.helper.setUniformMatrixValue(Wr.SCREEN_TO_WORLD_MATRIX,fh(this.tmpMat4_,this.tmpTransform_)),this.tmpCoords_[0]=0,this.tmpCoords_[1]=0,xs(this.tmpTransform_,e),Ne(this.tmpTransform_,this.tmpCoords_),this.helper.setUniformFloatVec2(Wr.PATTERN_ORIGIN,this.tmpCoords_)}renderFrame(e){const t=this.helper.getGL();this.preRender(t,e);const[i,r,s]=M1(e,this.getLayer());this.helper.prepareDraw(e),this.renderWorlds(e,!1,i,r,s),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const o=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderWorlds(e,!0,i,r,s),this.hitRenderTarget_.clearCachedData()),this.postRender(t,e),o}prepareFrameInternal(e){this.initialFeaturesAdded_||(this.addInitialFeatures_(e),this.initialFeaturesAdded_=!0);const t=this.getLayer(),i=t.getSource(),r=e.viewState,s=!e.viewHints[Qe.ANIMATING]&&!e.viewHints[Qe.INTERACTING],o=!_r(this.previousExtent_,e.extent),a=this.sourceRevision_<i.getRevision();if(a&&(this.sourceRevision_=i.getRevision()),s&&(o||a)){const l=r.projection,c=r.resolution,h=t instanceof wa?t.getRenderBuffer():0,u=Mn(e.extent,h*c);i.loadFeatures(u,c,l),this.ready=!1;const d=this.helper.makeProjectionTransform(e,Ve()),f=this.styleRenderers_.map((g,_)=>g.generateBuffers(this.batch_,d).then(m=>{this.buffers_[_]&&this.disposeBuffers(this.buffers_[_]),this.buffers_[_]=m}));Promise.all(f).then(()=>{this.ready=!0,this.getLayer().changed()}),this.previousExtent_=e.extent.slice()}return!0}renderWorlds(e,t,i,r,s){let o=i;t&&(this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0));do{this.helper.makeProjectionTransform(e,this.currentFrameStateTransform_),Dy(this.currentFrameStateTransform_,o*s,0);for(let a=0,l=this.styleRenderers_.length;a<l;a++){const c=this.styleRenderers_[a],h=this.buffers_[a];h&&c.render(h,e,()=>{this.applyUniforms_(h.invertVerticesTransform),this.helper.applyHitDetectionUniform(t)})}}while(++o<r)}forEachFeatureAtCoordinate(e,t,i,r,s){if(fe(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),!this.styleRenderers_.length||!this.hitDetectionEnabled_)return;const o=Ne(t.coordinateToPixelTransform,e.slice()),a=this.hitRenderTarget_.readPixel(o[0]/2,o[1]/2),l=[a[0]/255,a[1]/255,a[2]/255,a[3]/255],c=_1(l),h=this.batch_.getFeatureFromRef(c);if(h)return r(h,this.getLayer(),null)}disposeBuffers(e){const t=i=>{for(const r of i)r&&this.helper.deleteBuffer(r)};e.pointBuffers&&t(e.pointBuffers),e.lineStringBuffers&&t(e.lineStringBuffers),e.polygonBuffers&&t(e.polygonBuffers)}disposeInternal(){this.buffers_.forEach(e=>{e&&this.disposeBuffers(e)}),this.sourceListenKeys_&&(this.sourceListenKeys_.forEach(function(e){be(e)}),this.sourceListenKeys_=null),super.disposeInternal()}renderDeclutter(){}}const jn={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},D1=["#00f","#0ff","#0f0","#ff0","#f00"];class F1 extends wa{constructor(e){e=e||{};const t=Object.assign({},e);delete t.gradient,delete t.radius,delete t.blur,delete t.weight,super(t),this.filter_=e.filter??!0,this.styleVariables_=e.variables||{},this.gradient_=null,this.addChangeListener(jn.GRADIENT,this.handleGradientChanged_),this.setGradient(e.gradient?e.gradient:D1),this.setBlur(e.blur!==void 0?e.blur:15),this.setRadius(e.radius!==void 0?e.radius:8);const i=e.weight?e.weight:"weight";this.weight_=i,this.setRenderOrder(null)}getBlur(){return this.get(jn.BLUR)}getGradient(){return this.get(jn.GRADIENT)}getRadius(){return this.get(jn.RADIUS)}handleGradientChanged_(){this.gradient_=k1(this.getGradient())}setBlur(e){const t=this.get(jn.BLUR);if(this.set(jn.BLUR,e),typeof e=="number"&&typeof t=="number"){this.changed();return}this.clearRenderer()}setGradient(e){this.set(jn.GRADIENT,e)}setRadius(e){const t=this.get(jn.RADIUS);if(this.set(jn.RADIUS,e),typeof e=="number"&&typeof t=="number"){this.changed();return}this.clearRenderer()}setFilter(e){this.filter_=e,this.changed(),this.clearRenderer()}setWeight(e){this.weight_=e,this.changed(),this.clearRenderer()}createRenderer(){const e=new Xg,t=Yg(),i=ne(t,this.filter_,Xe);let r=ne(t,this.getRadius(),$),s=ne(t,this.getBlur(),$);const o={};typeof this.getBlur()=="number"&&(s="a_blur",o.a_blur=()=>this.getBlur(),e.addUniform("a_blur","float")),typeof this.getRadius()=="number"&&(r="a_radius",o.a_radius=()=>this.getRadius(),e.addUniform("a_radius","float"));const a={};let l=null;if(typeof this.weight_=="string"||typeof this.weight_=="function"){const u=typeof this.weight_=="string"?d=>d.get(this.weight_):this.weight_;a.prop_weight={size:1,callback:d=>{const f=u(d);return f!==void 0?Me(f,0,1):1}},l="a_prop_weight",e.addAttribute("a_prop_weight","float")}else{const u=["clamp",this.weight_,0,1];l=ne(t,u,$)}e.addFragmentShaderFunction(`float getBlurSlope() {
  float blur = max(1., ${s});
  float radius = ${r};
  return radius / blur;
}`).setSymbolSizeExpression(`vec2(${r} + ${s}) * 2.`).setSymbolColorExpression(`vec4(smoothstep(0., 1., (1. - length(coordsPx * 2. / v_quadSizePx)) * getBlurSlope()) * ${l})`).setStrokeColorExpression(`vec4(smoothstep(0., 1., (1. - length(currentRadiusPx * 2. / v_width)) * getBlurSlope()) * ${l})`).setStrokeWidthExpression(`(${r} + ${s}) * 2.`).setFillColorExpression(`vec4(${l})`).setFragmentDiscardExpression(`!${i}`),Hg(e,t);const c=Zg(t),h=Kg(t,this.styleVariables_);return new O1(this,{className:this.getClassName(),variables:this.styleVariables_,style:{builder:e,attributes:{...c,...a},uniforms:{...h,...o}},disableHitDetection:!1,postProcesses:[{fragmentShader:`
            precision mediump float;

            uniform sampler2D u_image;
            uniform sampler2D u_gradientTexture;
            uniform float u_opacity;

            varying vec2 v_texCoord;

            void main() {
              vec4 color = texture2D(u_image, v_texCoord);
              gl_FragColor.a = color.a * u_opacity;
              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;
              gl_FragColor.rgb *= gl_FragColor.a;
            }`,uniforms:{u_gradientTexture:()=>this.gradient_,u_opacity:()=>this.getOpacity()}}]})}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}renderDeclutter(){}}function k1(n){const i=ze(1,256),r=i.createLinearGradient(0,0,1,256),s=1/(n.length-1);for(let o=0,a=n.length;o<a;++o)r.addColorStop(o*s,n[o]);return i.fillStyle=r,i.fillRect(0,0,1,256),i.canvas}class N1{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=hi,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let i=t.dataProjection?Pe(t.dataProjection):this.readProjection(e);t.extent&&i&&i.getUnits()==="tile-pixels"&&(i=Pe(i),i.setWorldExtent(t.extent)),t={dataProjection:i,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return Q()}readFeature(e,t){return Q()}readFeatures(e,t){return Q()}readGeometry(e,t){return Q()}readProjection(e){return Q()}writeFeature(e,t){return Q()}writeFeatures(e,t){return Q()}writeGeometry(e,t){return Q()}}function kh(n,e,t){const i=t?Pe(t.featureProjection):null,r=t?Pe(t.dataProjection):null;let s=n;if(i&&r&&!Xo(i,r)){e&&(s=n.clone());const o=e?i:r,a=e?r:i;o.getUnits()==="tile-pixels"?s.transform(o,a):s.applyTransform(Tr(o,a))}if(e&&t&&t.decimals!==void 0){const o=Math.pow(10,t.decimals),a=function(l){for(let c=0,h=l.length;c<h;++c)l[c]=Math.round(l[c]*o)/o;return l};s===n&&(s=n.clone()),s.applyTransform(a)}return s}const G1={Point:Jt,LineString:wr,Polygon:gi,MultiPoint:aa,MultiLineString:oa,MultiPolygon:la};function U1(n,e,t){return Array.isArray(e[0])?(qd(n,0,e,t)||(n=n.slice(),oc(n,0,e,t)),n):(sc(n,0,e,t)||(n=n.slice(),Jo(n,0,e,t)),n)}function Jg(n,e){var s;const t=n.geometry;if(!t)return[];if(Array.isArray(t))return t.map(o=>Jg({...n,geometry:o})).flat();const i=t.type==="MultiPolygon"?"Polygon":t.type;if(i==="GeometryCollection"||i==="Circle")throw new Error("Unsupported geometry type: "+i);const r=t.layout.length;return kh(new Ct(i,i==="Polygon"?U1(t.flatCoordinates,t.ends,r):t.flatCoordinates,(s=t.ends)==null?void 0:s.flat(),r,n.properties||{},n.id).enableSimplifyTransformed(),!1,e)}function Nh(n,e){if(!n)return null;if(Array.isArray(n)){const i=n.map(r=>Nh(r,e));return new sa(i)}const t=G1[n.type];return kh(new t(n.flatCoordinates,n.layout||"XY",n.ends),!1,e)}class B1 extends N1{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(ka(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(ka(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return Q()}readFeaturesFromObject(e,t){return Q()}readGeometry(e,t){return this.readGeometryFromObject(ka(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return Q()}readProjection(e){return this.readProjectionFromObject(ka(e))}readProjectionFromObject(e){return Q()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return Q()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return Q()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return Q()}}function ka(n){if(typeof n=="string"){const e=JSON.parse(n);return e||null}return n!==null?n:null}class z1 extends B1{constructor(e){e=e||{},super(),this.dataProjection=Pe(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=Pe(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let i=null;e.type==="Feature"?i=e:i={type:"Feature",geometry:e,properties:null};const r=Gh(i.geometry);if(this.featureClass===Ct)return Jg({geometry:r,id:i.id,properties:i.properties},t);const s=new hi;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&i.geometry_name&&s.setGeometryName(i.geometry_name),s.setGeometry(Nh(r,t)),"id"in i&&s.setId(i.id),i.properties&&s.setProperties(i.properties,!0),s}readFeaturesFromObject(e,t){const i=e;let r=null;if(i.type==="FeatureCollection"){const s=e;r=[];const o=s.features;for(let a=0,l=o.length;a<l;++a){const c=this.readFeatureFromObject(o[a],t);c&&r.push(c)}}else r=[this.readFeatureFromObject(e,t)];return r.flat()}readGeometryFromObject(e,t){return W1(e,t)}readProjectionFromObject(e){const t=e.crs;let i;if(t)if(t.type=="name")i=Pe(t.properties.name);else if(t.type==="EPSG")i=Pe("EPSG:"+t.properties.code);else throw new Error("Unknown SRS type");else i=this.dataProjection;return i}writeFeatureObject(e,t){t=this.adaptOptions(t);const i={type:"Feature",geometry:null,properties:null},r=e.getId();if(r!==void 0&&(i.id=r),!e.hasProperties())return i;const s=e.getProperties(),o=e.getGeometry();return o&&(i.geometry=Uh(o,t),delete s[e.getGeometryName()]),Li(s)||(i.properties=s),i}writeFeaturesObject(e,t){t=this.adaptOptions(t);const i=[];for(let r=0,s=e.length;r<s;++r)i.push(this.writeFeatureObject(e[r],t));return{type:"FeatureCollection",features:i}}writeGeometryObject(e,t){return Uh(e,this.adaptOptions(t))}}function Gh(n,e){if(!n)return null;let t;switch(n.type){case"Point":{t=$1(n);break}case"LineString":{t=j1(n);break}case"Polygon":{t=K1(n);break}case"MultiPoint":{t=X1(n);break}case"MultiLineString":{t=V1(n);break}case"MultiPolygon":{t=H1(n);break}case"GeometryCollection":{t=Y1(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return t}function W1(n,e){const t=Gh(n);return Nh(t,e)}function Y1(n,e){return n.geometries.map(function(i){return Gh(i)})}function $1(n){const e=n.coordinates;return{type:"Point",flatCoordinates:e,layout:Bi(e.length)}}function j1(n){var i;const e=n.coordinates,t=e.flat();return{type:"LineString",flatCoordinates:t,ends:[t.length],layout:Bi(((i=e[0])==null?void 0:i.length)||2)}}function V1(n){var s,o;const e=n.coordinates,t=((o=(s=e[0])==null?void 0:s[0])==null?void 0:o.length)||2,i=[],r=vs(i,0,e,t);return{type:"MultiLineString",flatCoordinates:i,ends:r,layout:Bi(t)}}function X1(n){var t;const e=n.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:Bi(((t=e[0])==null?void 0:t.length)||2)}}function H1(n){var s,o;const e=n.coordinates,t=[],i=((o=(s=e[0])==null?void 0:s[0])==null?void 0:o[0].length)||2,r=jd(t,0,e,i);return{type:"MultiPolygon",flatCoordinates:t,ends:r,layout:Bi(i)}}function K1(n){var s,o;const e=n.coordinates,t=[],i=(o=(s=e[0])==null?void 0:s[0])==null?void 0:o.length,r=vs(t,0,e,i);return{type:"Polygon",flatCoordinates:t,ends:r,layout:Bi(i)}}function Uh(n,e){n=kh(n,!0,e);const t=n.getType();let i;switch(t){case"Point":{i=tT(n);break}case"LineString":{i=q1(n);break}case"Polygon":{i=nT(n,e);break}case"MultiPoint":{i=Q1(n);break}case"MultiLineString":{i=J1(n);break}case"MultiPolygon":{i=eT(n,e);break}case"GeometryCollection":{i=Z1(n,e);break}case"Circle":{i={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return i}function Z1(n,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(i){return Uh(i,e)})}}function q1(n,e){return{type:"LineString",coordinates:n.getCoordinates()}}function J1(n,e){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function Q1(n,e){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function eT(n,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(t)}}function tT(n,e){return{type:"Point",coordinates:n.getCoordinates()}}function nT(n,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(t)}}var Qg={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},em=I.createContext&&I.createContext(Qg),iT=["attr","size","title"];function rT(n,e){if(n==null)return{};var t=sT(n,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}function sT(n,e){if(n==null)return{};var t={};for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){if(e.indexOf(i)>=0)continue;t[i]=n[i]}return t}function Na(){return Na=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Na.apply(this,arguments)}function tm(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Ga(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?tm(Object(t),!0).forEach(function(i){oT(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):tm(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function oT(n,e,t){return e=aT(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function aT(n){var e=lT(n,"string");return typeof e=="symbol"?e:e+""}function lT(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function nm(n){return n&&n.map((e,t)=>I.createElement(e.tag,Ga({key:t},e.attr),nm(e.child)))}function Js(n){return e=>I.createElement(cT,Na({attr:Ga({},n.attr)},e),nm(n.child))}function cT(n){var e=t=>{var{attr:i,size:r,title:s}=n,o=rT(n,iT),a=r||t.size||"1em",l;return t.className&&(l=t.className),n.className&&(l=(l?l+" ":"")+n.className),I.createElement("svg",Na({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,i,o,{className:l,style:Ga(Ga({color:n.color||t.color},t.style),n.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),s&&I.createElement("title",null,s),n.children)};return em!==void 0?I.createElement(em.Consumer,null,t=>e(t)):e(Qg)}function hT(n){return Js({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"},child:[]}]})(n)}function uT(n){return Js({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"m289.94 256 95-95A24 24 0 0 0 351 127l-95 95-95-95a24 24 0 0 0-34 34l95 95-95 95a24 24 0 1 0 34 34l95-95 95 95a24 24 0 0 0 34-34z"},child:[]}]})(n)}class im extends Error{constructor(t,i,r){const s=t.status||t.status===0?t.status:"",o=t.statusText||"",a=`${s} ${o}`.trim(),l=a?`status code ${a}`:"an unknown error";super(`Request failed with ${l}: ${i.method} ${i.url}`);un(this,"response");un(this,"request");un(this,"options");this.name="HTTPError",this.response=t,this.request=i,this.options=r}}class rm extends Error{constructor(t){super(`Request timed out: ${t.method} ${t.url}`);un(this,"request");this.name="TimeoutError",this.request=t}}const sm=(()=>{let n=!1,e=!1;const t=typeof globalThis.ReadableStream=="function",i=typeof globalThis.Request=="function";if(t&&i)try{e=new globalThis.Request("https://empty.invalid",{body:new globalThis.ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type")}catch(r){if(r instanceof Error&&r.message==="unsupported BodyInit type")return!1;throw r}return n&&!e})(),dT=typeof globalThis.AbortController=="function",fT=typeof globalThis.AbortSignal=="function"&&typeof globalThis.AbortSignal.any=="function",gT=typeof globalThis.ReadableStream=="function",mT=typeof globalThis.FormData=="function",om=["get","post","put","patch","head","delete"],_T={json:"application/json",text:"text/*",formData:"multipart/form-data",arrayBuffer:"*/*",blob:"*/*"},Bh=2147483647,pT=new TextEncoder().encode("------WebKitFormBoundaryaxpyiPgbbPti10Rw").length,am=Symbol("stop"),yT={json:!0,parseJson:!0,stringifyJson:!0,searchParams:!0,prefixUrl:!0,retry:!0,timeout:!0,hooks:!0,throwHttpErrors:!0,onDownloadProgress:!0,onUploadProgress:!0,fetch:!0},xT={method:!0,headers:!0,body:!0,mode:!0,credentials:!0,cache:!0,redirect:!0,referrer:!0,referrerPolicy:!0,integrity:!0,keepalive:!0,signal:!0,window:!0,dispatcher:!0,duplex:!0,priority:!0},vT=n=>{if(!n)return 0;if(n instanceof FormData){let e=0;for(const[t,i]of n)e+=pT,e+=new TextEncoder().encode(`Content-Disposition: form-data; name="${t}"`).length,e+=typeof i=="string"?new TextEncoder().encode(i).length:i.size;return e}if(n instanceof Blob)return n.size;if(n instanceof ArrayBuffer)return n.byteLength;if(typeof n=="string")return new TextEncoder().encode(n).length;if(n instanceof URLSearchParams)return new TextEncoder().encode(n.toString()).length;if("byteLength"in n)return n.byteLength;if(typeof n=="object"&&n!==null)try{const e=JSON.stringify(n);return new TextEncoder().encode(e).length}catch{return 0}return 0},ET=(n,e)=>{const t=Number(n.headers.get("content-length"))||0;let i=0;return n.status===204?(e&&e({percent:1,totalBytes:t,transferredBytes:i},new Uint8Array),new Response(null,{status:n.status,statusText:n.statusText,headers:n.headers})):new Response(new ReadableStream({async start(r){const s=n.body.getReader();e&&e({percent:0,transferredBytes:0,totalBytes:t},new Uint8Array);async function o(){const{done:a,value:l}=await s.read();if(a){r.close();return}if(e){i+=l.byteLength;const c=t===0?0:i/t;e({percent:c,transferredBytes:i,totalBytes:t},l)}r.enqueue(l),await o()}await o()}}),{status:n.status,statusText:n.statusText,headers:n.headers})},TT=(n,e)=>{const t=vT(n.body);let i=0;return new Request(n,{duplex:"half",body:new ReadableStream({async start(r){const s=n.body instanceof ReadableStream?n.body.getReader():new Response("").body.getReader();async function o(){const{done:a,value:l}=await s.read();if(a){e&&e({percent:1,transferredBytes:i,totalBytes:Math.max(t,i)},new Uint8Array),r.close();return}i+=l.byteLength;let c=t===0?0:i/t;(t<i||c===1)&&(c=.99),e&&e({percent:Number(c.toFixed(2)),transferredBytes:i,totalBytes:t},l),r.enqueue(l),await o()}await o()}})})},Qs=n=>n!==null&&typeof n=="object",Ua=(...n)=>{for(const e of n)if((!Qs(e)||Array.isArray(e))&&e!==void 0)throw new TypeError("The `options` argument must be an object");return zh({},...n)},lm=(n={},e={})=>{const t=new globalThis.Headers(n),i=e instanceof globalThis.Headers,r=new globalThis.Headers(e);for(const[s,o]of r.entries())i&&o==="undefined"||o===void 0?t.delete(s):t.set(s,o);return t};function Ba(n,e,t){return Object.hasOwn(e,t)&&e[t]===void 0?[]:zh(n[t]??[],e[t]??[])}const cm=(n={},e={})=>({beforeRequest:Ba(n,e,"beforeRequest"),beforeRetry:Ba(n,e,"beforeRetry"),afterResponse:Ba(n,e,"afterResponse"),beforeError:Ba(n,e,"beforeError")}),zh=(...n)=>{let e={},t={},i={};for(const r of n)if(Array.isArray(r))Array.isArray(e)||(e=[]),e=[...e,...r];else if(Qs(r)){for(let[s,o]of Object.entries(r))Qs(o)&&s in e&&(o=zh(e[s],o)),e={...e,[s]:o};Qs(r.hooks)&&(i=cm(i,r.hooks),e.hooks=i),Qs(r.headers)&&(t=lm(t,r.headers),e.headers=t)}return e},wT=n=>om.includes(n)?n.toUpperCase():n,hm={limit:2,methods:["get","put","head","delete","options","trace"],statusCodes:[408,413,429,500,502,503,504],afterStatusCodes:[413,429,503],maxRetryAfter:Number.POSITIVE_INFINITY,backoffLimit:Number.POSITIVE_INFINITY,delay:n=>.3*2**(n-1)*1e3},ST=(n={})=>{if(typeof n=="number")return{...hm,limit:n};if(n.methods&&!Array.isArray(n.methods))throw new Error("retry.methods must be an array");if(n.statusCodes&&!Array.isArray(n.statusCodes))throw new Error("retry.statusCodes must be an array");return{...hm,...n}};async function bT(n,e,t,i){return new Promise((r,s)=>{const o=setTimeout(()=>{t&&t.abort(),s(new rm(n))},i.timeout);i.fetch(n,e).then(r).catch(s).then(()=>{clearTimeout(o)})})}async function CT(n,{signal:e}){return new Promise((t,i)=>{e&&(e.throwIfAborted(),e.addEventListener("abort",r,{once:!0}));function r(){clearTimeout(s),i(e.reason)}const s=setTimeout(()=>{e==null||e.removeEventListener("abort",r),t()},n)})}const RT=(n,e)=>{const t={};for(const i in e)!(i in xT)&&!(i in yT)&&!(i in n)&&(t[i]=e[i]);return t};class za{constructor(e,t={}){un(this,"request");un(this,"abortController");un(this,"_retryCount",0);un(this,"_input");un(this,"_options");var i,r;if(this._input=e,this._options={...t,headers:lm(this._input.headers,t.headers),hooks:cm({beforeRequest:[],beforeRetry:[],beforeError:[],afterResponse:[]},t.hooks),method:wT(t.method??this._input.method??"GET"),prefixUrl:String(t.prefixUrl||""),retry:ST(t.retry),throwHttpErrors:t.throwHttpErrors!==!1,timeout:t.timeout??1e4,fetch:t.fetch??globalThis.fetch.bind(globalThis)},typeof this._input!="string"&&!(this._input instanceof URL||this._input instanceof globalThis.Request))throw new TypeError("`input` must be a string, URL, or Request");if(this._options.prefixUrl&&typeof this._input=="string"){if(this._input.startsWith("/"))throw new Error("`input` must not begin with a slash when using `prefixUrl`");this._options.prefixUrl.endsWith("/")||(this._options.prefixUrl+="/"),this._input=this._options.prefixUrl+this._input}if(dT&&fT){const s=this._options.signal??this._input.signal;this.abortController=new globalThis.AbortController,this._options.signal=s?AbortSignal.any([s,this.abortController.signal]):this.abortController.signal}if(sm&&(this._options.duplex="half"),this._options.json!==void 0&&(this._options.body=((r=(i=this._options).stringifyJson)==null?void 0:r.call(i,this._options.json))??JSON.stringify(this._options.json),this._options.headers.set("content-type",this._options.headers.get("content-type")??"application/json")),this.request=new globalThis.Request(this._input,this._options),this._options.searchParams){const o="?"+(typeof this._options.searchParams=="string"?this._options.searchParams.replace(/^\?/,""):new URLSearchParams(this._options.searchParams).toString()),a=this.request.url.replace(/(?:\?.*?)?(?=#|$)/,o);(mT&&this._options.body instanceof globalThis.FormData||this._options.body instanceof URLSearchParams)&&!(this._options.headers&&this._options.headers["content-type"])&&this.request.headers.delete("content-type"),this.request=new globalThis.Request(new globalThis.Request(a,{...this.request}),this._options)}if(this._options.onUploadProgress){if(typeof this._options.onUploadProgress!="function")throw new TypeError("The `onUploadProgress` option must be a function");if(!sm)throw new Error("Request streams are not supported in your environment. The `duplex` option for `Request` is not available.");this.request.body&&(this.request=TT(this.request,this._options.onUploadProgress))}}static create(e,t){const i=new za(e,t),r=async()=>{if(typeof i._options.timeout=="number"&&i._options.timeout>Bh)throw new RangeError(`The \`timeout\` option cannot be greater than ${Bh}`);await Promise.resolve();let a=await i._fetch();for(const l of i._options.hooks.afterResponse){const c=await l(i.request,i._options,i._decorateResponse(a.clone()));c instanceof globalThis.Response&&(a=c)}if(i._decorateResponse(a),!a.ok&&i._options.throwHttpErrors){let l=new im(a,i.request,i._options);for(const c of i._options.hooks.beforeError)l=await c(l);throw l}if(i._options.onDownloadProgress){if(typeof i._options.onDownloadProgress!="function")throw new TypeError("The `onDownloadProgress` option must be a function");if(!gT)throw new Error("Streams are not supported in your environment. `ReadableStream` is missing.");return ET(a.clone(),i._options.onDownloadProgress)}return a},o=(i._options.retry.methods.includes(i.request.method.toLowerCase())?i._retry(r):r()).finally(async()=>{var a;i.request.bodyUsed||await((a=i.request.body)==null?void 0:a.cancel())});for(const[a,l]of Object.entries(_T))o[a]=async()=>{i.request.headers.set("accept",i.request.headers.get("accept")||l);const c=await o;if(a==="json"){if(c.status===204||(await c.clone().arrayBuffer()).byteLength===0)return"";if(t.parseJson)return t.parseJson(await c.text())}return c[a]()};return o}_calculateRetryDelay(e){if(this._retryCount++,this._retryCount>this._options.retry.limit||e instanceof rm)throw e;if(e instanceof im){if(!this._options.retry.statusCodes.includes(e.response.status))throw e;const i=e.response.headers.get("Retry-After")??e.response.headers.get("RateLimit-Reset")??e.response.headers.get("X-RateLimit-Reset")??e.response.headers.get("X-Rate-Limit-Reset");if(i&&this._options.retry.afterStatusCodes.includes(e.response.status)){let r=Number(i)*1e3;Number.isNaN(r)?r=Date.parse(i)-Date.now():r>=Date.parse("2024-01-01")&&(r-=Date.now());const s=this._options.retry.maxRetryAfter??r;return r<s?r:s}if(e.response.status===413)throw e}const t=this._options.retry.delay(this._retryCount);return Math.min(this._options.retry.backoffLimit,t)}_decorateResponse(e){return this._options.parseJson&&(e.json=async()=>this._options.parseJson(await e.text())),e}async _retry(e){try{return await e()}catch(t){const i=Math.min(this._calculateRetryDelay(t),Bh);if(this._retryCount<1)throw t;await CT(i,{signal:this._options.signal});for(const r of this._options.hooks.beforeRetry)if(await r({request:this.request,options:this._options,error:t,retryCount:this._retryCount})===am)return;return this._retry(e)}}async _fetch(){for(const i of this._options.hooks.beforeRequest){const r=await i(this.request,this._options);if(r instanceof Request){this.request=r;break}if(r instanceof Response)return r}const e=RT(this.request,this._options),t=this.request;return this.request=t.clone(),this._options.timeout===!1?this._options.fetch(t,e):bT(t,e,this.abortController,this._options)}}/*! MIT License © Sindre Sorhus */const Wh=n=>{const e=(t,i)=>za.create(t,Ua(n,i));for(const t of om)e[t]=(i,r)=>za.create(i,Ua(n,r,{method:t}));return e.create=t=>Wh(Ua(t)),e.extend=t=>(typeof t=="function"&&(t=t(n??{})),Wh(Ua(n,t))),e.stop=am,e},PT=Wh(),IT=()=>{const{cookieEnabled:n,deviceMemory:e,doNotTrack:t,hardwareConcurrency:i,language:r,languages:s,maxTouchPoints:o,platform:a,userAgent:l,vendor:c}=window.navigator,{width:h,height:u,colorDepth:d,pixelDepth:f}=window.screen,g=new Date().getTimezoneOffset(),_=Intl.DateTimeFormat().resolvedOptions().timeZone,m="ontouchstart"in window,y=window.devicePixelRatio,p=AT(),E=LT(),x=MT(),v=JSON.stringify({canvas:p,colorDepth:d,cookieEnabled:n,deviceMemory:e,devicePixelRatio:y,doNotTrack:t,hardwareConcurrency:i,height:u,language:r,languages:s,maxTouchPoints:o,pixelDepth:f,platform:a,timezone:_,timezoneOffset:g,touchSupport:m,userAgent:l,vendor:c,webgl:E,webglInfo:x,width:h},null,8);return Yh(JSON.stringify(v,null,4))},AT=()=>{try{const n=document.createElement("canvas"),e=n.getContext("2d");if(!e)return null;const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ`~1!2@3#4$5%6^7&8*9(0)-_=+[{]}|;:',<.>/?";e.textBaseline="top",e.font="14px 'serif'",e.textBaseline="alphabetic",e.fillStyle="#f60",e.fillRect(125,1,62,20),e.fillStyle="#069",e.fillText(t,2,15),e.fillStyle="rgba(102, 204, 0, 0.7)",e.fillText(t,4,17);const i=n.toDataURL();return e.clearRect(0,0,n.width,n.height),Yh(i)}catch{return null}},LT=()=>{try{const n=document.createElement("canvas"),e=n.getContext("webgl");if(!e)return null;n.width=256,n.height=128;const t="attribute vec2 attrVertex;varying vec2 varyinTexCoordinate;uniform vec2 uniformOffset;void main(){varyinTexCoordinate=attrVertex+uniformOffset;gl_Position=vec4(attrVertex,0,1);}",i="precision mediump float;varying vec2 varyinTexCoordinate;void main() {gl_FragColor=vec4(varyinTexCoordinate,0,1);}",r=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,r);const s=new Float32Array([-.2,-.9,0,.4,-.26,0,0,.7321,0]);e.bufferData(e.ARRAY_BUFFER,s,e.STATIC_DRAW),r.itemSize=3,r.numItems=3;const o=e.createProgram(),a=e.createShader(e.VERTEX_SHADER);e.shaderSource(a,t),e.compileShader(a);const l=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(l,i),e.compileShader(l),e.attachShader(o,a),e.attachShader(o,l),e.linkProgram(o),e.useProgram(o),o.vertexPosAttrib=e.getAttribLocation(o,"attrVertex"),o.offsetUniform=e.getUniformLocation(o,"uniformOffset"),e.enableVertexAttribArray(o.vertexPosArray),e.vertexAttribPointer(o.vertexPosAttrib,r.itemSize,e.FLOAT,!1,0,0),e.uniform2f(o.offsetUniform,1,1),e.drawArrays(e.TRIANGLE_STRIP,0,r.numItems);const c=new Uint8Array(n.width*n.height*4);e.readPixels(0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,c);const h=JSON.stringify(c).replace(/,?"[0-9]+":/g,"");return e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT),Yh(h)}catch{return null}},MT=()=>{try{const n=document.createElement("canvas").getContext("webgl");return{VERSION:n.getParameter(n.VERSION),SHADING_LANGUAGE_VERSION:n.getParameter(n.SHADING_LANGUAGE_VERSION),VENDOR:n.getParameter(n.VENDOR),SUPORTED_EXTENSIONS:n.getSupportedExtensions()}}catch{return null}},Yh=n=>{const e=n.length&3,t=n.length-e,i=3432918353,r=461845907;let s=0,o,a;for(let c=0;c<t;c++)a=n.charCodeAt(c)&255|(n.charCodeAt(++c)&255)<<8|(n.charCodeAt(++c)&255)<<16|(n.charCodeAt(++c)&255)<<24,++c,a=(a&65535)*i+(((a>>>16)*i&65535)<<16)&4294967295,a=a<<15|a>>>17,a=(a&65535)*r+(((a>>>16)*r&65535)<<16)&4294967295,s^=a,s=s<<13|s>>>19,o=(s&65535)*5+(((s>>>16)*5&65535)<<16)&4294967295,s=(o&65535)+27492+(((o>>>16)+58964&65535)<<16);const l=t-1;switch(a=0,e){case 3:{a^=(n.charCodeAt(l+2)&255)<<16;break}case 2:{a^=(n.charCodeAt(l+1)&255)<<8;break}case 1:{a^=n.charCodeAt(l)&255;break}}return a=(a&65535)*i+(((a>>>16)*i&65535)<<16)&4294967295,a=a<<15|a>>>17,a=(a&65535)*r+(((a>>>16)*r&65535)<<16)&4294967295,s^=a,s^=n.length,s^=s>>>16,s=(s&65535)*2246822507+(((s>>>16)*2246822507&65535)<<16)&4294967295,s^=s>>>13,s=(s&65535)*3266489909+(((s>>>16)*3266489909&65535)<<16)&4294967295,s^=s>>>16,s>>>0};let $h;const um=()=>($h||($h=IT().toString()),$h);function dm(n,e){return function(){return n.apply(e,arguments)}}const{toString:OT}=Object.prototype,{getPrototypeOf:jh}=Object,{iterator:Wa,toStringTag:fm}=Symbol,Ya=(n=>e=>{const t=OT.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),nn=n=>(n=n.toLowerCase(),e=>Ya(e)===n),$a=n=>e=>typeof e===n,{isArray:Yr}=Array,eo=$a("undefined");function to(n){return n!==null&&!eo(n)&&n.constructor!==null&&!eo(n.constructor)&&It(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const gm=nn("ArrayBuffer");function DT(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&gm(n.buffer),e}const FT=$a("string"),It=$a("function"),mm=$a("number"),no=n=>n!==null&&typeof n=="object",kT=n=>n===!0||n===!1,ja=n=>{if(Ya(n)!=="object")return!1;const e=jh(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(fm in n)&&!(Wa in n)},NT=n=>{if(!no(n)||to(n))return!1;try{return Object.keys(n).length===0&&Object.getPrototypeOf(n)===Object.prototype}catch{return!1}},GT=nn("Date"),UT=nn("File"),BT=nn("Blob"),zT=nn("FileList"),WT=n=>no(n)&&It(n.pipe),YT=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||It(n.append)&&((e=Ya(n))==="formdata"||e==="object"&&It(n.toString)&&n.toString()==="[object FormData]"))},$T=nn("URLSearchParams"),[jT,VT,XT,HT]=["ReadableStream","Request","Response","Headers"].map(nn),KT=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function io(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let i,r;if(typeof n!="object"&&(n=[n]),Yr(n))for(i=0,r=n.length;i<r;i++)e.call(null,n[i],i,n);else{if(to(n))return;const s=t?Object.getOwnPropertyNames(n):Object.keys(n),o=s.length;let a;for(i=0;i<o;i++)a=s[i],e.call(null,n[a],a,n)}}function _m(n,e){if(to(n))return null;e=e.toLowerCase();const t=Object.keys(n);let i=t.length,r;for(;i-- >0;)if(r=t[i],e===r.toLowerCase())return r;return null}const er=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,pm=n=>!eo(n)&&n!==er;function Vh(){const{caseless:n}=pm(this)&&this||{},e={},t=(i,r)=>{const s=n&&_m(e,r)||r;ja(e[s])&&ja(i)?e[s]=Vh(e[s],i):ja(i)?e[s]=Vh({},i):Yr(i)?e[s]=i.slice():e[s]=i};for(let i=0,r=arguments.length;i<r;i++)arguments[i]&&io(arguments[i],t);return e}const ZT=(n,e,t,{allOwnKeys:i}={})=>(io(e,(r,s)=>{t&&It(r)?n[s]=dm(r,t):n[s]=r},{allOwnKeys:i}),n),qT=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),JT=(n,e,t,i)=>{n.prototype=Object.create(e.prototype,i),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},QT=(n,e,t,i)=>{let r,s,o;const a={};if(e=e||{},n==null)return e;do{for(r=Object.getOwnPropertyNames(n),s=r.length;s-- >0;)o=r[s],(!i||i(o,n,e))&&!a[o]&&(e[o]=n[o],a[o]=!0);n=t!==!1&&jh(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},ew=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const i=n.indexOf(e,t);return i!==-1&&i===t},tw=n=>{if(!n)return null;if(Yr(n))return n;let e=n.length;if(!mm(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},nw=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&jh(Uint8Array)),iw=(n,e)=>{const i=(n&&n[Wa]).call(n);let r;for(;(r=i.next())&&!r.done;){const s=r.value;e.call(n,s[0],s[1])}},rw=(n,e)=>{let t;const i=[];for(;(t=n.exec(e))!==null;)i.push(t);return i},sw=nn("HTMLFormElement"),ow=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,i,r){return i.toUpperCase()+r}),ym=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),aw=nn("RegExp"),xm=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),i={};io(t,(r,s)=>{let o;(o=e(r,s,n))!==!1&&(i[s]=o||r)}),Object.defineProperties(n,i)},lw=n=>{xm(n,(e,t)=>{if(It(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const i=n[t];if(It(i)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},cw=(n,e)=>{const t={},i=r=>{r.forEach(s=>{t[s]=!0})};return Yr(n)?i(n):i(String(n).split(e)),t},hw=()=>{},uw=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function dw(n){return!!(n&&It(n.append)&&n[fm]==="FormData"&&n[Wa])}const fw=n=>{const e=new Array(10),t=(i,r)=>{if(no(i)){if(e.indexOf(i)>=0)return;if(to(i))return i;if(!("toJSON"in i)){e[r]=i;const s=Yr(i)?[]:{};return io(i,(o,a)=>{const l=t(o,r+1);!eo(l)&&(s[a]=l)}),e[r]=void 0,s}}return i};return t(n,0)},gw=nn("AsyncFunction"),mw=n=>n&&(no(n)||It(n))&&It(n.then)&&It(n.catch),vm=((n,e)=>n?setImmediate:e?((t,i)=>(er.addEventListener("message",({source:r,data:s})=>{r===er&&s===t&&i.length&&i.shift()()},!1),r=>{i.push(r),er.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",It(er.postMessage)),_w=typeof queueMicrotask<"u"?queueMicrotask.bind(er):typeof process<"u"&&process.nextTick||vm,R={isArray:Yr,isArrayBuffer:gm,isBuffer:to,isFormData:YT,isArrayBufferView:DT,isString:FT,isNumber:mm,isBoolean:kT,isObject:no,isPlainObject:ja,isEmptyObject:NT,isReadableStream:jT,isRequest:VT,isResponse:XT,isHeaders:HT,isUndefined:eo,isDate:GT,isFile:UT,isBlob:BT,isRegExp:aw,isFunction:It,isStream:WT,isURLSearchParams:$T,isTypedArray:nw,isFileList:zT,forEach:io,merge:Vh,extend:ZT,trim:KT,stripBOM:qT,inherits:JT,toFlatObject:QT,kindOf:Ya,kindOfTest:nn,endsWith:ew,toArray:tw,forEachEntry:iw,matchAll:rw,isHTMLForm:sw,hasOwnProperty:ym,hasOwnProp:ym,reduceDescriptors:xm,freezeMethods:lw,toObjectSet:cw,toCamelCase:ow,noop:hw,toFiniteNumber:uw,findKey:_m,global:er,isContextDefined:pm,isSpecCompliantForm:dw,toJSONObject:fw,isAsyncFn:gw,isThenable:mw,setImmediate:vm,asap:_w,isIterable:n=>n!=null&&It(n[Wa])};function se(n,e,t,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),i&&(this.request=i),r&&(this.response=r,this.status=r.status?r.status:null)}R.inherits(se,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:R.toJSONObject(this.config),code:this.code,status:this.status}}});const Em=se.prototype,Tm={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{Tm[n]={value:n}}),Object.defineProperties(se,Tm),Object.defineProperty(Em,"isAxiosError",{value:!0}),se.from=(n,e,t,i,r,s)=>{const o=Object.create(Em);return R.toFlatObject(n,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),se.call(o,n.message,e,t,i,r),o.cause=n,o.name=n.name,s&&Object.assign(o,s),o};const pw=null;function Xh(n){return R.isPlainObject(n)||R.isArray(n)}function wm(n){return R.endsWith(n,"[]")?n.slice(0,-2):n}function Sm(n,e,t){return n?n.concat(e).map(function(r,s){return r=wm(r),!t&&s?"["+r+"]":r}).join(t?".":""):e}function yw(n){return R.isArray(n)&&!n.some(Xh)}const xw=R.toFlatObject(R,{},null,function(e){return/^is[A-Z]/.test(e)});function Va(n,e,t){if(!R.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=R.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(_,m){return!R.isUndefined(m[_])});const i=t.metaTokens,r=t.visitor||h,s=t.dots,o=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&R.isSpecCompliantForm(e);if(!R.isFunction(r))throw new TypeError("visitor must be a function");function c(g){if(g===null)return"";if(R.isDate(g))return g.toISOString();if(R.isBoolean(g))return g.toString();if(!l&&R.isBlob(g))throw new se("Blob is not supported. Use a Buffer instead.");return R.isArrayBuffer(g)||R.isTypedArray(g)?l&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function h(g,_,m){let y=g;if(g&&!m&&typeof g=="object"){if(R.endsWith(_,"{}"))_=i?_:_.slice(0,-2),g=JSON.stringify(g);else if(R.isArray(g)&&yw(g)||(R.isFileList(g)||R.endsWith(_,"[]"))&&(y=R.toArray(g)))return _=wm(_),y.forEach(function(E,x){!(R.isUndefined(E)||E===null)&&e.append(o===!0?Sm([_],x,s):o===null?_:_+"[]",c(E))}),!1}return Xh(g)?!0:(e.append(Sm(m,_,s),c(g)),!1)}const u=[],d=Object.assign(xw,{defaultVisitor:h,convertValue:c,isVisitable:Xh});function f(g,_){if(!R.isUndefined(g)){if(u.indexOf(g)!==-1)throw Error("Circular reference detected in "+_.join("."));u.push(g),R.forEach(g,function(y,p){(!(R.isUndefined(y)||y===null)&&r.call(e,y,R.isString(p)?p.trim():p,_,d))===!0&&f(y,_?_.concat(p):[p])}),u.pop()}}if(!R.isObject(n))throw new TypeError("data must be an object");return f(n),e}function bm(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(i){return e[i]})}function Hh(n,e){this._pairs=[],n&&Va(n,this,e)}const Cm=Hh.prototype;Cm.append=function(e,t){this._pairs.push([e,t])},Cm.toString=function(e){const t=e?function(i){return e.call(this,i,bm)}:bm;return this._pairs.map(function(r){return t(r[0])+"="+t(r[1])},"").join("&")};function vw(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Rm(n,e,t){if(!e)return n;const i=t&&t.encode||vw;R.isFunction(t)&&(t={serialize:t});const r=t&&t.serialize;let s;if(r?s=r(e,t):s=R.isURLSearchParams(e)?e.toString():new Hh(e,t).toString(i),s){const o=n.indexOf("#");o!==-1&&(n=n.slice(0,o)),n+=(n.indexOf("?")===-1?"?":"&")+s}return n}class Pm{constructor(){this.handlers=[]}use(e,t,i){return this.handlers.push({fulfilled:e,rejected:t,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){R.forEach(this.handlers,function(i){i!==null&&e(i)})}}const Im={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ew={isBrowser:!0,classes:{URLSearchParams:typeof URLSearchParams<"u"?URLSearchParams:Hh,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]},Kh=typeof window<"u"&&typeof document<"u",Zh=typeof navigator=="object"&&navigator||void 0,Tw=Kh&&(!Zh||["ReactNative","NativeScript","NS"].indexOf(Zh.product)<0),ww=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Sw=Kh&&window.location.href||"http://localhost",ct={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Kh,hasStandardBrowserEnv:Tw,hasStandardBrowserWebWorkerEnv:ww,navigator:Zh,origin:Sw},Symbol.toStringTag,{value:"Module"})),...Ew};function bw(n,e){return Va(n,new ct.classes.URLSearchParams,{visitor:function(t,i,r,s){return ct.isNode&&R.isBuffer(t)?(this.append(i,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...e})}function Cw(n){return R.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Rw(n){const e={},t=Object.keys(n);let i;const r=t.length;let s;for(i=0;i<r;i++)s=t[i],e[s]=n[s];return e}function Am(n){function e(t,i,r,s){let o=t[s++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=s>=t.length;return o=!o&&R.isArray(r)?r.length:o,l?(R.hasOwnProp(r,o)?r[o]=[r[o],i]:r[o]=i,!a):((!r[o]||!R.isObject(r[o]))&&(r[o]=[]),e(t,i,r[o],s)&&R.isArray(r[o])&&(r[o]=Rw(r[o])),!a)}if(R.isFormData(n)&&R.isFunction(n.entries)){const t={};return R.forEachEntry(n,(i,r)=>{e(Cw(i),r,t,0)}),t}return null}function Pw(n,e,t){if(R.isString(n))try{return(e||JSON.parse)(n),R.trim(n)}catch(i){if(i.name!=="SyntaxError")throw i}return(t||JSON.stringify)(n)}const ro={transitional:Im,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const i=t.getContentType()||"",r=i.indexOf("application/json")>-1,s=R.isObject(e);if(s&&R.isHTMLForm(e)&&(e=new FormData(e)),R.isFormData(e))return r?JSON.stringify(Am(e)):e;if(R.isArrayBuffer(e)||R.isBuffer(e)||R.isStream(e)||R.isFile(e)||R.isBlob(e)||R.isReadableStream(e))return e;if(R.isArrayBufferView(e))return e.buffer;if(R.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(i.indexOf("application/x-www-form-urlencoded")>-1)return bw(e,this.formSerializer).toString();if((a=R.isFileList(e))||i.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Va(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||r?(t.setContentType("application/json",!1),Pw(e)):e}],transformResponse:[function(e){const t=this.transitional||ro.transitional,i=t&&t.forcedJSONParsing,r=this.responseType==="json";if(R.isResponse(e)||R.isReadableStream(e))return e;if(e&&R.isString(e)&&(i&&!this.responseType||r)){const o=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?se.from(a,se.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ct.classes.FormData,Blob:ct.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};R.forEach(["delete","get","head","post","put","patch"],n=>{ro.headers[n]={}});const Iw=R.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Aw=n=>{const e={};let t,i,r;return n&&n.split(`
`).forEach(function(o){r=o.indexOf(":"),t=o.substring(0,r).trim().toLowerCase(),i=o.substring(r+1).trim(),!(!t||e[t]&&Iw[t])&&(t==="set-cookie"?e[t]?e[t].push(i):e[t]=[i]:e[t]=e[t]?e[t]+", "+i:i)}),e},Lm=Symbol("internals");function so(n){return n&&String(n).trim().toLowerCase()}function Xa(n){return n===!1||n==null?n:R.isArray(n)?n.map(Xa):String(n)}function Lw(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=t.exec(n);)e[i[1]]=i[2];return e}const Mw=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function qh(n,e,t,i,r){if(R.isFunction(i))return i.call(this,e,t);if(r&&(e=t),!!R.isString(e)){if(R.isString(i))return e.indexOf(i)!==-1;if(R.isRegExp(i))return i.test(e)}}function Ow(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,i)=>t.toUpperCase()+i)}function Dw(n,e){const t=R.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(n,i+t,{value:function(r,s,o){return this[i].call(this,e,r,s,o)},configurable:!0})})}let At=class{constructor(e){e&&this.set(e)}set(e,t,i){const r=this;function s(a,l,c){const h=so(l);if(!h)throw new Error("header name must be a non-empty string");const u=R.findKey(r,h);(!u||r[u]===void 0||c===!0||c===void 0&&r[u]!==!1)&&(r[u||l]=Xa(a))}const o=(a,l)=>R.forEach(a,(c,h)=>s(c,h,l));if(R.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(R.isString(e)&&(e=e.trim())&&!Mw(e))o(Aw(e),t);else if(R.isObject(e)&&R.isIterable(e)){let a={},l,c;for(const h of e){if(!R.isArray(h))throw TypeError("Object iterator must return a key-value pair");a[c=h[0]]=(l=a[c])?R.isArray(l)?[...l,h[1]]:[l,h[1]]:h[1]}o(a,t)}else e!=null&&s(t,e,i);return this}get(e,t){if(e=so(e),e){const i=R.findKey(this,e);if(i){const r=this[i];if(!t)return r;if(t===!0)return Lw(r);if(R.isFunction(t))return t.call(this,r,i);if(R.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=so(e),e){const i=R.findKey(this,e);return!!(i&&this[i]!==void 0&&(!t||qh(this,this[i],i,t)))}return!1}delete(e,t){const i=this;let r=!1;function s(o){if(o=so(o),o){const a=R.findKey(i,o);a&&(!t||qh(i,i[a],a,t))&&(delete i[a],r=!0)}}return R.isArray(e)?e.forEach(s):s(e),r}clear(e){const t=Object.keys(this);let i=t.length,r=!1;for(;i--;){const s=t[i];(!e||qh(this,this[s],s,e,!0))&&(delete this[s],r=!0)}return r}normalize(e){const t=this,i={};return R.forEach(this,(r,s)=>{const o=R.findKey(i,s);if(o){t[o]=Xa(r),delete t[s];return}const a=e?Ow(s):String(s).trim();a!==s&&delete t[s],t[a]=Xa(r),i[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return R.forEach(this,(i,r)=>{i!=null&&i!==!1&&(t[r]=e&&R.isArray(i)?i.join(", "):i)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const i=new this(e);return t.forEach(r=>i.set(r)),i}static accessor(e){const i=(this[Lm]=this[Lm]={accessors:{}}).accessors,r=this.prototype;function s(o){const a=so(o);i[a]||(Dw(r,o),i[a]=!0)}return R.isArray(e)?e.forEach(s):s(e),this}};At.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),R.reduceDescriptors(At.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(i){this[t]=i}}}),R.freezeMethods(At);function Jh(n,e){const t=this||ro,i=e||t,r=At.from(i.headers);let s=i.data;return R.forEach(n,function(a){s=a.call(t,s,r.normalize(),e?e.status:void 0)}),r.normalize(),s}function Mm(n){return!!(n&&n.__CANCEL__)}function $r(n,e,t){se.call(this,n??"canceled",se.ERR_CANCELED,e,t),this.name="CanceledError"}R.inherits($r,se,{__CANCEL__:!0});function Om(n,e,t){const i=t.config.validateStatus;!t.status||!i||i(t.status)?n(t):e(new se("Request failed with status code "+t.status,[se.ERR_BAD_REQUEST,se.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Fw(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function kw(n,e){n=n||10;const t=new Array(n),i=new Array(n);let r=0,s=0,o;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),h=i[s];o||(o=c),t[r]=l,i[r]=c;let u=s,d=0;for(;u!==r;)d+=t[u++],u=u%n;if(r=(r+1)%n,r===s&&(s=(s+1)%n),c-o<e)return;const f=h&&c-h;return f?Math.round(d*1e3/f):void 0}}function Nw(n,e){let t=0,i=1e3/e,r,s;const o=(c,h=Date.now())=>{t=h,r=null,s&&(clearTimeout(s),s=null),n(...c)};return[(...c)=>{const h=Date.now(),u=h-t;u>=i?o(c,h):(r=c,s||(s=setTimeout(()=>{s=null,o(r)},i-u)))},()=>r&&o(r)]}const Ha=(n,e,t=3)=>{let i=0;const r=kw(50,250);return Nw(s=>{const o=s.loaded,a=s.lengthComputable?s.total:void 0,l=o-i,c=r(l),h=o<=a;i=o;const u={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&h?(a-o)/c:void 0,event:s,lengthComputable:a!=null,[e?"download":"upload"]:!0};n(u)},t)},Dm=(n,e)=>{const t=n!=null;return[i=>e[0]({lengthComputable:t,total:n,loaded:i}),e[1]]},Fm=n=>(...e)=>R.asap(()=>n(...e)),Gw=ct.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,ct.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(ct.origin),ct.navigator&&/(msie|trident)/i.test(ct.navigator.userAgent)):()=>!0,Uw=ct.hasStandardBrowserEnv?{write(n,e,t,i,r,s){const o=[n+"="+encodeURIComponent(e)];R.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),R.isString(i)&&o.push("path="+i),R.isString(r)&&o.push("domain="+r),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Bw(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function zw(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function km(n,e,t){let i=!Bw(e);return n&&(i||t==!1)?zw(n,e):e}const Nm=n=>n instanceof At?{...n}:n;function tr(n,e){e=e||{};const t={};function i(c,h,u,d){return R.isPlainObject(c)&&R.isPlainObject(h)?R.merge.call({caseless:d},c,h):R.isPlainObject(h)?R.merge({},h):R.isArray(h)?h.slice():h}function r(c,h,u,d){if(R.isUndefined(h)){if(!R.isUndefined(c))return i(void 0,c,u,d)}else return i(c,h,u,d)}function s(c,h){if(!R.isUndefined(h))return i(void 0,h)}function o(c,h){if(R.isUndefined(h)){if(!R.isUndefined(c))return i(void 0,c)}else return i(void 0,h)}function a(c,h,u){if(u in e)return i(c,h);if(u in n)return i(void 0,c)}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,h,u)=>r(Nm(c),Nm(h),u,!0)};return R.forEach(Object.keys({...n,...e}),function(h){const u=l[h]||r,d=u(n[h],e[h],h);R.isUndefined(d)&&u!==a||(t[h]=d)}),t}const Gm=n=>{const e=tr({},n);let{data:t,withXSRFToken:i,xsrfHeaderName:r,xsrfCookieName:s,headers:o,auth:a}=e;e.headers=o=At.from(o),e.url=Rm(km(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let l;if(R.isFormData(t)){if(ct.hasStandardBrowserEnv||ct.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[c,...h]=l?l.split(";").map(u=>u.trim()).filter(Boolean):[];o.setContentType([c||"multipart/form-data",...h].join("; "))}}if(ct.hasStandardBrowserEnv&&(i&&R.isFunction(i)&&(i=i(e)),i||i!==!1&&Gw(e.url))){const c=r&&s&&Uw.read(s);c&&o.set(r,c)}return e},Ww=typeof XMLHttpRequest<"u"&&function(n){return new Promise(function(t,i){const r=Gm(n);let s=r.data;const o=At.from(r.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:c}=r,h,u,d,f,g;function _(){f&&f(),g&&g(),r.cancelToken&&r.cancelToken.unsubscribe(h),r.signal&&r.signal.removeEventListener("abort",h)}let m=new XMLHttpRequest;m.open(r.method.toUpperCase(),r.url,!0),m.timeout=r.timeout;function y(){if(!m)return;const E=At.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders()),v={data:!a||a==="text"||a==="json"?m.responseText:m.response,status:m.status,statusText:m.statusText,headers:E,config:n,request:m};Om(function(w){t(w),_()},function(w){i(w),_()},v),m=null}"onloadend"in m?m.onloadend=y:m.onreadystatechange=function(){!m||m.readyState!==4||m.status===0&&!(m.responseURL&&m.responseURL.indexOf("file:")===0)||setTimeout(y)},m.onabort=function(){m&&(i(new se("Request aborted",se.ECONNABORTED,n,m)),m=null)},m.onerror=function(){i(new se("Network Error",se.ERR_NETWORK,n,m)),m=null},m.ontimeout=function(){let x=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const v=r.transitional||Im;r.timeoutErrorMessage&&(x=r.timeoutErrorMessage),i(new se(x,v.clarifyTimeoutError?se.ETIMEDOUT:se.ECONNABORTED,n,m)),m=null},s===void 0&&o.setContentType(null),"setRequestHeader"in m&&R.forEach(o.toJSON(),function(x,v){m.setRequestHeader(v,x)}),R.isUndefined(r.withCredentials)||(m.withCredentials=!!r.withCredentials),a&&a!=="json"&&(m.responseType=r.responseType),c&&([d,g]=Ha(c,!0),m.addEventListener("progress",d)),l&&m.upload&&([u,f]=Ha(l),m.upload.addEventListener("progress",u),m.upload.addEventListener("loadend",f)),(r.cancelToken||r.signal)&&(h=E=>{m&&(i(!E||E.type?new $r(null,n,m):E),m.abort(),m=null)},r.cancelToken&&r.cancelToken.subscribe(h),r.signal&&(r.signal.aborted?h():r.signal.addEventListener("abort",h)));const p=Fw(r.url);if(p&&ct.protocols.indexOf(p)===-1){i(new se("Unsupported protocol "+p+":",se.ERR_BAD_REQUEST,n));return}m.send(s||null)})},Yw=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let i=new AbortController,r;const s=function(c){if(!r){r=!0,a();const h=c instanceof Error?c:this.reason;i.abort(h instanceof se?h:new $r(h instanceof Error?h.message:h))}};let o=e&&setTimeout(()=>{o=null,s(new se(`timeout ${e} of ms exceeded`,se.ETIMEDOUT))},e);const a=()=>{n&&(o&&clearTimeout(o),o=null,n.forEach(c=>{c.unsubscribe?c.unsubscribe(s):c.removeEventListener("abort",s)}),n=null)};n.forEach(c=>c.addEventListener("abort",s));const{signal:l}=i;return l.unsubscribe=()=>R.asap(a),l}},$w=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let i=0,r;for(;i<t;)r=i+e,yield n.slice(i,r),i=r},jw=async function*(n,e){for await(const t of Vw(n))yield*$w(t,e)},Vw=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:i}=await e.read();if(t)break;yield i}}finally{await e.cancel()}},Um=(n,e,t,i)=>{const r=jw(n,e);let s=0,o,a=l=>{o||(o=!0,i&&i(l))};return new ReadableStream({async pull(l){try{const{done:c,value:h}=await r.next();if(c){a(),l.close();return}let u=h.byteLength;if(t){let d=s+=u;t(d)}l.enqueue(new Uint8Array(h))}catch(c){throw a(c),c}},cancel(l){return a(l),r.return()}},{highWaterMark:2})},Ka=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Bm=Ka&&typeof ReadableStream=="function",Xw=Ka&&(typeof TextEncoder=="function"?(n=>e=>n.encode(e))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),zm=(n,...e)=>{try{return!!n(...e)}catch{return!1}},Hw=Bm&&zm(()=>{let n=!1;const e=new Request(ct.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!e}),Wm=64*1024,Qh=Bm&&zm(()=>R.isReadableStream(new Response("").body)),Za={stream:Qh&&(n=>n.body)};Ka&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Za[e]&&(Za[e]=R.isFunction(n[e])?t=>t[e]():(t,i)=>{throw new se(`Response type '${e}' is not supported`,se.ERR_NOT_SUPPORT,i)})})})(new Response);const Kw=async n=>{if(n==null)return 0;if(R.isBlob(n))return n.size;if(R.isSpecCompliantForm(n))return(await new Request(ct.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(R.isArrayBufferView(n)||R.isArrayBuffer(n))return n.byteLength;if(R.isURLSearchParams(n)&&(n=n+""),R.isString(n))return(await Xw(n)).byteLength},Zw=async(n,e)=>{const t=R.toFiniteNumber(n.getContentLength());return t??Kw(e)},eu={http:pw,xhr:Ww,fetch:Ka&&(async n=>{let{url:e,method:t,data:i,signal:r,cancelToken:s,timeout:o,onDownloadProgress:a,onUploadProgress:l,responseType:c,headers:h,withCredentials:u="same-origin",fetchOptions:d}=Gm(n);c=c?(c+"").toLowerCase():"text";let f=Yw([r,s&&s.toAbortSignal()],o),g;const _=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let m;try{if(l&&Hw&&t!=="get"&&t!=="head"&&(m=await Zw(h,i))!==0){let v=new Request(e,{method:"POST",body:i,duplex:"half"}),S;if(R.isFormData(i)&&(S=v.headers.get("content-type"))&&h.setContentType(S),v.body){const[w,b]=Dm(m,Ha(Fm(l)));i=Um(v.body,Wm,w,b)}}R.isString(u)||(u=u?"include":"omit");const y="credentials"in Request.prototype;g=new Request(e,{...d,signal:f,method:t.toUpperCase(),headers:h.normalize().toJSON(),body:i,duplex:"half",credentials:y?u:void 0});let p=await fetch(g,d);const E=Qh&&(c==="stream"||c==="response");if(Qh&&(a||E&&_)){const v={};["status","statusText","headers"].forEach(P=>{v[P]=p[P]});const S=R.toFiniteNumber(p.headers.get("content-length")),[w,b]=a&&Dm(S,Ha(Fm(a),!0))||[];p=new Response(Um(p.body,Wm,w,()=>{b&&b(),_&&_()}),v)}c=c||"text";let x=await Za[R.findKey(Za,c)||"text"](p,n);return!E&&_&&_(),await new Promise((v,S)=>{Om(v,S,{data:x,headers:At.from(p.headers),status:p.status,statusText:p.statusText,config:n,request:g})})}catch(y){throw _&&_(),y&&y.name==="TypeError"&&/Load failed|fetch/i.test(y.message)?Object.assign(new se("Network Error",se.ERR_NETWORK,n,g),{cause:y.cause||y}):se.from(y,y&&y.code,n,g)}})};R.forEach(eu,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const Ym=n=>`- ${n}`,qw=n=>R.isFunction(n)||n===null||n===!1,$m={getAdapter:n=>{n=R.isArray(n)?n:[n];const{length:e}=n;let t,i;const r={};for(let s=0;s<e;s++){t=n[s];let o;if(i=t,!qw(t)&&(i=eu[(o=String(t)).toLowerCase()],i===void 0))throw new se(`Unknown adapter '${o}'`);if(i)break;r[o||"#"+s]=i}if(!i){const s=Object.entries(r).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?s.length>1?`since :
`+s.map(Ym).join(`
`):" "+Ym(s[0]):"as no adapter specified";throw new se("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return i},adapters:eu};function tu(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new $r(null,n)}function jm(n){return tu(n),n.headers=At.from(n.headers),n.data=Jh.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),$m.getAdapter(n.adapter||ro.adapter)(n).then(function(i){return tu(n),i.data=Jh.call(n,n.transformResponse,i),i.headers=At.from(i.headers),i},function(i){return Mm(i)||(tu(n),i&&i.response&&(i.response.data=Jh.call(n,n.transformResponse,i.response),i.response.headers=At.from(i.response.headers))),Promise.reject(i)})}const Vm="1.11.0",qa={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{qa[n]=function(i){return typeof i===n||"a"+(e<1?"n ":" ")+n}});const Xm={};qa.transitional=function(e,t,i){function r(s,o){return"[Axios v"+Vm+"] Transitional option '"+s+"'"+o+(i?". "+i:"")}return(s,o,a)=>{if(e===!1)throw new se(r(o," has been removed"+(t?" in "+t:"")),se.ERR_DEPRECATED);return t&&!Xm[o]&&(Xm[o]=!0,console.warn(r(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(s,o,a):!0}},qa.spelling=function(e){return(t,i)=>(console.warn(`${i} is likely a misspelling of ${e}`),!0)};function Jw(n,e,t){if(typeof n!="object")throw new se("options must be an object",se.ERR_BAD_OPTION_VALUE);const i=Object.keys(n);let r=i.length;for(;r-- >0;){const s=i[r],o=e[s];if(o){const a=n[s],l=a===void 0||o(a,s,n);if(l!==!0)throw new se("option "+s+" must be "+l,se.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new se("Unknown option "+s,se.ERR_BAD_OPTION)}}const Ja={assertOptions:Jw,validators:qa},En=Ja.validators;let nr=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Pm,response:new Pm}}async request(e,t){try{return await this._request(e,t)}catch(i){if(i instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const s=r.stack?r.stack.replace(/^.+\n/,""):"";try{i.stack?s&&!String(i.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+s):i.stack=s}catch{}}throw i}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=tr(this.defaults,t);const{transitional:i,paramsSerializer:r,headers:s}=t;i!==void 0&&Ja.assertOptions(i,{silentJSONParsing:En.transitional(En.boolean),forcedJSONParsing:En.transitional(En.boolean),clarifyTimeoutError:En.transitional(En.boolean)},!1),r!=null&&(R.isFunction(r)?t.paramsSerializer={serialize:r}:Ja.assertOptions(r,{encode:En.function,serialize:En.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Ja.assertOptions(t,{baseUrl:En.spelling("baseURL"),withXsrfToken:En.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=s&&R.merge(s.common,s[t.method]);s&&R.forEach(["delete","get","head","post","put","patch","common"],g=>{delete s[g]}),t.headers=At.concat(o,s);const a=[];let l=!0;this.interceptors.request.forEach(function(_){typeof _.runWhen=="function"&&_.runWhen(t)===!1||(l=l&&_.synchronous,a.unshift(_.fulfilled,_.rejected))});const c=[];this.interceptors.response.forEach(function(_){c.push(_.fulfilled,_.rejected)});let h,u=0,d;if(!l){const g=[jm.bind(this),void 0];for(g.unshift(...a),g.push(...c),d=g.length,h=Promise.resolve(t);u<d;)h=h.then(g[u++],g[u++]);return h}d=a.length;let f=t;for(u=0;u<d;){const g=a[u++],_=a[u++];try{f=g(f)}catch(m){_.call(this,m);break}}try{h=jm.call(this,f)}catch(g){return Promise.reject(g)}for(u=0,d=c.length;u<d;)h=h.then(c[u++],c[u++]);return h}getUri(e){e=tr(this.defaults,e);const t=km(e.baseURL,e.url,e.allowAbsoluteUrls);return Rm(t,e.params,e.paramsSerializer)}};R.forEach(["delete","get","head","options"],function(e){nr.prototype[e]=function(t,i){return this.request(tr(i||{},{method:e,url:t,data:(i||{}).data}))}}),R.forEach(["post","put","patch"],function(e){function t(i){return function(s,o,a){return this.request(tr(a||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}nr.prototype[e]=t(),nr.prototype[e+"Form"]=t(!0)});let Qw=class tp{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});const i=this;this.promise.then(r=>{if(!i._listeners)return;let s=i._listeners.length;for(;s-- >0;)i._listeners[s](r);i._listeners=null}),this.promise.then=r=>{let s;const o=new Promise(a=>{i.subscribe(a),s=a}).then(r);return o.cancel=function(){i.unsubscribe(s)},o},e(function(s,o,a){i.reason||(i.reason=new $r(s,o,a),t(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=i=>{e.abort(i)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new tp(function(r){e=r}),cancel:e}}};function eS(n){return function(t){return n.apply(null,t)}}function tS(n){return R.isObject(n)&&n.isAxiosError===!0}const nu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(nu).forEach(([n,e])=>{nu[e]=n});function Hm(n){const e=new nr(n),t=dm(nr.prototype.request,e);return R.extend(t,nr.prototype,e,{allOwnKeys:!0}),R.extend(t,e,null,{allOwnKeys:!0}),t.create=function(r){return Hm(tr(n,r))},t}const Ge=Hm(ro);Ge.Axios=nr,Ge.CanceledError=$r,Ge.CancelToken=Qw,Ge.isCancel=Mm,Ge.VERSION=Vm,Ge.toFormData=Va,Ge.AxiosError=se,Ge.Cancel=Ge.CanceledError,Ge.all=function(e){return Promise.all(e)},Ge.spread=eS,Ge.isAxiosError=tS,Ge.mergeConfig=tr,Ge.AxiosHeaders=At,Ge.formToJSON=n=>Am(R.isHTMLForm(n)?new FormData(n):n),Ge.getAdapter=$m.getAdapter,Ge.HttpStatusCode=nu,Ge.default=Ge;const{Axios:dI,AxiosError:fI,CanceledError:gI,isCancel:mI,CancelToken:_I,VERSION:pI,all:yI,Cancel:xI,isAxiosError:vI,spread:EI,toFormData:TI,AxiosHeaders:wI,HttpStatusCode:SI,formToJSON:bI,getAdapter:CI,mergeConfig:RI}=Ge,nS=256,Km=new TextEncoder,iS=new TextDecoder,rS=async n=>{const e=typeof n=="string"?n:JSON.stringify(n),t=window.crypto.getRandomValues(new Uint8Array(16)),i=window.crypto.getRandomValues(new Uint8Array(16)),r=await Zm(Jm),s=await qm(r,t,["encrypt"]),o=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:i},s,Km.encode(e)),a=new Uint8Array(o),l=new Uint8Array(t.byteLength+i.byteLength+a.byteLength);return l.set(t,0),l.set(i,t.byteLength),l.set(a,t.byteLength+i.byteLength),oS(l)},sS=async n=>{const e=aS(n),t=e.slice(0,16),i=e.slice(16,32),r=e.slice(32),s=await Zm(Jm),o=await qm(s,t,["decrypt"]),a=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:i},o,r);return iS.decode(a)},oS=n=>window.btoa(Array.from(n).map(e=>String.fromCharCode(e)).join("")),aS=n=>Uint8Array.from(window.atob(n),e=>e.charCodeAt(0)),Zm=n=>window.crypto.subtle.importKey("raw",Km.encode(n),"PBKDF2",!1,["deriveKey"]),qm=(n,e,t)=>window.crypto.subtle.deriveKey({name:"PBKDF2",salt:e,iterations:179,hash:"SHA-256"},n,{name:"AES-GCM",length:nS},!1,t),Jm=String.fromCharCode(...new Uint8Array(["22","14","2s","24","2c","15","3o","16","1i","2f","1c","1k","3i","2t","3p","1h","36","1b","2a","26","12","20","37","2j","27","41","1q","1r","1i","23","21"].map(n=>parseInt(n,parseInt("11111",2)))));let Qm="http://localhost:4013/";console.warn=function(){},Qm="http://localhost:4013/";const lS={baseURL:Qm,headers:{"Content-Type":"application/json",Accept:"*/*","allow-gis":"%?Y?_TYqc2QM7^p4t#>c"}},Qa=Ge.create(lS);Qa.interceptors.request.use(async n=>{var t;n.headers["request-type"]="web";const e=localStorage.getItem("token");if(e&&(n.headers.Authorization=`Bearer ${e}`),n.headers.fp=um(),n.data&&["post","put","patch"].includes(((t=n.method)==null?void 0:t.toLowerCase())||"")){const i=await rS(n.data);n.data={data:i}}return n},n=>Promise.reject(n)),Qa.interceptors.response.use(async n=>{const e=await sS(n.data.message);return JSON.parse(e)},n=>{var e,t,i,r;return console.error("API Response Error:",(t=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:t.error,"Oops, the server encountered an error. Please try again later"),Promise.reject(((r=(i=n==null?void 0:n.response)==null?void 0:i.data)==null?void 0:r.error)||(n==null?void 0:n.message)||"Unknown error occurred")});const cS=async()=>{const n=localStorage.getItem("token"),e=localStorage.getItem("isProduction");let t={fp:um()};return e&&(t={...t,Authorization:`Bearer ${n||""}`}),e||(t={...t,"allow-gis":"%?Y?_TYqc2QM7^p4t#>c"}),t},iu=async(n,e)=>PT.get(n,{headers:await cS()}),hS=(n,e)=>Qa.post(`${n}gis/intersected-sdtv`,e),uS=(n,e)=>Qa.post(`${n}birthRegi/getBirthCountForCluster`,e),e_=n=>{let e;const t=new Set,i=(c,h)=>{const u=typeof c=="function"?c(e):c;if(!Object.is(u,e)){const d=e;e=h??(typeof u!="object"||u===null)?u:Object.assign({},e,u),t.forEach(f=>f(e,d))}},r=()=>e,a={setState:i,getState:r,getInitialState:()=>l,subscribe:c=>(t.add(c),()=>t.delete(c))},l=e=n(i,r,a);return a},dS=n=>n?e_(n):e_,fS=n=>n;function gS(n,e=fS){const t=I.useSyncExternalStore(n.subscribe,I.useCallback(()=>e(n.getState()),[n,e]),I.useCallback(()=>e(n.getInitialState()),[n,e]));return I.useDebugValue(t),t}const mS=n=>{const e=dS(n),t=i=>gS(e,i);return Object.assign(t,e),t},_S=n=>mS,pS=n=>{let e=n;e.use={};for(let t of Object.keys(e.getState()))e.use[t]=()=>e(i=>i[t]);return e};var yS=class extends St{constructor(e){super(e),this._listener=[],e&&e.active===!1?this.set("active",!1):this.set("active",!0)}setActive(e){this.set("active",e===!0)}getActive(){return this.get("active")}};(function(){function n(s){this.get("active")&&s.context&&this.precompose(s)}function e(s){this.get("active")&&s.context&&this.postcompose(s)}function t(){if(this.renderSync)try{this.renderSync()}catch{}else this.changed()}function i(s){this.filters_||(this.filters_=[]),this.filters_.push(s),s.addToLayer&&s.addToLayer(this),s.precompose&&s._listener.push({listener:this.on(["precompose","prerender"],n.bind(s)),target:this}),s.postcompose&&s._listener.push({listener:this.on(["postcompose","postrender"],e.bind(s)),target:this}),s._listener.push({listener:s.on("propertychange",t.bind(this)),target:this}),t.call(this)}function r(s){var o;if(this.filters_||(this.filters_=[]),!s){this.filters_.forEach((function(a){this.removeFilter(a)}).bind(this));return}for(o=this.filters_.length-1;o>=0;o--)this.filters_[o]===s&&this.filters_.splice(o,1);for(o=s._listener.length-1;o>=0;o--)s._listener[o].target===this&&(s.removeFromLayer&&s.removeFromLayer(this),ci(s._listener[o].listener),s._listener.splice(o,1));t.call(this)}Qi.prototype.addFilter=function(s){console.warn("[OL-EXT] addFilter deprecated on map."),i.call(this,s)},Qi.prototype.removeFilter=function(s){r.call(this,s)},Qi.prototype.getFilters=function(){return this.filters_||[]},Dr.prototype.addFilter=function(s){i.call(this,s)},Dr.prototype.removeFilter=function(s){r.call(this,s)},Dr.prototype.getFilters=function(){return this.filters_||[]}})();var xS=class extends yS{constructor(e){if(e=e||{},super(e),e.feature)switch(e.feature.getGeometry().getType()){case"Polygon":case"MultiPolygon":this.feature_=e.feature;break}this.set("inner",e.inner),this._fillColor=e.fill&&Fn(e.fill.getColor())||"rgba(0,0,0,0.2)",this._shadowColor=e.shadowColor&&Fn(e.shadowColor)||"rgba(0,0,0,0.5)",this.set("shadowWidth",e.shadowWidth||0),this.set("shadowMapUnits",e.shadowMapUnits===!0)}setFillColor(e){this._fillColor=e&&Fn(e)||"rgba(0,0,0,0.2)"}setShadowColor(e){this._shadowColor=e&&Fn(e)||"rgba(0,0,0,0.5)"}drawFeaturePath_(e,t){var i=e.context,r=i.canvas,s=e.frameState.pixelRatio,o;if(e.frameState.coordinateToPixelTransform){var a=e.frameState.coordinateToPixelTransform;if(e.inversePixelTransform){var l=e.inversePixelTransform;o=function(E){return E=[E[0]*a[0]+E[1]*a[1]+a[4],E[0]*a[2]+E[1]*a[3]+a[5]],[E[0]*l[0]-E[1]*l[1]+l[4],-E[0]*l[2]+E[1]*l[3]+l[5]]}}else o=function(E){return[(E[0]*a[0]+E[1]*a[1]+a[4])*s,(E[0]*a[2]+E[1]*a[3]+a[5])*s]}}else a=e.frameState.coordinateToPixelMatrix,o=function(E){return[(E[0]*a[0]+E[1]*a[1]+a[12])*s,(E[0]*a[4]+E[1]*a[5]+a[13])*s]};var c=this.feature_.getGeometry().getCoordinates();this.feature_.getGeometry().getType()==="Polygon"&&(c=[c]);function h(E){for(var x=0;x<c.length;x++)for(var v=c[x],S=0;S<v.length;S++){var w=o([v[S][0][0]+E,v[S][0][1]]);i.moveTo(w[0],w[1]);for(var b=1;b<v[S].length;b++)w=o([v[S][b][0]+E,v[S][b][1]]),i.lineTo(w[0],w[1])}}if(i.beginPath(),t&&(i.moveTo(-100,-100),i.lineTo(r.width+100,-100),i.lineTo(r.width+100,r.height+100),i.lineTo(-100,r.height+100),i.lineTo(-100,-100)),this.get("wrapX")){var u=e.frameState.viewState.projection.getExtent(),d=u[2]-u[0],f=e.frameState.extent,g=this.feature_.getGeometry().getExtent(),_=g[2]-g[1],m=Math.floor((f[0]-_-u[0])/d),y=Math.floor((f[2]+_-u[2])/d)+1;m>y&&([m,y]=[y,m]);for(var p=m;p<=y;p++)h(p*d)}else h(0)}postcompose(e){if(this.feature_){var t=e.context;if(t.save(),this.drawFeaturePath_(e,!this.get("inner")),t.fillStyle=this._fillColor,t.fill("evenodd"),this.get("shadowWidth")){var i=this.get("shadowWidth")*e.frameState.pixelRatio;this.get("shadowMapUnits")&&(i/=e.frameState.viewState.resolution),t.clip("evenodd"),t.filter="blur("+i+"px)",t.strokeStyle=this._shadowColor,t.lineCap="round",t.lineJoin="round",t.lineWidth=i,t.stroke()}t.restore()}}},vS=class extends xS{constructor(e){e=e||{},super(e)}precompose(e){if(this.feature_){var t=e.context;t.save(),this.drawFeaturePath_(e,this.get("inner")),t.clip("evenodd")}}postcompose(e){if(this.feature_){var t=e.context;if(t.restore(),this.get("shadowWidth")){t.save();var i=this.get("shadowWidth")*e.frameState.pixelRatio;this.get("shadowMapUnits")&&(i/=e.frameState.viewState.resolution),this.drawFeaturePath_(e,!this.get("inner")),t.clip("evenodd"),t.filter="blur("+i+"px)",t.strokeStyle=this._shadowColor,t.lineCap="round",t.lineJoin="round",t.lineWidth=i,t.stroke(),t.restore()}}}};const ES=_S()(n=>({map:new Qi,setMap:e=>n({map:e}),showLayersLegend:!0,setShowLayersLegend:e=>n({showLayersLegend:e}),visibleLayers:{},setVisibleLayers:e=>n({visibleLayers:e}),areaOfIntersectLayers:{},setAreaOfIntersectLayers:e=>n({areaOfIntersectLayers:e}),isAoIEnabled:!1,setAoIEnabled:e=>n({isAoIEnabled:e}),openedGroup:void 0,setOpenedGroup:e=>n({openedGroup:e}),drawnCoordinates:[],setDrawnCoordinates:e=>n({drawnCoordinates:e}),selectedLayers:[],setSelectedLayers:e=>n({selectedLayers:e}),searchResults:[],setSearchResults:e=>n({searchResults:e}),navigationCropFilter:new vS,setNavigationCropFilter:e=>n({navigationCropFilter:e}),isProduction:!1,setIsProduction:e=>n({isProduction:e})})),rn=pS(ES),TS=256,t_=new TextEncoder;new TextDecoder;const wS=async n=>{const e=typeof n=="string"?n:JSON.stringify(n),t=window.crypto.getRandomValues(new Uint8Array(16)),i=window.crypto.getRandomValues(new Uint8Array(16)),r=await bS(RS),s=await CS(r,t,["encrypt"]),o=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:i},s,t_.encode(e)),a=new Uint8Array(o),l=new Uint8Array(t.byteLength+i.byteLength+a.byteLength);return l.set(t,0),l.set(i,t.byteLength),l.set(a,t.byteLength+i.byteLength),SS(l)},SS=n=>window.btoa(Array.from(n).map(e=>String.fromCharCode(e)).join("")),bS=n=>window.crypto.subtle.importKey("raw",t_.encode(n),"PBKDF2",!1,["deriveKey"]),CS=(n,e,t)=>window.crypto.subtle.deriveKey({name:"PBKDF2",salt:e,iterations:179,hash:"SHA-256"},n,{name:"AES-GCM",length:TS},!1,t),RS=String.fromCharCode(...new Uint8Array(["22","14","2s","24","2c","15","3o","16","1i","2f","1c","1k","3i","2t","3p","1h","36","1b","2a","26","12","20","37","2j","27","41","1q","1r","1i","23","21"].map(n=>parseInt(n,parseInt("11111",2))))),PS=["localwms","wms"],IS=async(n,e)=>{if(n instanceof Vc){const t=await iu(await ru(e));if(t.status!==200)return;const i=await t.blob(),r=n.getImage();if(r instanceof HTMLImageElement){const s=URL.createObjectURL(i);r.onload=()=>{URL.revokeObjectURL(s)},r.src=s}}},AS=n=>PS.some(e=>n.includes(e)),ru=async n=>{if(!AS(n))return n;const e=new URL(n),t=e.origin+e.pathname,i=e.search.substring(1);return`${t}?data=${encodeURIComponent(await wS(i))}`},LS=()=>{const n=rn.use.map(),e=I.useRef(null),[t,i]=I.useState(),[r,s]=I.useState(""),[o,a]=I.useState(),l=I.useRef(),[c,h]=I.useState();I.useEffect(()=>{const g=new Vv({element:e.current,autoPan:{animation:{duration:250}}});i(g),n.addOverlay(g);const _=m=>{var E;if(wv(m))return;const p=n.getAllLayers().filter(x=>{if(!x.getVisible()||!x.getData||["Village","Taluka","District","State","Google","India Tiles"].includes(x.get("name")))return!1;const v=x.getData(m.pixel);return!(!(v instanceof Uint8ClampedArray)||Array.from(v).every(S=>S===0))})[0];if(p instanceof Sa||p instanceof $s||p instanceof F1||p instanceof Zi){const x=(E=p==null?void 0:p.getSource())==null?void 0:E.getFeatureInfoUrl(m.coordinate,n.getView().getResolution(),"EPSG:3857",{INFO_FORMAT:"application/json"});if(!x)return;ru(x).then(v=>iu(v)).then(v=>v.json()).then(v=>{var N;if(v.features.length===0)return;const S=new z1().readFeatures(v);a((N=S[0].getGeometry())==null?void 0:N.getExtent());const w=v.features[0].properties,b=p.get("name"),P=p.getSource().getParams().LAYERS;h({props:{...w},displayName:b,paramsName:P}),s(b),g==null||g.setPosition(m.coordinate);const D=new Fs({features:S}),G=new $s({source:D,style:new _t({stroke:new kt({color:"#0BC5EA",width:5})})});l.current&&n.removeLayer(l.current),l.current=G,n.addLayer(G)})}};return n.on("singleclick",_),()=>{n.un("singleclick",_),n.removeOverlay(t),n.removeLayer(l.current)}},[n]);const u=()=>{const g=Kt(o);n.getView().fit(new Jt(g),{size:n.getSize(),duration:1e3,maxZoom:10})},d=()=>{var g,_;t==null||t.setPosition(void 0),(_=(g=e.current)==null?void 0:g.parentElement)==null||_.classList.remove("pin-top-right"),n.removeLayer(l.current)},f=j.jsx(j.Fragment,{children:j.jsx("div",{className:"body",children:!!(c!=null&&c.props)&&Object.entries(MS(c==null?void 0:c.props)).map(([g,_])=>j.jsxs("div",{className:"cell",children:[j.jsx("div",{className:"key",children:g}),j.jsx("div",{className:"val",children:_})]},g))})});return j.jsxs("div",{ref:e,id:"popup",className:"identify-popup",children:[j.jsxs("header",{className:"d-flex align-items-center justify-content-between gap-2 p-2",children:[j.jsx("span",{color:"black",children:r}),j.jsxs("div",{className:"d-flex align-items-center gap-2",children:[j.jsx(hT,{size:22,role:"button",onClick:u}),j.jsx(uT,{className:"",color:"black",size:24,role:"button",onClick:d})]})]}),f]})},MS=n=>{const e={...n};return delete e.minx,delete e.miny,delete e.maxx,delete e.maxy,delete e.wkt,delete e.geom,delete e.userid,delete e.username,delete e.action,Object.keys(e).forEach(t=>{const i=e[t],r=t.replaceAll("_"," "),s=!i||typeof i=="string"&&i.trim().length===0||i=="null"||i=="NULL"?"-":i;delete e[t],e[r]=new String(s)}),e};//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var n_;function U(){return n_.apply(null,arguments)}function OS(n){n_=n}function sn(n){return n instanceof Array||Object.prototype.toString.call(n)==="[object Array]"}function ir(n){return n!=null&&Object.prototype.toString.call(n)==="[object Object]"}function pe(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function su(n){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(n).length===0;var e;for(e in n)if(pe(n,e))return!1;return!0}function Lt(n){return n===void 0}function Vn(n){return typeof n=="number"||Object.prototype.toString.call(n)==="[object Number]"}function oo(n){return n instanceof Date||Object.prototype.toString.call(n)==="[object Date]"}function i_(n,e){var t=[],i,r=n.length;for(i=0;i<r;++i)t.push(e(n[i],i));return t}function bi(n,e){for(var t in e)pe(e,t)&&(n[t]=e[t]);return pe(e,"toString")&&(n.toString=e.toString),pe(e,"valueOf")&&(n.valueOf=e.valueOf),n}function Tn(n,e,t,i){return A_(n,e,t,i,!0).utc()}function DS(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function le(n){return n._pf==null&&(n._pf=DS()),n._pf}var ou;Array.prototype.some?ou=Array.prototype.some:ou=function(n){var e=Object(this),t=e.length>>>0,i;for(i=0;i<t;i++)if(i in e&&n.call(this,e[i],i,e))return!0;return!1};function au(n){var e=null,t=!1,i=n._d&&!isNaN(n._d.getTime());if(i&&(e=le(n),t=ou.call(e.parsedDateParts,function(r){return r!=null}),i=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&t),n._strict&&(i=i&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(n))n._isValid=i;else return i;return n._isValid}function el(n){var e=Tn(NaN);return n!=null?bi(le(e),n):le(e).userInvalidated=!0,e}var r_=U.momentProperties=[],lu=!1;function cu(n,e){var t,i,r,s=r_.length;if(Lt(e._isAMomentObject)||(n._isAMomentObject=e._isAMomentObject),Lt(e._i)||(n._i=e._i),Lt(e._f)||(n._f=e._f),Lt(e._l)||(n._l=e._l),Lt(e._strict)||(n._strict=e._strict),Lt(e._tzm)||(n._tzm=e._tzm),Lt(e._isUTC)||(n._isUTC=e._isUTC),Lt(e._offset)||(n._offset=e._offset),Lt(e._pf)||(n._pf=le(e)),Lt(e._locale)||(n._locale=e._locale),s>0)for(t=0;t<s;t++)i=r_[t],r=e[i],Lt(r)||(n[i]=r);return n}function ao(n){cu(this,n),this._d=new Date(n._d!=null?n._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),lu===!1&&(lu=!0,U.updateOffset(this),lu=!1)}function on(n){return n instanceof ao||n!=null&&n._isAMomentObject!=null}function s_(n){U.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+n)}function Yt(n,e){var t=!0;return bi(function(){if(U.deprecationHandler!=null&&U.deprecationHandler(null,n),t){var i=[],r,s,o,a=arguments.length;for(s=0;s<a;s++){if(r="",typeof arguments[s]=="object"){r+=`
[`+s+"] ";for(o in arguments[0])pe(arguments[0],o)&&(r+=o+": "+arguments[0][o]+", ");r=r.slice(0,-2)}else r=arguments[s];i.push(r)}s_(n+`
Arguments: `+Array.prototype.slice.call(i).join("")+`
`+new Error().stack),t=!1}return e.apply(this,arguments)},e)}var o_={};function a_(n,e){U.deprecationHandler!=null&&U.deprecationHandler(n,e),o_[n]||(s_(e),o_[n]=!0)}U.suppressDeprecationWarnings=!1,U.deprecationHandler=null;function wn(n){return typeof Function<"u"&&n instanceof Function||Object.prototype.toString.call(n)==="[object Function]"}function FS(n){var e,t;for(t in n)pe(n,t)&&(e=n[t],wn(e)?this[t]=e:this["_"+t]=e);this._config=n,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function hu(n,e){var t=bi({},n),i;for(i in e)pe(e,i)&&(ir(n[i])&&ir(e[i])?(t[i]={},bi(t[i],n[i]),bi(t[i],e[i])):e[i]!=null?t[i]=e[i]:delete t[i]);for(i in n)pe(n,i)&&!pe(e,i)&&ir(n[i])&&(t[i]=bi({},t[i]));return t}function uu(n){n!=null&&this.set(n)}var du;Object.keys?du=Object.keys:du=function(n){var e,t=[];for(e in n)pe(n,e)&&t.push(e);return t};var kS={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function NS(n,e,t){var i=this._calendar[n]||this._calendar.sameElse;return wn(i)?i.call(e,t):i}function Sn(n,e,t){var i=""+Math.abs(n),r=e-i.length,s=n>=0;return(s?t?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}var fu=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,tl=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,gu={},jr={};function X(n,e,t,i){var r=i;typeof i=="string"&&(r=function(){return this[i]()}),n&&(jr[n]=r),e&&(jr[e[0]]=function(){return Sn(r.apply(this,arguments),e[1],e[2])}),t&&(jr[t]=function(){return this.localeData().ordinal(r.apply(this,arguments),n)})}function GS(n){return n.match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function US(n){var e=n.match(fu),t,i;for(t=0,i=e.length;t<i;t++)jr[e[t]]?e[t]=jr[e[t]]:e[t]=GS(e[t]);return function(r){var s="",o;for(o=0;o<i;o++)s+=wn(e[o])?e[o].call(r,n):e[o];return s}}function nl(n,e){return n.isValid()?(e=l_(e,n.localeData()),gu[e]=gu[e]||US(e),gu[e](n)):n.localeData().invalidDate()}function l_(n,e){var t=5;function i(r){return e.longDateFormat(r)||r}for(tl.lastIndex=0;t>=0&&tl.test(n);)n=n.replace(tl,i),tl.lastIndex=0,t-=1;return n}var BS={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function zS(n){var e=this._longDateFormat[n],t=this._longDateFormat[n.toUpperCase()];return e||!t?e:(this._longDateFormat[n]=t.match(fu).map(function(i){return i==="MMMM"||i==="MM"||i==="DD"||i==="dddd"?i.slice(1):i}).join(""),this._longDateFormat[n])}var WS="Invalid date";function YS(){return this._invalidDate}var $S="%d",jS=/\d{1,2}/;function VS(n){return this._ordinal.replace("%d",n)}var XS={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function HS(n,e,t,i){var r=this._relativeTime[t];return wn(r)?r(n,e,t,i):r.replace(/%d/i,n)}function KS(n,e){var t=this._relativeTime[n>0?"future":"past"];return wn(t)?t(e):t.replace(/%s/i,e)}var c_={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function $t(n){return typeof n=="string"?c_[n]||c_[n.toLowerCase()]:void 0}function mu(n){var e={},t,i;for(i in n)pe(n,i)&&(t=$t(i),t&&(e[t]=n[i]));return e}var ZS={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function qS(n){var e=[],t;for(t in n)pe(n,t)&&e.push({unit:t,priority:ZS[t]});return e.sort(function(i,r){return i.priority-r.priority}),e}var h_=/\d/,Nt=/\d\d/,u_=/\d{3}/,_u=/\d{4}/,il=/[+-]?\d{6}/,Ie=/\d\d?/,d_=/\d\d\d\d?/,f_=/\d\d\d\d\d\d?/,rl=/\d{1,3}/,pu=/\d{1,4}/,sl=/[+-]?\d{1,6}/,Vr=/\d+/,ol=/[+-]?\d+/,JS=/Z|[+-]\d\d:?\d\d/gi,al=/Z|[+-]\d\d(?::?\d\d)?/gi,QS=/[+-]?\d+(\.\d{1,3})?/,lo=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Xr=/^[1-9]\d?/,yu=/^([1-9]\d|\d)/,ll;ll={};function Y(n,e,t){ll[n]=wn(e)?e:function(i,r){return i&&t?t:e}}function eb(n,e){return pe(ll,n)?ll[n](e._strict,e._locale):new RegExp(tb(n))}function tb(n){return Xn(n.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,i,r,s){return t||i||r||s}))}function Xn(n){return n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function jt(n){return n<0?Math.ceil(n)||0:Math.floor(n)}function ue(n){var e=+n,t=0;return e!==0&&isFinite(e)&&(t=jt(e)),t}var xu={};function Se(n,e){var t,i=e,r;for(typeof n=="string"&&(n=[n]),Vn(e)&&(i=function(s,o){o[e]=ue(s)}),r=n.length,t=0;t<r;t++)xu[n[t]]=i}function co(n,e){Se(n,function(t,i,r,s){r._w=r._w||{},e(t,r._w,r,s)})}function nb(n,e,t){e!=null&&pe(xu,n)&&xu[n](e,t._a,t,n)}function cl(n){return n%4===0&&n%100!==0||n%400===0}var ht=0,Hn=1,bn=2,Ze=3,an=4,Kn=5,rr=6,ib=7,rb=8;X("Y",0,0,function(){var n=this.year();return n<=9999?Sn(n,4):"+"+n}),X(0,["YY",2],0,function(){return this.year()%100}),X(0,["YYYY",4],0,"year"),X(0,["YYYYY",5],0,"year"),X(0,["YYYYYY",6,!0],0,"year"),Y("Y",ol),Y("YY",Ie,Nt),Y("YYYY",pu,_u),Y("YYYYY",sl,il),Y("YYYYYY",sl,il),Se(["YYYYY","YYYYYY"],ht),Se("YYYY",function(n,e){e[ht]=n.length===2?U.parseTwoDigitYear(n):ue(n)}),Se("YY",function(n,e){e[ht]=U.parseTwoDigitYear(n)}),Se("Y",function(n,e){e[ht]=parseInt(n,10)});function ho(n){return cl(n)?366:365}U.parseTwoDigitYear=function(n){return ue(n)+(ue(n)>68?1900:2e3)};var g_=Hr("FullYear",!0);function sb(){return cl(this.year())}function Hr(n,e){return function(t){return t!=null?(m_(this,n,t),U.updateOffset(this,e),this):uo(this,n)}}function uo(n,e){if(!n.isValid())return NaN;var t=n._d,i=n._isUTC;switch(e){case"Milliseconds":return i?t.getUTCMilliseconds():t.getMilliseconds();case"Seconds":return i?t.getUTCSeconds():t.getSeconds();case"Minutes":return i?t.getUTCMinutes():t.getMinutes();case"Hours":return i?t.getUTCHours():t.getHours();case"Date":return i?t.getUTCDate():t.getDate();case"Day":return i?t.getUTCDay():t.getDay();case"Month":return i?t.getUTCMonth():t.getMonth();case"FullYear":return i?t.getUTCFullYear():t.getFullYear();default:return NaN}}function m_(n,e,t){var i,r,s,o,a;if(!(!n.isValid()||isNaN(t))){switch(i=n._d,r=n._isUTC,e){case"Milliseconds":return void(r?i.setUTCMilliseconds(t):i.setMilliseconds(t));case"Seconds":return void(r?i.setUTCSeconds(t):i.setSeconds(t));case"Minutes":return void(r?i.setUTCMinutes(t):i.setMinutes(t));case"Hours":return void(r?i.setUTCHours(t):i.setHours(t));case"Date":return void(r?i.setUTCDate(t):i.setDate(t));case"FullYear":break;default:return}s=t,o=n.month(),a=n.date(),a=a===29&&o===1&&!cl(s)?28:a,r?i.setUTCFullYear(s,o,a):i.setFullYear(s,o,a)}}function ob(n){return n=$t(n),wn(this[n])?this[n]():this}function ab(n,e){if(typeof n=="object"){n=mu(n);var t=qS(n),i,r=t.length;for(i=0;i<r;i++)this[t[i].unit](n[t[i].unit])}else if(n=$t(n),wn(this[n]))return this[n](e);return this}function lb(n,e){return(n%e+e)%e}var Ue;Array.prototype.indexOf?Ue=Array.prototype.indexOf:Ue=function(n){var e;for(e=0;e<this.length;++e)if(this[e]===n)return e;return-1};function vu(n,e){if(isNaN(n)||isNaN(e))return NaN;var t=lb(e,12);return n+=(e-t)/12,t===1?cl(n)?29:28:31-t%7%2}X("M",["MM",2],"Mo",function(){return this.month()+1}),X("MMM",0,0,function(n){return this.localeData().monthsShort(this,n)}),X("MMMM",0,0,function(n){return this.localeData().months(this,n)}),Y("M",Ie,Xr),Y("MM",Ie,Nt),Y("MMM",function(n,e){return e.monthsShortRegex(n)}),Y("MMMM",function(n,e){return e.monthsRegex(n)}),Se(["M","MM"],function(n,e){e[Hn]=ue(n)-1}),Se(["MMM","MMMM"],function(n,e,t,i){var r=t._locale.monthsParse(n,i,t._strict);r!=null?e[Hn]=r:le(t).invalidMonth=n});var cb="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),__="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),p_=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,hb=lo,ub=lo;function db(n,e){return n?sn(this._months)?this._months[n.month()]:this._months[(this._months.isFormat||p_).test(e)?"format":"standalone"][n.month()]:sn(this._months)?this._months:this._months.standalone}function fb(n,e){return n?sn(this._monthsShort)?this._monthsShort[n.month()]:this._monthsShort[p_.test(e)?"format":"standalone"][n.month()]:sn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function gb(n,e,t){var i,r,s,o=n.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)s=Tn([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(s,"").toLocaleLowerCase();return t?e==="MMM"?(r=Ue.call(this._shortMonthsParse,o),r!==-1?r:null):(r=Ue.call(this._longMonthsParse,o),r!==-1?r:null):e==="MMM"?(r=Ue.call(this._shortMonthsParse,o),r!==-1?r:(r=Ue.call(this._longMonthsParse,o),r!==-1?r:null)):(r=Ue.call(this._longMonthsParse,o),r!==-1?r:(r=Ue.call(this._shortMonthsParse,o),r!==-1?r:null))}function mb(n,e,t){var i,r,s;if(this._monthsParseExact)return gb.call(this,n,e,t);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=Tn([2e3,i]),t&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),!t&&!this._monthsParse[i]&&(s="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(s.replace(".",""),"i")),t&&e==="MMMM"&&this._longMonthsParse[i].test(n))return i;if(t&&e==="MMM"&&this._shortMonthsParse[i].test(n))return i;if(!t&&this._monthsParse[i].test(n))return i}}function y_(n,e){if(!n.isValid())return n;if(typeof e=="string"){if(/^\d+$/.test(e))e=ue(e);else if(e=n.localeData().monthsParse(e),!Vn(e))return n}var t=e,i=n.date();return i=i<29?i:Math.min(i,vu(n.year(),t)),n._isUTC?n._d.setUTCMonth(t,i):n._d.setMonth(t,i),n}function x_(n){return n!=null?(y_(this,n),U.updateOffset(this,!0),this):uo(this,"Month")}function _b(){return vu(this.year(),this.month())}function pb(n){return this._monthsParseExact?(pe(this,"_monthsRegex")||v_.call(this),n?this._monthsShortStrictRegex:this._monthsShortRegex):(pe(this,"_monthsShortRegex")||(this._monthsShortRegex=hb),this._monthsShortStrictRegex&&n?this._monthsShortStrictRegex:this._monthsShortRegex)}function yb(n){return this._monthsParseExact?(pe(this,"_monthsRegex")||v_.call(this),n?this._monthsStrictRegex:this._monthsRegex):(pe(this,"_monthsRegex")||(this._monthsRegex=ub),this._monthsStrictRegex&&n?this._monthsStrictRegex:this._monthsRegex)}function v_(){function n(l,c){return c.length-l.length}var e=[],t=[],i=[],r,s,o,a;for(r=0;r<12;r++)s=Tn([2e3,r]),o=Xn(this.monthsShort(s,"")),a=Xn(this.months(s,"")),e.push(o),t.push(a),i.push(a),i.push(o);e.sort(n),t.sort(n),i.sort(n),this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function xb(n,e,t,i,r,s,o){var a;return n<100&&n>=0?(a=new Date(n+400,e,t,i,r,s,o),isFinite(a.getFullYear())&&a.setFullYear(n)):a=new Date(n,e,t,i,r,s,o),a}function fo(n){var e,t;return n<100&&n>=0?(t=Array.prototype.slice.call(arguments),t[0]=n+400,e=new Date(Date.UTC.apply(null,t)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(n)):e=new Date(Date.UTC.apply(null,arguments)),e}function hl(n,e,t){var i=7+e-t,r=(7+fo(n,0,i).getUTCDay()-e)%7;return-r+i-1}function E_(n,e,t,i,r){var s=(7+t-i)%7,o=hl(n,i,r),a=1+7*(e-1)+s+o,l,c;return a<=0?(l=n-1,c=ho(l)+a):a>ho(n)?(l=n+1,c=a-ho(n)):(l=n,c=a),{year:l,dayOfYear:c}}function go(n,e,t){var i=hl(n.year(),e,t),r=Math.floor((n.dayOfYear()-i-1)/7)+1,s,o;return r<1?(o=n.year()-1,s=r+Zn(o,e,t)):r>Zn(n.year(),e,t)?(s=r-Zn(n.year(),e,t),o=n.year()+1):(o=n.year(),s=r),{week:s,year:o}}function Zn(n,e,t){var i=hl(n,e,t),r=hl(n+1,e,t);return(ho(n)-i+r)/7}X("w",["ww",2],"wo","week"),X("W",["WW",2],"Wo","isoWeek"),Y("w",Ie,Xr),Y("ww",Ie,Nt),Y("W",Ie,Xr),Y("WW",Ie,Nt),co(["w","ww","W","WW"],function(n,e,t,i){e[i.substr(0,1)]=ue(n)});function vb(n){return go(n,this._week.dow,this._week.doy).week}var Eb={dow:0,doy:6};function Tb(){return this._week.dow}function wb(){return this._week.doy}function Sb(n){var e=this.localeData().week(this);return n==null?e:this.add((n-e)*7,"d")}function bb(n){var e=go(this,1,4).week;return n==null?e:this.add((n-e)*7,"d")}X("d",0,"do","day"),X("dd",0,0,function(n){return this.localeData().weekdaysMin(this,n)}),X("ddd",0,0,function(n){return this.localeData().weekdaysShort(this,n)}),X("dddd",0,0,function(n){return this.localeData().weekdays(this,n)}),X("e",0,0,"weekday"),X("E",0,0,"isoWeekday"),Y("d",Ie),Y("e",Ie),Y("E",Ie),Y("dd",function(n,e){return e.weekdaysMinRegex(n)}),Y("ddd",function(n,e){return e.weekdaysShortRegex(n)}),Y("dddd",function(n,e){return e.weekdaysRegex(n)}),co(["dd","ddd","dddd"],function(n,e,t,i){var r=t._locale.weekdaysParse(n,i,t._strict);r!=null?e.d=r:le(t).invalidWeekday=n}),co(["d","e","E"],function(n,e,t,i){e[i]=ue(n)});function Cb(n,e){return typeof n!="string"?n:isNaN(n)?(n=e.weekdaysParse(n),typeof n=="number"?n:null):parseInt(n,10)}function Rb(n,e){return typeof n=="string"?e.weekdaysParse(n)%7||7:isNaN(n)?null:n}function Eu(n,e){return n.slice(e,7).concat(n.slice(0,e))}var Pb="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),T_="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Ib="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Ab=lo,Lb=lo,Mb=lo;function Ob(n,e){var t=sn(this._weekdays)?this._weekdays:this._weekdays[n&&n!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return n===!0?Eu(t,this._week.dow):n?t[n.day()]:t}function Db(n){return n===!0?Eu(this._weekdaysShort,this._week.dow):n?this._weekdaysShort[n.day()]:this._weekdaysShort}function Fb(n){return n===!0?Eu(this._weekdaysMin,this._week.dow):n?this._weekdaysMin[n.day()]:this._weekdaysMin}function kb(n,e,t){var i,r,s,o=n.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)s=Tn([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(s,"").toLocaleLowerCase();return t?e==="dddd"?(r=Ue.call(this._weekdaysParse,o),r!==-1?r:null):e==="ddd"?(r=Ue.call(this._shortWeekdaysParse,o),r!==-1?r:null):(r=Ue.call(this._minWeekdaysParse,o),r!==-1?r:null):e==="dddd"?(r=Ue.call(this._weekdaysParse,o),r!==-1||(r=Ue.call(this._shortWeekdaysParse,o),r!==-1)?r:(r=Ue.call(this._minWeekdaysParse,o),r!==-1?r:null)):e==="ddd"?(r=Ue.call(this._shortWeekdaysParse,o),r!==-1||(r=Ue.call(this._weekdaysParse,o),r!==-1)?r:(r=Ue.call(this._minWeekdaysParse,o),r!==-1?r:null)):(r=Ue.call(this._minWeekdaysParse,o),r!==-1||(r=Ue.call(this._weekdaysParse,o),r!==-1)?r:(r=Ue.call(this._shortWeekdaysParse,o),r!==-1?r:null))}function Nb(n,e,t){var i,r,s;if(this._weekdaysParseExact)return kb.call(this,n,e,t);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(r=Tn([2e3,1]).day(i),t&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(s="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(s.replace(".",""),"i")),t&&e==="dddd"&&this._fullWeekdaysParse[i].test(n))return i;if(t&&e==="ddd"&&this._shortWeekdaysParse[i].test(n))return i;if(t&&e==="dd"&&this._minWeekdaysParse[i].test(n))return i;if(!t&&this._weekdaysParse[i].test(n))return i}}function Gb(n){if(!this.isValid())return n!=null?this:NaN;var e=uo(this,"Day");return n!=null?(n=Cb(n,this.localeData()),this.add(n-e,"d")):e}function Ub(n){if(!this.isValid())return n!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return n==null?e:this.add(n-e,"d")}function Bb(n){if(!this.isValid())return n!=null?this:NaN;if(n!=null){var e=Rb(n,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function zb(n){return this._weekdaysParseExact?(pe(this,"_weekdaysRegex")||Tu.call(this),n?this._weekdaysStrictRegex:this._weekdaysRegex):(pe(this,"_weekdaysRegex")||(this._weekdaysRegex=Ab),this._weekdaysStrictRegex&&n?this._weekdaysStrictRegex:this._weekdaysRegex)}function Wb(n){return this._weekdaysParseExact?(pe(this,"_weekdaysRegex")||Tu.call(this),n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(pe(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Lb),this._weekdaysShortStrictRegex&&n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Yb(n){return this._weekdaysParseExact?(pe(this,"_weekdaysRegex")||Tu.call(this),n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(pe(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Mb),this._weekdaysMinStrictRegex&&n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Tu(){function n(h,u){return u.length-h.length}var e=[],t=[],i=[],r=[],s,o,a,l,c;for(s=0;s<7;s++)o=Tn([2e3,1]).day(s),a=Xn(this.weekdaysMin(o,"")),l=Xn(this.weekdaysShort(o,"")),c=Xn(this.weekdays(o,"")),e.push(a),t.push(l),i.push(c),r.push(a),r.push(l),r.push(c);e.sort(n),t.sort(n),i.sort(n),r.sort(n),this._weekdaysRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function wu(){return this.hours()%12||12}function $b(){return this.hours()||24}X("H",["HH",2],0,"hour"),X("h",["hh",2],0,wu),X("k",["kk",2],0,$b),X("hmm",0,0,function(){return""+wu.apply(this)+Sn(this.minutes(),2)}),X("hmmss",0,0,function(){return""+wu.apply(this)+Sn(this.minutes(),2)+Sn(this.seconds(),2)}),X("Hmm",0,0,function(){return""+this.hours()+Sn(this.minutes(),2)}),X("Hmmss",0,0,function(){return""+this.hours()+Sn(this.minutes(),2)+Sn(this.seconds(),2)});function w_(n,e){X(n,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}w_("a",!0),w_("A",!1);function S_(n,e){return e._meridiemParse}Y("a",S_),Y("A",S_),Y("H",Ie,yu),Y("h",Ie,Xr),Y("k",Ie,Xr),Y("HH",Ie,Nt),Y("hh",Ie,Nt),Y("kk",Ie,Nt),Y("hmm",d_),Y("hmmss",f_),Y("Hmm",d_),Y("Hmmss",f_),Se(["H","HH"],Ze),Se(["k","kk"],function(n,e,t){var i=ue(n);e[Ze]=i===24?0:i}),Se(["a","A"],function(n,e,t){t._isPm=t._locale.isPM(n),t._meridiem=n}),Se(["h","hh"],function(n,e,t){e[Ze]=ue(n),le(t).bigHour=!0}),Se("hmm",function(n,e,t){var i=n.length-2;e[Ze]=ue(n.substr(0,i)),e[an]=ue(n.substr(i)),le(t).bigHour=!0}),Se("hmmss",function(n,e,t){var i=n.length-4,r=n.length-2;e[Ze]=ue(n.substr(0,i)),e[an]=ue(n.substr(i,2)),e[Kn]=ue(n.substr(r)),le(t).bigHour=!0}),Se("Hmm",function(n,e,t){var i=n.length-2;e[Ze]=ue(n.substr(0,i)),e[an]=ue(n.substr(i))}),Se("Hmmss",function(n,e,t){var i=n.length-4,r=n.length-2;e[Ze]=ue(n.substr(0,i)),e[an]=ue(n.substr(i,2)),e[Kn]=ue(n.substr(r))});function jb(n){return(n+"").toLowerCase().charAt(0)==="p"}var Vb=/[ap]\.?m?\.?/i,Xb=Hr("Hours",!0);function Hb(n,e,t){return n>11?t?"pm":"PM":t?"am":"AM"}var b_={calendar:kS,longDateFormat:BS,invalidDate:WS,ordinal:$S,dayOfMonthOrdinalParse:jS,relativeTime:XS,months:cb,monthsShort:__,week:Eb,weekdays:Pb,weekdaysMin:Ib,weekdaysShort:T_,meridiemParse:Vb},De={},mo={},_o;function Kb(n,e){var t,i=Math.min(n.length,e.length);for(t=0;t<i;t+=1)if(n[t]!==e[t])return t;return i}function C_(n){return n&&n.toLowerCase().replace("_","-")}function Zb(n){for(var e=0,t,i,r,s;e<n.length;){for(s=C_(n[e]).split("-"),t=s.length,i=C_(n[e+1]),i=i?i.split("-"):null;t>0;){if(r=ul(s.slice(0,t).join("-")),r)return r;if(i&&i.length>=t&&Kb(s,i)>=t-1)break;t--}e++}return _o}function qb(n){return!!(n&&n.match("^[^/\\\\]*$"))}function ul(n){var e=null,t;if(De[n]===void 0&&typeof module<"u"&&module&&module.exports&&qb(n))try{e=_o._abbr,t=require,t("./locale/"+n),Ci(e)}catch{De[n]=null}return De[n]}function Ci(n,e){var t;return n&&(Lt(e)?t=qn(n):t=Su(n,e),t?_o=t:typeof console<"u"&&console.warn&&console.warn("Locale "+n+" not found. Did you forget to load it?")),_o._abbr}function Su(n,e){if(e!==null){var t,i=b_;if(e.abbr=n,De[n]!=null)a_("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=De[n]._config;else if(e.parentLocale!=null)if(De[e.parentLocale]!=null)i=De[e.parentLocale]._config;else if(t=ul(e.parentLocale),t!=null)i=t._config;else return mo[e.parentLocale]||(mo[e.parentLocale]=[]),mo[e.parentLocale].push({name:n,config:e}),null;return De[n]=new uu(hu(i,e)),mo[n]&&mo[n].forEach(function(r){Su(r.name,r.config)}),Ci(n),De[n]}else return delete De[n],null}function Jb(n,e){if(e!=null){var t,i,r=b_;De[n]!=null&&De[n].parentLocale!=null?De[n].set(hu(De[n]._config,e)):(i=ul(n),i!=null&&(r=i._config),e=hu(r,e),i==null&&(e.abbr=n),t=new uu(e),t.parentLocale=De[n],De[n]=t),Ci(n)}else De[n]!=null&&(De[n].parentLocale!=null?(De[n]=De[n].parentLocale,n===Ci()&&Ci(n)):De[n]!=null&&delete De[n]);return De[n]}function qn(n){var e;if(n&&n._locale&&n._locale._abbr&&(n=n._locale._abbr),!n)return _o;if(!sn(n)){if(e=ul(n),e)return e;n=[n]}return Zb(n)}function Qb(){return du(De)}function bu(n){var e,t=n._a;return t&&le(n).overflow===-2&&(e=t[Hn]<0||t[Hn]>11?Hn:t[bn]<1||t[bn]>vu(t[ht],t[Hn])?bn:t[Ze]<0||t[Ze]>24||t[Ze]===24&&(t[an]!==0||t[Kn]!==0||t[rr]!==0)?Ze:t[an]<0||t[an]>59?an:t[Kn]<0||t[Kn]>59?Kn:t[rr]<0||t[rr]>999?rr:-1,le(n)._overflowDayOfYear&&(e<ht||e>bn)&&(e=bn),le(n)._overflowWeeks&&e===-1&&(e=ib),le(n)._overflowWeekday&&e===-1&&(e=rb),le(n).overflow=e),n}var eC=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tC=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,nC=/Z|[+-]\d\d(?::?\d\d)?/,dl=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Cu=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],iC=/^\/?Date\((-?\d+)/i,rC=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,sC={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function R_(n){var e,t,i=n._i,r=eC.exec(i)||tC.exec(i),s,o,a,l,c=dl.length,h=Cu.length;if(r){for(le(n).iso=!0,e=0,t=c;e<t;e++)if(dl[e][1].exec(r[1])){o=dl[e][0],s=dl[e][2]!==!1;break}if(o==null){n._isValid=!1;return}if(r[3]){for(e=0,t=h;e<t;e++)if(Cu[e][1].exec(r[3])){a=(r[2]||" ")+Cu[e][0];break}if(a==null){n._isValid=!1;return}}if(!s&&a!=null){n._isValid=!1;return}if(r[4])if(nC.exec(r[4]))l="Z";else{n._isValid=!1;return}n._f=o+(a||"")+(l||""),Pu(n)}else n._isValid=!1}function oC(n,e,t,i,r,s){var o=[aC(n),__.indexOf(e),parseInt(t,10),parseInt(i,10),parseInt(r,10)];return s&&o.push(parseInt(s,10)),o}function aC(n){var e=parseInt(n,10);return e<=49?2e3+e:e<=999?1900+e:e}function lC(n){return n.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function cC(n,e,t){if(n){var i=T_.indexOf(n),r=new Date(e[0],e[1],e[2]).getDay();if(i!==r)return le(t).weekdayMismatch=!0,t._isValid=!1,!1}return!0}function hC(n,e,t){if(n)return sC[n];if(e)return 0;var i=parseInt(t,10),r=i%100,s=(i-r)/100;return s*60+r}function P_(n){var e=rC.exec(lC(n._i)),t;if(e){if(t=oC(e[4],e[3],e[2],e[5],e[6],e[7]),!cC(e[1],t,n))return;n._a=t,n._tzm=hC(e[8],e[9],e[10]),n._d=fo.apply(null,n._a),n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),le(n).rfc2822=!0}else n._isValid=!1}function uC(n){var e=iC.exec(n._i);if(e!==null){n._d=new Date(+e[1]);return}if(R_(n),n._isValid===!1)delete n._isValid;else return;if(P_(n),n._isValid===!1)delete n._isValid;else return;n._strict?n._isValid=!1:U.createFromInputFallback(n)}U.createFromInputFallback=Yt("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(n){n._d=new Date(n._i+(n._useUTC?" UTC":""))});function Kr(n,e,t){return n??e??t}function dC(n){var e=new Date(U.now());return n._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function Ru(n){var e,t,i=[],r,s,o;if(!n._d){for(r=dC(n),n._w&&n._a[bn]==null&&n._a[Hn]==null&&fC(n),n._dayOfYear!=null&&(o=Kr(n._a[ht],r[ht]),(n._dayOfYear>ho(o)||n._dayOfYear===0)&&(le(n)._overflowDayOfYear=!0),t=fo(o,0,n._dayOfYear),n._a[Hn]=t.getUTCMonth(),n._a[bn]=t.getUTCDate()),e=0;e<3&&n._a[e]==null;++e)n._a[e]=i[e]=r[e];for(;e<7;e++)n._a[e]=i[e]=n._a[e]==null?e===2?1:0:n._a[e];n._a[Ze]===24&&n._a[an]===0&&n._a[Kn]===0&&n._a[rr]===0&&(n._nextDay=!0,n._a[Ze]=0),n._d=(n._useUTC?fo:xb).apply(null,i),s=n._useUTC?n._d.getUTCDay():n._d.getDay(),n._tzm!=null&&n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),n._nextDay&&(n._a[Ze]=24),n._w&&typeof n._w.d<"u"&&n._w.d!==s&&(le(n).weekdayMismatch=!0)}}function fC(n){var e,t,i,r,s,o,a,l,c;e=n._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,o=4,t=Kr(e.GG,n._a[ht],go(Ae(),1,4).year),i=Kr(e.W,1),r=Kr(e.E,1),(r<1||r>7)&&(l=!0)):(s=n._locale._week.dow,o=n._locale._week.doy,c=go(Ae(),s,o),t=Kr(e.gg,n._a[ht],c.year),i=Kr(e.w,c.week),e.d!=null?(r=e.d,(r<0||r>6)&&(l=!0)):e.e!=null?(r=e.e+s,(e.e<0||e.e>6)&&(l=!0)):r=s),i<1||i>Zn(t,s,o)?le(n)._overflowWeeks=!0:l!=null?le(n)._overflowWeekday=!0:(a=E_(t,i,r,s,o),n._a[ht]=a.year,n._dayOfYear=a.dayOfYear)}U.ISO_8601=function(){},U.RFC_2822=function(){};function Pu(n){if(n._f===U.ISO_8601){R_(n);return}if(n._f===U.RFC_2822){P_(n);return}n._a=[],le(n).empty=!0;var e=""+n._i,t,i,r,s,o,a=e.length,l=0,c,h;for(r=l_(n._f,n._locale).match(fu)||[],h=r.length,t=0;t<h;t++)s=r[t],i=(e.match(eb(s,n))||[])[0],i&&(o=e.substr(0,e.indexOf(i)),o.length>0&&le(n).unusedInput.push(o),e=e.slice(e.indexOf(i)+i.length),l+=i.length),jr[s]?(i?le(n).empty=!1:le(n).unusedTokens.push(s),nb(s,i,n)):n._strict&&!i&&le(n).unusedTokens.push(s);le(n).charsLeftOver=a-l,e.length>0&&le(n).unusedInput.push(e),n._a[Ze]<=12&&le(n).bigHour===!0&&n._a[Ze]>0&&(le(n).bigHour=void 0),le(n).parsedDateParts=n._a.slice(0),le(n).meridiem=n._meridiem,n._a[Ze]=gC(n._locale,n._a[Ze],n._meridiem),c=le(n).era,c!==null&&(n._a[ht]=n._locale.erasConvertYear(c,n._a[ht])),Ru(n),bu(n)}function gC(n,e,t){var i;return t==null?e:n.meridiemHour!=null?n.meridiemHour(e,t):(n.isPM!=null&&(i=n.isPM(t),i&&e<12&&(e+=12),!i&&e===12&&(e=0)),e)}function mC(n){var e,t,i,r,s,o,a=!1,l=n._f.length;if(l===0){le(n).invalidFormat=!0,n._d=new Date(NaN);return}for(r=0;r<l;r++)s=0,o=!1,e=cu({},n),n._useUTC!=null&&(e._useUTC=n._useUTC),e._f=n._f[r],Pu(e),au(e)&&(o=!0),s+=le(e).charsLeftOver,s+=le(e).unusedTokens.length*10,le(e).score=s,a?s<i&&(i=s,t=e):(i==null||s<i||o)&&(i=s,t=e,o&&(a=!0));bi(n,t||e)}function _C(n){if(!n._d){var e=mu(n._i),t=e.day===void 0?e.date:e.day;n._a=i_([e.year,e.month,t,e.hour,e.minute,e.second,e.millisecond],function(i){return i&&parseInt(i,10)}),Ru(n)}}function pC(n){var e=new ao(bu(I_(n)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function I_(n){var e=n._i,t=n._f;return n._locale=n._locale||qn(n._l),e===null||t===void 0&&e===""?el({nullInput:!0}):(typeof e=="string"&&(n._i=e=n._locale.preparse(e)),on(e)?new ao(bu(e)):(oo(e)?n._d=e:sn(t)?mC(n):t?Pu(n):yC(n),au(n)||(n._d=null),n))}function yC(n){var e=n._i;Lt(e)?n._d=new Date(U.now()):oo(e)?n._d=new Date(e.valueOf()):typeof e=="string"?uC(n):sn(e)?(n._a=i_(e.slice(0),function(t){return parseInt(t,10)}),Ru(n)):ir(e)?_C(n):Vn(e)?n._d=new Date(e):U.createFromInputFallback(n)}function A_(n,e,t,i,r){var s={};return(e===!0||e===!1)&&(i=e,e=void 0),(t===!0||t===!1)&&(i=t,t=void 0),(ir(n)&&su(n)||sn(n)&&n.length===0)&&(n=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=r,s._l=t,s._i=n,s._f=e,s._strict=i,pC(s)}function Ae(n,e,t,i){return A_(n,e,t,i,!1)}var xC=Yt("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=Ae.apply(null,arguments);return this.isValid()&&n.isValid()?n<this?this:n:el()}),vC=Yt("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=Ae.apply(null,arguments);return this.isValid()&&n.isValid()?n>this?this:n:el()});function L_(n,e){var t,i;if(e.length===1&&sn(e[0])&&(e=e[0]),!e.length)return Ae();for(t=e[0],i=1;i<e.length;++i)(!e[i].isValid()||e[i][n](t))&&(t=e[i]);return t}function EC(){var n=[].slice.call(arguments,0);return L_("isBefore",n)}function TC(){var n=[].slice.call(arguments,0);return L_("isAfter",n)}var wC=function(){return Date.now?Date.now():+new Date},po=["year","quarter","month","week","day","hour","minute","second","millisecond"];function SC(n){var e,t=!1,i,r=po.length;for(e in n)if(pe(n,e)&&!(Ue.call(po,e)!==-1&&(n[e]==null||!isNaN(n[e]))))return!1;for(i=0;i<r;++i)if(n[po[i]]){if(t)return!1;parseFloat(n[po[i]])!==ue(n[po[i]])&&(t=!0)}return!0}function bC(){return this._isValid}function CC(){return ln(NaN)}function fl(n){var e=mu(n),t=e.year||0,i=e.quarter||0,r=e.month||0,s=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,l=e.minute||0,c=e.second||0,h=e.millisecond||0;this._isValid=SC(e),this._milliseconds=+h+c*1e3+l*6e4+a*1e3*60*60,this._days=+o+s*7,this._months=+r+i*3+t*12,this._data={},this._locale=qn(),this._bubble()}function gl(n){return n instanceof fl}function Iu(n){return n<0?Math.round(-1*n)*-1:Math.round(n)}function RC(n,e,t){var i=Math.min(n.length,e.length),r=Math.abs(n.length-e.length),s=0,o;for(o=0;o<i;o++)ue(n[o])!==ue(e[o])&&s++;return s+r}function M_(n,e){X(n,0,0,function(){var t=this.utcOffset(),i="+";return t<0&&(t=-t,i="-"),i+Sn(~~(t/60),2)+e+Sn(~~t%60,2)})}M_("Z",":"),M_("ZZ",""),Y("Z",al),Y("ZZ",al),Se(["Z","ZZ"],function(n,e,t){t._useUTC=!0,t._tzm=Au(al,n)});var PC=/([\+\-]|\d\d)/gi;function Au(n,e){var t=(e||"").match(n),i,r,s;return t===null?null:(i=t[t.length-1]||[],r=(i+"").match(PC)||["-",0,0],s=+(r[1]*60)+ue(r[2]),s===0?0:r[0]==="+"?s:-s)}function Lu(n,e){var t,i;return e._isUTC?(t=e.clone(),i=(on(n)||oo(n)?n.valueOf():Ae(n).valueOf())-t.valueOf(),t._d.setTime(t._d.valueOf()+i),U.updateOffset(t,!1),t):Ae(n).local()}function Mu(n){return-Math.round(n._d.getTimezoneOffset())}U.updateOffset=function(){};function IC(n,e,t){var i=this._offset||0,r;if(!this.isValid())return n!=null?this:NaN;if(n!=null){if(typeof n=="string"){if(n=Au(al,n),n===null)return this}else Math.abs(n)<16&&!t&&(n=n*60);return!this._isUTC&&e&&(r=Mu(this)),this._offset=n,this._isUTC=!0,r!=null&&this.add(r,"m"),i!==n&&(!e||this._changeInProgress?k_(this,ln(n-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,U.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?i:Mu(this)}function AC(n,e){return n!=null?(typeof n!="string"&&(n=-n),this.utcOffset(n,e),this):-this.utcOffset()}function LC(n){return this.utcOffset(0,n)}function MC(n){return this._isUTC&&(this.utcOffset(0,n),this._isUTC=!1,n&&this.subtract(Mu(this),"m")),this}function OC(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var n=Au(JS,this._i);n!=null?this.utcOffset(n):this.utcOffset(0,!0)}return this}function DC(n){return this.isValid()?(n=n?Ae(n).utcOffset():0,(this.utcOffset()-n)%60===0):!1}function FC(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function kC(){if(!Lt(this._isDSTShifted))return this._isDSTShifted;var n={},e;return cu(n,this),n=I_(n),n._a?(e=n._isUTC?Tn(n._a):Ae(n._a),this._isDSTShifted=this.isValid()&&RC(n._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function NC(){return this.isValid()?!this._isUTC:!1}function GC(){return this.isValid()?this._isUTC:!1}function O_(){return this.isValid()?this._isUTC&&this._offset===0:!1}var UC=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,BC=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ln(n,e){var t=n,i=null,r,s,o;return gl(n)?t={ms:n._milliseconds,d:n._days,M:n._months}:Vn(n)||!isNaN(+n)?(t={},e?t[e]=+n:t.milliseconds=+n):(i=UC.exec(n))?(r=i[1]==="-"?-1:1,t={y:0,d:ue(i[bn])*r,h:ue(i[Ze])*r,m:ue(i[an])*r,s:ue(i[Kn])*r,ms:ue(Iu(i[rr]*1e3))*r}):(i=BC.exec(n))?(r=i[1]==="-"?-1:1,t={y:sr(i[2],r),M:sr(i[3],r),w:sr(i[4],r),d:sr(i[5],r),h:sr(i[6],r),m:sr(i[7],r),s:sr(i[8],r)}):t==null?t={}:typeof t=="object"&&("from"in t||"to"in t)&&(o=zC(Ae(t.from),Ae(t.to)),t={},t.ms=o.milliseconds,t.M=o.months),s=new fl(t),gl(n)&&pe(n,"_locale")&&(s._locale=n._locale),gl(n)&&pe(n,"_isValid")&&(s._isValid=n._isValid),s}ln.fn=fl.prototype,ln.invalid=CC;function sr(n,e){var t=n&&parseFloat(n.replace(",","."));return(isNaN(t)?0:t)*e}function D_(n,e){var t={};return t.months=e.month()-n.month()+(e.year()-n.year())*12,n.clone().add(t.months,"M").isAfter(e)&&--t.months,t.milliseconds=+e-+n.clone().add(t.months,"M"),t}function zC(n,e){var t;return n.isValid()&&e.isValid()?(e=Lu(e,n),n.isBefore(e)?t=D_(n,e):(t=D_(e,n),t.milliseconds=-t.milliseconds,t.months=-t.months),t):{milliseconds:0,months:0}}function F_(n,e){return function(t,i){var r,s;return i!==null&&!isNaN(+i)&&(a_(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=t,t=i,i=s),r=ln(t,i),k_(this,r,n),this}}function k_(n,e,t,i){var r=e._milliseconds,s=Iu(e._days),o=Iu(e._months);n.isValid()&&(i=i??!0,o&&y_(n,uo(n,"Month")+o*t),s&&m_(n,"Date",uo(n,"Date")+s*t),r&&n._d.setTime(n._d.valueOf()+r*t),i&&U.updateOffset(n,s||o))}var WC=F_(1,"add"),YC=F_(-1,"subtract");function N_(n){return typeof n=="string"||n instanceof String}function $C(n){return on(n)||oo(n)||N_(n)||Vn(n)||VC(n)||jC(n)||n===null||n===void 0}function jC(n){var e=ir(n)&&!su(n),t=!1,i=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],r,s,o=i.length;for(r=0;r<o;r+=1)s=i[r],t=t||pe(n,s);return e&&t}function VC(n){var e=sn(n),t=!1;return e&&(t=n.filter(function(i){return!Vn(i)&&N_(n)}).length===0),e&&t}function XC(n){var e=ir(n)&&!su(n),t=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],r,s;for(r=0;r<i.length;r+=1)s=i[r],t=t||pe(n,s);return e&&t}function HC(n,e){var t=n.diff(e,"days",!0);return t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse"}function KC(n,e){arguments.length===1&&(arguments[0]?$C(arguments[0])?(n=arguments[0],e=void 0):XC(arguments[0])&&(e=arguments[0],n=void 0):(n=void 0,e=void 0));var t=n||Ae(),i=Lu(t,this).startOf("day"),r=U.calendarFormat(this,i)||"sameElse",s=e&&(wn(e[r])?e[r].call(this,t):e[r]);return this.format(s||this.localeData().calendar(r,this,Ae(t)))}function ZC(){return new ao(this)}function qC(n,e){var t=on(n)?n:Ae(n);return this.isValid()&&t.isValid()?(e=$t(e)||"millisecond",e==="millisecond"?this.valueOf()>t.valueOf():t.valueOf()<this.clone().startOf(e).valueOf()):!1}function JC(n,e){var t=on(n)?n:Ae(n);return this.isValid()&&t.isValid()?(e=$t(e)||"millisecond",e==="millisecond"?this.valueOf()<t.valueOf():this.clone().endOf(e).valueOf()<t.valueOf()):!1}function QC(n,e,t,i){var r=on(n)?n:Ae(n),s=on(e)?e:Ae(e);return this.isValid()&&r.isValid()&&s.isValid()?(i=i||"()",(i[0]==="("?this.isAfter(r,t):!this.isBefore(r,t))&&(i[1]===")"?this.isBefore(s,t):!this.isAfter(s,t))):!1}function eR(n,e){var t=on(n)?n:Ae(n),i;return this.isValid()&&t.isValid()?(e=$t(e)||"millisecond",e==="millisecond"?this.valueOf()===t.valueOf():(i=t.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf())):!1}function tR(n,e){return this.isSame(n,e)||this.isAfter(n,e)}function nR(n,e){return this.isSame(n,e)||this.isBefore(n,e)}function iR(n,e,t){var i,r,s;if(!this.isValid())return NaN;if(i=Lu(n,this),!i.isValid())return NaN;switch(r=(i.utcOffset()-this.utcOffset())*6e4,e=$t(e),e){case"year":s=ml(this,i)/12;break;case"month":s=ml(this,i);break;case"quarter":s=ml(this,i)/3;break;case"second":s=(this-i)/1e3;break;case"minute":s=(this-i)/6e4;break;case"hour":s=(this-i)/36e5;break;case"day":s=(this-i-r)/864e5;break;case"week":s=(this-i-r)/6048e5;break;default:s=this-i}return t?s:jt(s)}function ml(n,e){if(n.date()<e.date())return-ml(e,n);var t=(e.year()-n.year())*12+(e.month()-n.month()),i=n.clone().add(t,"months"),r,s;return e-i<0?(r=n.clone().add(t-1,"months"),s=(e-i)/(i-r)):(r=n.clone().add(t+1,"months"),s=(e-i)/(r-i)),-(t+s)||0}U.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",U.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function rR(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function sR(n){if(!this.isValid())return null;var e=n!==!0,t=e?this.clone().utc():this;return t.year()<0||t.year()>9999?nl(t,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):wn(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",nl(t,"Z")):nl(t,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function oR(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var n="moment",e="",t,i,r,s;return this.isLocal()||(n=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),t="["+n+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(t+i+r+s)}function aR(n){n||(n=this.isUtc()?U.defaultFormatUtc:U.defaultFormat);var e=nl(this,n);return this.localeData().postformat(e)}function lR(n,e){return this.isValid()&&(on(n)&&n.isValid()||Ae(n).isValid())?ln({to:this,from:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function cR(n){return this.from(Ae(),n)}function hR(n,e){return this.isValid()&&(on(n)&&n.isValid()||Ae(n).isValid())?ln({from:this,to:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function uR(n){return this.to(Ae(),n)}function G_(n){var e;return n===void 0?this._locale._abbr:(e=qn(n),e!=null&&(this._locale=e),this)}var U_=Yt("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(n){return n===void 0?this.localeData():this.locale(n)});function B_(){return this._locale}var _l=1e3,Zr=60*_l,pl=60*Zr,z_=(365*400+97)*24*pl;function qr(n,e){return(n%e+e)%e}function W_(n,e,t){return n<100&&n>=0?new Date(n+400,e,t)-z_:new Date(n,e,t).valueOf()}function Y_(n,e,t){return n<100&&n>=0?Date.UTC(n+400,e,t)-z_:Date.UTC(n,e,t)}function dR(n){var e,t;if(n=$t(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?Y_:W_,n){case"year":e=t(this.year(),0,1);break;case"quarter":e=t(this.year(),this.month()-this.month()%3,1);break;case"month":e=t(this.year(),this.month(),1);break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=t(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=qr(e+(this._isUTC?0:this.utcOffset()*Zr),pl);break;case"minute":e=this._d.valueOf(),e-=qr(e,Zr);break;case"second":e=this._d.valueOf(),e-=qr(e,_l);break}return this._d.setTime(e),U.updateOffset(this,!0),this}function fR(n){var e,t;if(n=$t(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?Y_:W_,n){case"year":e=t(this.year()+1,0,1)-1;break;case"quarter":e=t(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=t(this.year(),this.month()+1,1)-1;break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=t(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=pl-qr(e+(this._isUTC?0:this.utcOffset()*Zr),pl)-1;break;case"minute":e=this._d.valueOf(),e+=Zr-qr(e,Zr)-1;break;case"second":e=this._d.valueOf(),e+=_l-qr(e,_l)-1;break}return this._d.setTime(e),U.updateOffset(this,!0),this}function gR(){return this._d.valueOf()-(this._offset||0)*6e4}function mR(){return Math.floor(this.valueOf()/1e3)}function _R(){return new Date(this.valueOf())}function pR(){var n=this;return[n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second(),n.millisecond()]}function yR(){var n=this;return{years:n.year(),months:n.month(),date:n.date(),hours:n.hours(),minutes:n.minutes(),seconds:n.seconds(),milliseconds:n.milliseconds()}}function xR(){return this.isValid()?this.toISOString():null}function vR(){return au(this)}function ER(){return bi({},le(this))}function TR(){return le(this).overflow}function wR(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}X("N",0,0,"eraAbbr"),X("NN",0,0,"eraAbbr"),X("NNN",0,0,"eraAbbr"),X("NNNN",0,0,"eraName"),X("NNNNN",0,0,"eraNarrow"),X("y",["y",1],"yo","eraYear"),X("y",["yy",2],0,"eraYear"),X("y",["yyy",3],0,"eraYear"),X("y",["yyyy",4],0,"eraYear"),Y("N",Ou),Y("NN",Ou),Y("NNN",Ou),Y("NNNN",DR),Y("NNNNN",FR),Se(["N","NN","NNN","NNNN","NNNNN"],function(n,e,t,i){var r=t._locale.erasParse(n,i,t._strict);r?le(t).era=r:le(t).invalidEra=n}),Y("y",Vr),Y("yy",Vr),Y("yyy",Vr),Y("yyyy",Vr),Y("yo",kR),Se(["y","yy","yyy","yyyy"],ht),Se(["yo"],function(n,e,t,i){var r;t._locale._eraYearOrdinalRegex&&(r=n.match(t._locale._eraYearOrdinalRegex)),t._locale.eraYearOrdinalParse?e[ht]=t._locale.eraYearOrdinalParse(n,r):e[ht]=parseInt(n,10)});function SR(n,e){var t,i,r,s=this._eras||qn("en")._eras;for(t=0,i=s.length;t<i;++t){switch(typeof s[t].since){case"string":r=U(s[t].since).startOf("day"),s[t].since=r.valueOf();break}switch(typeof s[t].until){case"undefined":s[t].until=1/0;break;case"string":r=U(s[t].until).startOf("day").valueOf(),s[t].until=r.valueOf();break}}return s}function bR(n,e,t){var i,r,s=this.eras(),o,a,l;for(n=n.toUpperCase(),i=0,r=s.length;i<r;++i)if(o=s[i].name.toUpperCase(),a=s[i].abbr.toUpperCase(),l=s[i].narrow.toUpperCase(),t)switch(e){case"N":case"NN":case"NNN":if(a===n)return s[i];break;case"NNNN":if(o===n)return s[i];break;case"NNNNN":if(l===n)return s[i];break}else if([o,a,l].indexOf(n)>=0)return s[i]}function CR(n,e){var t=n.since<=n.until?1:-1;return e===void 0?U(n.since).year():U(n.since).year()+(e-n.offset)*t}function RR(){var n,e,t,i=this.localeData().eras();for(n=0,e=i.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),i[n].since<=t&&t<=i[n].until||i[n].until<=t&&t<=i[n].since)return i[n].name;return""}function PR(){var n,e,t,i=this.localeData().eras();for(n=0,e=i.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),i[n].since<=t&&t<=i[n].until||i[n].until<=t&&t<=i[n].since)return i[n].narrow;return""}function IR(){var n,e,t,i=this.localeData().eras();for(n=0,e=i.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),i[n].since<=t&&t<=i[n].until||i[n].until<=t&&t<=i[n].since)return i[n].abbr;return""}function AR(){var n,e,t,i,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=r[n].since<=r[n].until?1:-1,i=this.clone().startOf("day").valueOf(),r[n].since<=i&&i<=r[n].until||r[n].until<=i&&i<=r[n].since)return(this.year()-U(r[n].since).year())*t+r[n].offset;return this.year()}function LR(n){return pe(this,"_erasNameRegex")||Du.call(this),n?this._erasNameRegex:this._erasRegex}function MR(n){return pe(this,"_erasAbbrRegex")||Du.call(this),n?this._erasAbbrRegex:this._erasRegex}function OR(n){return pe(this,"_erasNarrowRegex")||Du.call(this),n?this._erasNarrowRegex:this._erasRegex}function Ou(n,e){return e.erasAbbrRegex(n)}function DR(n,e){return e.erasNameRegex(n)}function FR(n,e){return e.erasNarrowRegex(n)}function kR(n,e){return e._eraYearOrdinalRegex||Vr}function Du(){var n=[],e=[],t=[],i=[],r,s,o,a,l,c=this.eras();for(r=0,s=c.length;r<s;++r)o=Xn(c[r].name),a=Xn(c[r].abbr),l=Xn(c[r].narrow),e.push(o),n.push(a),t.push(l),i.push(o),i.push(a),i.push(l);this._erasRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+t.join("|")+")","i")}X(0,["gg",2],0,function(){return this.weekYear()%100}),X(0,["GG",2],0,function(){return this.isoWeekYear()%100});function yl(n,e){X(0,[n,n.length],0,e)}yl("gggg","weekYear"),yl("ggggg","weekYear"),yl("GGGG","isoWeekYear"),yl("GGGGG","isoWeekYear"),Y("G",ol),Y("g",ol),Y("GG",Ie,Nt),Y("gg",Ie,Nt),Y("GGGG",pu,_u),Y("gggg",pu,_u),Y("GGGGG",sl,il),Y("ggggg",sl,il),co(["gggg","ggggg","GGGG","GGGGG"],function(n,e,t,i){e[i.substr(0,2)]=ue(n)}),co(["gg","GG"],function(n,e,t,i){e[i]=U.parseTwoDigitYear(n)});function NR(n){return $_.call(this,n,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function GR(n){return $_.call(this,n,this.isoWeek(),this.isoWeekday(),1,4)}function UR(){return Zn(this.year(),1,4)}function BR(){return Zn(this.isoWeekYear(),1,4)}function zR(){var n=this.localeData()._week;return Zn(this.year(),n.dow,n.doy)}function WR(){var n=this.localeData()._week;return Zn(this.weekYear(),n.dow,n.doy)}function $_(n,e,t,i,r){var s;return n==null?go(this,i,r).year:(s=Zn(n,i,r),e>s&&(e=s),YR.call(this,n,e,t,i,r))}function YR(n,e,t,i,r){var s=E_(n,e,t,i,r),o=fo(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}X("Q",0,"Qo","quarter"),Y("Q",h_),Se("Q",function(n,e){e[Hn]=(ue(n)-1)*3});function $R(n){return n==null?Math.ceil((this.month()+1)/3):this.month((n-1)*3+this.month()%3)}X("D",["DD",2],"Do","date"),Y("D",Ie,Xr),Y("DD",Ie,Nt),Y("Do",function(n,e){return n?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient}),Se(["D","DD"],bn),Se("Do",function(n,e){e[bn]=ue(n.match(Ie)[0])});var j_=Hr("Date",!0);X("DDD",["DDDD",3],"DDDo","dayOfYear"),Y("DDD",rl),Y("DDDD",u_),Se(["DDD","DDDD"],function(n,e,t){t._dayOfYear=ue(n)});function jR(n){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return n==null?e:this.add(n-e,"d")}X("m",["mm",2],0,"minute"),Y("m",Ie,yu),Y("mm",Ie,Nt),Se(["m","mm"],an);var VR=Hr("Minutes",!1);X("s",["ss",2],0,"second"),Y("s",Ie,yu),Y("ss",Ie,Nt),Se(["s","ss"],Kn);var XR=Hr("Seconds",!1);X("S",0,0,function(){return~~(this.millisecond()/100)}),X(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),X(0,["SSS",3],0,"millisecond"),X(0,["SSSS",4],0,function(){return this.millisecond()*10}),X(0,["SSSSS",5],0,function(){return this.millisecond()*100}),X(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),X(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),X(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),X(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),Y("S",rl,h_),Y("SS",rl,Nt),Y("SSS",rl,u_);var Ri,V_;for(Ri="SSSS";Ri.length<=9;Ri+="S")Y(Ri,Vr);function HR(n,e){e[rr]=ue(("0."+n)*1e3)}for(Ri="S";Ri.length<=9;Ri+="S")Se(Ri,HR);V_=Hr("Milliseconds",!1),X("z",0,0,"zoneAbbr"),X("zz",0,0,"zoneName");function KR(){return this._isUTC?"UTC":""}function ZR(){return this._isUTC?"Coordinated Universal Time":""}var O=ao.prototype;O.add=WC,O.calendar=KC,O.clone=ZC,O.diff=iR,O.endOf=fR,O.format=aR,O.from=lR,O.fromNow=cR,O.to=hR,O.toNow=uR,O.get=ob,O.invalidAt=TR,O.isAfter=qC,O.isBefore=JC,O.isBetween=QC,O.isSame=eR,O.isSameOrAfter=tR,O.isSameOrBefore=nR,O.isValid=vR,O.lang=U_,O.locale=G_,O.localeData=B_,O.max=vC,O.min=xC,O.parsingFlags=ER,O.set=ab,O.startOf=dR,O.subtract=YC,O.toArray=pR,O.toObject=yR,O.toDate=_R,O.toISOString=sR,O.inspect=oR,typeof Symbol<"u"&&Symbol.for!=null&&(O[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),O.toJSON=xR,O.toString=rR,O.unix=mR,O.valueOf=gR,O.creationData=wR,O.eraName=RR,O.eraNarrow=PR,O.eraAbbr=IR,O.eraYear=AR,O.year=g_,O.isLeapYear=sb,O.weekYear=NR,O.isoWeekYear=GR,O.quarter=O.quarters=$R,O.month=x_,O.daysInMonth=_b,O.week=O.weeks=Sb,O.isoWeek=O.isoWeeks=bb,O.weeksInYear=zR,O.weeksInWeekYear=WR,O.isoWeeksInYear=UR,O.isoWeeksInISOWeekYear=BR,O.date=j_,O.day=O.days=Gb,O.weekday=Ub,O.isoWeekday=Bb,O.dayOfYear=jR,O.hour=O.hours=Xb,O.minute=O.minutes=VR,O.second=O.seconds=XR,O.millisecond=O.milliseconds=V_,O.utcOffset=IC,O.utc=LC,O.local=MC,O.parseZone=OC,O.hasAlignedHourOffset=DC,O.isDST=FC,O.isLocal=NC,O.isUtcOffset=GC,O.isUtc=O_,O.isUTC=O_,O.zoneAbbr=KR,O.zoneName=ZR,O.dates=Yt("dates accessor is deprecated. Use date instead.",j_),O.months=Yt("months accessor is deprecated. Use month instead",x_),O.years=Yt("years accessor is deprecated. Use year instead",g_),O.zone=Yt("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",AC),O.isDSTShifted=Yt("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",kC);function qR(n){return Ae(n*1e3)}function JR(){return Ae.apply(null,arguments).parseZone()}function X_(n){return n}var ye=uu.prototype;ye.calendar=NS,ye.longDateFormat=zS,ye.invalidDate=YS,ye.ordinal=VS,ye.preparse=X_,ye.postformat=X_,ye.relativeTime=HS,ye.pastFuture=KS,ye.set=FS,ye.eras=SR,ye.erasParse=bR,ye.erasConvertYear=CR,ye.erasAbbrRegex=MR,ye.erasNameRegex=LR,ye.erasNarrowRegex=OR,ye.months=db,ye.monthsShort=fb,ye.monthsParse=mb,ye.monthsRegex=yb,ye.monthsShortRegex=pb,ye.week=vb,ye.firstDayOfYear=wb,ye.firstDayOfWeek=Tb,ye.weekdays=Ob,ye.weekdaysMin=Fb,ye.weekdaysShort=Db,ye.weekdaysParse=Nb,ye.weekdaysRegex=zb,ye.weekdaysShortRegex=Wb,ye.weekdaysMinRegex=Yb,ye.isPM=jb,ye.meridiem=Hb;function xl(n,e,t,i){var r=qn(),s=Tn().set(i,e);return r[t](s,n)}function H_(n,e,t){if(Vn(n)&&(e=n,n=void 0),n=n||"",e!=null)return xl(n,e,t,"month");var i,r=[];for(i=0;i<12;i++)r[i]=xl(n,i,t,"month");return r}function Fu(n,e,t,i){typeof n=="boolean"?(Vn(e)&&(t=e,e=void 0),e=e||""):(e=n,t=e,n=!1,Vn(e)&&(t=e,e=void 0),e=e||"");var r=qn(),s=n?r._week.dow:0,o,a=[];if(t!=null)return xl(e,(t+s)%7,i,"day");for(o=0;o<7;o++)a[o]=xl(e,(o+s)%7,i,"day");return a}function QR(n,e){return H_(n,e,"months")}function eP(n,e){return H_(n,e,"monthsShort")}function tP(n,e,t){return Fu(n,e,t,"weekdays")}function nP(n,e,t){return Fu(n,e,t,"weekdaysShort")}function iP(n,e,t){return Fu(n,e,t,"weekdaysMin")}Ci("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(n){var e=n%10,t=ue(n%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return n+t}}),U.lang=Yt("moment.lang is deprecated. Use moment.locale instead.",Ci),U.langData=Yt("moment.langData is deprecated. Use moment.localeData instead.",qn);var Jn=Math.abs;function rP(){var n=this._data;return this._milliseconds=Jn(this._milliseconds),this._days=Jn(this._days),this._months=Jn(this._months),n.milliseconds=Jn(n.milliseconds),n.seconds=Jn(n.seconds),n.minutes=Jn(n.minutes),n.hours=Jn(n.hours),n.months=Jn(n.months),n.years=Jn(n.years),this}function K_(n,e,t,i){var r=ln(e,t);return n._milliseconds+=i*r._milliseconds,n._days+=i*r._days,n._months+=i*r._months,n._bubble()}function sP(n,e){return K_(this,n,e,1)}function oP(n,e){return K_(this,n,e,-1)}function Z_(n){return n<0?Math.floor(n):Math.ceil(n)}function aP(){var n=this._milliseconds,e=this._days,t=this._months,i=this._data,r,s,o,a,l;return n>=0&&e>=0&&t>=0||n<=0&&e<=0&&t<=0||(n+=Z_(ku(t)+e)*864e5,e=0,t=0),i.milliseconds=n%1e3,r=jt(n/1e3),i.seconds=r%60,s=jt(r/60),i.minutes=s%60,o=jt(s/60),i.hours=o%24,e+=jt(o/24),l=jt(q_(e)),t+=l,e-=Z_(ku(l)),a=jt(t/12),t%=12,i.days=e,i.months=t,i.years=a,this}function q_(n){return n*4800/146097}function ku(n){return n*146097/4800}function lP(n){if(!this.isValid())return NaN;var e,t,i=this._milliseconds;if(n=$t(n),n==="month"||n==="quarter"||n==="year")switch(e=this._days+i/864e5,t=this._months+q_(e),n){case"month":return t;case"quarter":return t/3;case"year":return t/12}else switch(e=this._days+Math.round(ku(this._months)),n){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return e*24+i/36e5;case"minute":return e*1440+i/6e4;case"second":return e*86400+i/1e3;case"millisecond":return Math.floor(e*864e5)+i;default:throw new Error("Unknown unit "+n)}}function Qn(n){return function(){return this.as(n)}}var J_=Qn("ms"),cP=Qn("s"),hP=Qn("m"),uP=Qn("h"),dP=Qn("d"),fP=Qn("w"),gP=Qn("M"),mP=Qn("Q"),_P=Qn("y"),pP=J_;function yP(){return ln(this)}function xP(n){return n=$t(n),this.isValid()?this[n+"s"]():NaN}function or(n){return function(){return this.isValid()?this._data[n]:NaN}}var vP=or("milliseconds"),EP=or("seconds"),TP=or("minutes"),wP=or("hours"),SP=or("days"),bP=or("months"),CP=or("years");function RP(){return jt(this.days()/7)}var ei=Math.round,Jr={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function PP(n,e,t,i,r){return r.relativeTime(e||1,!!t,n,i)}function IP(n,e,t,i){var r=ln(n).abs(),s=ei(r.as("s")),o=ei(r.as("m")),a=ei(r.as("h")),l=ei(r.as("d")),c=ei(r.as("M")),h=ei(r.as("w")),u=ei(r.as("y")),d=s<=t.ss&&["s",s]||s<t.s&&["ss",s]||o<=1&&["m"]||o<t.m&&["mm",o]||a<=1&&["h"]||a<t.h&&["hh",a]||l<=1&&["d"]||l<t.d&&["dd",l];return t.w!=null&&(d=d||h<=1&&["w"]||h<t.w&&["ww",h]),d=d||c<=1&&["M"]||c<t.M&&["MM",c]||u<=1&&["y"]||["yy",u],d[2]=e,d[3]=+n>0,d[4]=i,PP.apply(null,d)}function AP(n){return n===void 0?ei:typeof n=="function"?(ei=n,!0):!1}function LP(n,e){return Jr[n]===void 0?!1:e===void 0?Jr[n]:(Jr[n]=e,n==="s"&&(Jr.ss=e-1),!0)}function MP(n,e){if(!this.isValid())return this.localeData().invalidDate();var t=!1,i=Jr,r,s;return typeof n=="object"&&(e=n,n=!1),typeof n=="boolean"&&(t=n),typeof e=="object"&&(i=Object.assign({},Jr,e),e.s!=null&&e.ss==null&&(i.ss=e.s-1)),r=this.localeData(),s=IP(this,!t,i,r),t&&(s=r.pastFuture(+this,s)),r.postformat(s)}var Nu=Math.abs;function Qr(n){return(n>0)-(n<0)||+n}function vl(){if(!this.isValid())return this.localeData().invalidDate();var n=Nu(this._milliseconds)/1e3,e=Nu(this._days),t=Nu(this._months),i,r,s,o,a=this.asSeconds(),l,c,h,u;return a?(i=jt(n/60),r=jt(i/60),n%=60,i%=60,s=jt(t/12),t%=12,o=n?n.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",c=Qr(this._months)!==Qr(a)?"-":"",h=Qr(this._days)!==Qr(a)?"-":"",u=Qr(this._milliseconds)!==Qr(a)?"-":"",l+"P"+(s?c+s+"Y":"")+(t?c+t+"M":"")+(e?h+e+"D":"")+(r||i||n?"T":"")+(r?u+r+"H":"")+(i?u+i+"M":"")+(n?u+o+"S":"")):"P0D"}var ge=fl.prototype;ge.isValid=bC,ge.abs=rP,ge.add=sP,ge.subtract=oP,ge.as=lP,ge.asMilliseconds=J_,ge.asSeconds=cP,ge.asMinutes=hP,ge.asHours=uP,ge.asDays=dP,ge.asWeeks=fP,ge.asMonths=gP,ge.asQuarters=mP,ge.asYears=_P,ge.valueOf=pP,ge._bubble=aP,ge.clone=yP,ge.get=xP,ge.milliseconds=vP,ge.seconds=EP,ge.minutes=TP,ge.hours=wP,ge.days=SP,ge.weeks=RP,ge.months=bP,ge.years=CP,ge.humanize=MP,ge.toISOString=vl,ge.toString=vl,ge.toJSON=vl,ge.locale=G_,ge.localeData=B_,ge.toIsoString=Yt("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",vl),ge.lang=U_,X("X",0,0,"unix"),X("x",0,0,"valueOf"),Y("x",ol),Y("X",QS),Se("X",function(n,e,t){t._d=new Date(parseFloat(n)*1e3)}),Se("x",function(n,e,t){t._d=new Date(ue(n))});//! moment.js
U.version="2.30.1",OS(Ae),U.fn=O,U.min=EC,U.max=TC,U.now=wC,U.utc=Tn,U.unix=qR,U.months=QR,U.isDate=oo,U.locale=Ci,U.invalid=el,U.duration=ln,U.isMoment=on,U.weekdays=tP,U.parseZone=JR,U.localeData=qn,U.isDuration=gl,U.monthsShort=eP,U.weekdaysMin=iP,U.defineLocale=Su,U.updateLocale=Jb,U.locales=Qb,U.weekdaysShort=nP,U.normalizeUnits=$t,U.relativeTimeRounding=AP,U.relativeTimeThreshold=LP,U.calendarFormat=HC,U.prototype=O,U.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const yo=(...n)=>n.filter(e=>!!e).join(" ");function OP(n){return Js({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"},child:[]},{tag:"path",attr:{d:"M4.6 7l14.8 0"},child:[]},{tag:"path",attr:{d:"M3 12l18 0"},child:[]},{tag:"path",attr:{d:"M4.6 17l14.8 0"},child:[]}]})(n)}function DP(n){return Js({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"},child:[]},{tag:"path",attr:{d:"M11.5 3a11.2 11.2 0 0 0 0 18"},child:[]},{tag:"path",attr:{d:"M12.5 3a11.2 11.2 0 0 1 0 18"},child:[]},{tag:"path",attr:{d:"M12 3l0 18"},child:[]}]})(n)}const FP=()=>{const n=rn.use.map(),[e,t]=I.useState([0,0]);return I.useEffect(()=>{const i=r=>{const s=Zt(r.coordinate,"EPSG:3857","EPSG:4326");t(s)};n.on("pointermove",i)},[n]),j.jsxs("div",{className:ph.latLon,children:[j.jsx(DP,{size:24,display:"inline",strokeWidth:"1.5",preserveAspectRatio:"xMinYMin meet"}),j.jsx("span",{children:e[0].toFixed(4)}),"     ",j.jsx(OP,{size:24,display:"inline",strokeWidth:"1.5",preserveAspectRatio:"xMinYMin meet"}),j.jsx("span",{children:e[1].toFixed(4)})]})};function kP(n){return Js({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M80 368H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm0-320H16A16 16 0 0 0 0 64v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16V64a16 16 0 0 0-16-16zm0 160H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm416 176H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"},child:[]}]})(n)}const NP=()=>{const n=rn.use.map(),[e,t]=I.useState([]),i=rn.use.setSelectedLayers();I.useEffect(()=>{i(n.getAllLayers().filter(s=>s.getVisible()))},[n]);const r=rn.use.selectedLayers();return I.useEffect(()=>{Promise.all(r.filter(s=>s.getSource()instanceof Dg).map(async s=>{var u;const o=s.getSource(),a=(u=o.getUrls())==null?void 0:u[0],l=o.getParams().LAYERS,h=await(await iu(await ru(GP(a,l)))).blob();return URL.createObjectURL(h)})).then(s=>t(s))},[r]),!r||r.length===0?null:j.jsxs("ul",{className:yo(ph.layersLegend,"list-unstyled mb-0 rounded p-2 bg-white"),style:{backgroundColor:"rgb(255, 255, 255)",marginBottom:"80px"},children:[j.jsxs("small",{className:"d-flex align-items-center mb-1",children:[j.jsx(kP,{size:5})," ",j.jsx("span",{className:"ms-1",children:"Layers Legend"})]}),e&&e.length>0&&e.filter((s,o)=>!!r[o]).map((s,o)=>j.jsx("li",{children:j.jsx("img",{src:s})},r[o].get("id")))]})},GP=(n,e)=>`${n}?REQUEST=GetLegendGraphic&sld_version=1.0.0&layer=${e}&format=image/png&transparent=true&legend_options=fontSize:11;fontName:sans-serif;fontAntiAliasing:true;forceLabels:on;dpi:116&WIDTH=12&HEIGHT=12&Scale=1`,UP=({showLatLon:n=!0,freezeMap:e=!1,INDIA_CENTER_COORDS:t,INITIAL_ZOOM:i,KEY:r,URL:s,callbackify:o,layersJson:a,API_URL:l,MAP_DATA:c,isProduction:h})=>{const u=new Wt({layers:[new Pa({visible:!1,preload:1/0,opacity:1,source:new OE({key:r,imagerySet:"Aerial"}),properties:{name:"Aerial"}}),new Pa({visible:!1,source:new Pg({url:"http://mt1.google.com/vt/lyrs=y&x={x}&y={y}&z={z}"}),properties:{name:"High Resolution"}}),new Pa({source:new Pg({url:s}),visible:!1,properties:{name:"India Tiles"}})],properties:{name:"High Resolution Image"}}),d=new Wt({properties:{name:"High-Res Images"},layers:[u]}),f=I.useRef(null),g=I.useRef(!1),_=rn.use.setMap(),m=rn.use.map(),[y,p]=I.useState([d]),E=rn.use.selectedLayers(),[x,v]=I.useState(),[S,w]=I.useState([]),b=A=>{const k=new hi(new Jt(A));return k.setStyle(new _t({image:new ji({radius:30,stroke:new kt({color:"green",width:2})})})),k},P=I.useCallback((A,k)=>{const z=b(A.coordinate);k.animateFeature(z,new sE({fade:vi,duration:2800,easing:tv}))},[]),D=I.useCallback(A=>{const[k,z]=Zt(A.coordinate,"EPSG:3857","EPSG:4326"),V=`POINT (${k} ${z})`;hS(l,{id:V}).then(K=>{K!=null&&K[0]?(console.log("hi"),o(K)):Te.warn("No data found for the selected point.")}).catch(K=>{Te.error(K)}).finally(()=>{m&&m.un("singleclick",D)})},[m]),G=A=>{if(A.type==="layer")return new Pa({source:new Dg({crossOrigin:"anonymous",url:c,tileLoadFunction:IS,params:{version:"1.3.0",TILED:!0,LAYERS:A.paramLayers,STYLES:A.styles||"",CQL_FILTER:A.cql}}),properties:{id:A.id,name:A.label},visible:A.visible,maxResolution:A.maxResolution});const k=A.children.map(G);return new Wt({properties:{id:A.id,name:A.label},layers:k})};I.useEffect(()=>{g.current||(g.current=!0,p(A=>[...A,...a.children.map(G)]))},[]);const N=I.useCallback(()=>{uS(l,{}).then(A=>{w(A)}).catch(A=>{Te.error(A)})},[]),F=I.useCallback(()=>{if(!m)return!1;const A=m.getAllLayers().find(k=>k.get("name")==="Hospital Birth");return(A==null?void 0:A.isVisible())||!1},[m]);I.useEffect(()=>{if(!m)return;F()?N():w([])},[m,N,E,F]),I.useEffect(()=>{if(!f.current)return;const A=[new rE,new Qv,new eE({className:"bottom",src:"compact",style:new kt({color:"#75869d",width:0})})],k=new Qi({target:f.current,layers:y,view:new yn({center:Iy(t),zoom:i}),controls:e?[]:[...cg().getArray(),...A],interactions:e?[]:mg()}),z=new tE({layers:k.getAllLayers()});k.addControl(z);const V=K=>P(K,k);return k.on("singleclick",V),_(k),()=>{A.forEach(K=>k.removeControl(K)),k.un("singleclick",V),k.dispose(),k.setTarget(void 0)}},[y,e,P,_]),I.useEffect(()=>{if(!m)return;const A=m.getAllLayers().find(k=>k.get("name")==="cluster-layer");A&&m.removeLayer(A),x&&F()&&m.addLayer(x)},[x,m,F]),I.useEffect(()=>{if(!Array.isArray(S)||S.length<1){v(void 0);return}if((S==null?void 0:S.length)>0){const A=S.length,k=new Array(A);for(let oe=0;oe<A;++oe){const L=[parseFloat(S[oe].lon),parseFloat(S[oe].lat)];k[oe]=new hi(new Jt(Zt(L,"EPSG:4326","EPSG:3857"))),k[oe].set("count",S[oe].count)}const z=new Fs({features:k}),V=new DE({distance:40,source:z}),K=new oE({source:V,animationDuration:700,style:H,properties:{name:"cluster-layer"}});v(K)}},[S]);let B={};function H(A,k){var oe,L;const V=(L=(oe=A.get("features"))==null?void 0:oe[0])==null?void 0:L.get("count");let K=B[V];if(V){const ke=V>25?"192,0,0":V>8?"255,128,0":"0,128,0",We=Math.max(8,Math.min(V*.75,20)),Re=new Array(7).fill(2*Math.PI*We/6);Re[0]=0,K=B[V]=new _t({image:new ji({radius:We,stroke:new kt({color:"rgba("+ke+",0.5)",width:15,lineDash:Re,lineCap:"butt"}),fill:new Gn({color:"rgba("+ke+",1)"})}),text:new Vi({text:V.toString(),fill:new Gn({color:"#fff"})})})}return K}return j.jsxs(j.Fragment,{children:[j.jsx("div",{id:"map",ref:f,className:yo(ph.map,WE.map)}),j.jsx(NP,{}),n&&j.jsx(FP,{}),!1,j.jsx(LS,{})]})};var BP=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},zP=function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,r,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(h){return l([c,h])}}function l(c){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(t=0)),t;)try{if(i=1,r&&(s=c[0]&2?r.return:c[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,c[1])).done)return s;switch(r=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,r=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){t.label=c[1];break}if(c[0]===6&&t.label<s[1]){t.label=s[1],s=c;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(c);break}s[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(h){c=[6,h],r=0}finally{i=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},WP=function(){function n(e){this.handlerCount=0,this.handlers=[],this.options=e}return Object.defineProperty(n.prototype,"numberOfHandlers",{get:function(){return this.handlers.filter(function(e){return!!e}).length},enumerable:!1,configurable:!0}),n.prototype.emit=function(e){var t,i;return BP(this,void 0,void 0,function(){var r,s,o,a,l;return zP(this,function(c){switch(c.label){case 0:for(r=[],(i=(t=this.options)===null||t===void 0?void 0:t.logger)===null||i===void 0||i.call(t,"emit",e),s=0,o=this.handlers;s<o.length;s++)a=o[s],a&&(l=a(e),typeof(l==null?void 0:l.then)=="function"&&r.push(l));return[4,Promise.all(r)];case 1:return c.sent(),[2]}})})},n.prototype.on=function(e){var t,i;return(i=(t=this.options)===null||t===void 0?void 0:t.logger)===null||i===void 0||i.call(t,"on"),this.handlers.push(e),this.handlerCount++},n.prototype.off=function(e){this.delete(e)},n.prototype.delete=function(e){var t,i;(i=(t=this.options)===null||t===void 0?void 0:t.logger)===null||i===void 0||i.call(t,"off"),this.handlers[e]=null},n}(),Gu=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?s(h.value):r(h.value).then(a,l)}c((i=i.apply(n,e||[])).next())})},Uu=function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,r,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(h){return l([c,h])}}function l(c){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(t=0)),t;)try{if(i=1,r&&(s=c[0]&2?r.return:c[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,c[1])).done)return s;switch(r=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,r=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){t.label=c[1];break}if(c[0]===6&&t.label<s[1]){t.label=s[1],s=c;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(c);break}s[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(h){c=[6,h],r=0}finally{i=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},YP=function(){function n(e,t){this.onDidChangeTreeDataEmitter=new WP,this.data={items:e},this.setItemName=t}return n.prototype.getTreeItem=function(e){return Gu(this,void 0,void 0,function(){return Uu(this,function(t){return[2,this.data.items[e]]})})},n.prototype.onChangeItemChildren=function(e,t){return Gu(this,void 0,void 0,function(){return Uu(this,function(i){return this.data.items[e].children=t,this.onDidChangeTreeDataEmitter.emit([e]),[2]})})},n.prototype.onDidChangeTreeData=function(e){var t=this,i=this.onDidChangeTreeDataEmitter.on(function(r){return e(r)});return{dispose:function(){return t.onDidChangeTreeDataEmitter.off(i)}}},n.prototype.onRenameItem=function(e,t){return Gu(this,void 0,void 0,function(){return Uu(this,function(i){return this.setItemName&&(this.data.items[e.index]=this.setItemName(e,t)),[2]})})},n}();Ay([68.11,6.4,96.41,37.5],"EPSG:4326","EPSG:3857");const Q_=n=>n instanceof Wt,xo={container:"_container_1j5vm_1",btnRootGroup:"_btnRootGroup_1j5vm_7",drawer:"_drawer_1j5vm_21",drawerclosebutton:"_drawerclosebutton_1j5vm_30",drawerbody:"_drawerbody_1j5vm_76"},$P=()=>{const n=rn.use.map(),e=rn.use.selectedLayers(),t=rn.use.setSelectedLayers(),[i,r]=I.useState(!1),[s,o]=I.useState(),[a,l]=I.useState(),[c,h]=I.useState({}),[u,d]=I.useState({}),f=(x,v)=>{if(v.setVisible(x.target.checked),v.changed(),x.target.checked)t(e.concat(v));else{const S=e.filter(w=>v.get("name")!==w.get("name"));t(S)}h({...c,[v.get("name")]:x.target.checked})},g=n.getAllLayers().length;I.useEffect(()=>{const x={};n.getAllLayers().filter(v=>v.getVisible()).forEach(v=>{x[v.get("name")]=v.getVisible()}),h(x)},[g]);const _=(x,v)=>{const S=document.createElement("div");S.className="custom-tooltip",S.textContent=v,S.style.cssText=`
      position: absolute;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      z-index: 1000;
      pointer-events: none;
    `,document.body.appendChild(S);const w=x.currentTarget.getBoundingClientRect();S.style.left=`${w.left-S.offsetWidth-10}px`,S.style.top=`${w.top+w.height/2-S.offsetHeight/2}px`,x.currentTarget.setAttribute("data-tooltip",S.id=Date.now().toString())},m=x=>{const v=x.currentTarget.getAttribute("data-tooltip");if(v){const S=document.getElementById(v);S&&S.remove(),x.currentTarget.removeAttribute("data-tooltip")}},y=x=>{const v={root:Bu("root",!0,void 0)};ep(x,"root",v),l(new YP(v)),o(x),r(!0)},p=()=>{r(!1),o(void 0)},E=x=>{d(v=>({...v,[x]:!v[x]}))};return n.getLayers().getLength()===0?null:j.jsxs(j.Fragment,{children:[j.jsx("div",{className:yo(xo.container,"d-flex justify-content-end align-items-center"),children:j.jsx("ul",{className:"list-unstyled",children:n.getLayers().getArray().filter(Q_).map((x,v)=>j.jsx("li",{className:"mb-2",onClick:()=>y(x),children:j.jsx("button",{className:yo(xo.btnRootGroup,"rounded"),onMouseEnter:S=>_(S,x.get("name")),onMouseLeave:m,title:x.get("name")})},v))})}),i&&j.jsxs(j.Fragment,{children:[j.jsx("div",{className:"drawer-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",pointerEvents:"none",zIndex:1e3}}),j.jsxs("div",{className:yo(xo.drawer,"custom-drawer"),style:{position:"fixed",top:0,right:0,height:"100vh",width:"384px",backgroundColor:"white",boxShadow:"-4px 0 15px rgba(0, 0, 0, 0.1)",zIndex:1001,pointerEvents:"all",display:"flex",flexDirection:"column"},children:[j.jsx("button",{className:xo.drawerclosebutton,onClick:p,style:{position:"absolute",top:"12px",right:"12px",background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"black",zIndex:1002},children:"✕"}),j.jsx("div",{className:"drawer-header",style:{padding:"16px 24px",borderBottom:"1px solid rgba(255, 255, 255, 0.28)",backgroundColor:"transparent"},children:j.jsx("h4",{style:{margin:0,fontSize:"18px",fontWeight:"600"},children:s==null?void 0:s.get("name")})}),j.jsx("div",{className:xo.drawerbody,style:{flex:1,padding:"16px 24px",overflow:"auto"},children:j.jsx("div",{className:"custom-accordion",children:!!s&&s.getLayers().getArray().filter(Q_).map((x,v)=>{const S=x.get("name"),w=u[S];return j.jsxs("div",{className:"accordion-item",style:{marginBottom:"8px"},children:[j.jsxs("button",{className:"accordion-button",onClick:()=>E(S),style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 16px",background:"transparent",border:"1px solid #e2e8f0",borderRadius:"6px",cursor:"pointer",fontSize:"14px",textAlign:"left"},children:[j.jsx("span",{children:S}),j.jsx("span",{style:{transform:w?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"},children:"▼"})]}),w&&j.jsx("div",{className:"accordion-panel",style:{padding:"16px",borderLeft:"1px solid #e2e8f0",borderRight:"1px solid #e2e8f0",borderBottom:"1px solid #e2e8f0",borderTop:"none",borderRadius:"0 0 6px 6px",marginTop:"-1px"},children:x.getLayers().getArray().map((b,P)=>j.jsxs("div",{className:"d-flex align-items-center",style:{display:"flex",alignItems:"center",marginBottom:"8px"},children:[j.jsx("input",{style:{accentColor:"#007780",marginRight:"8px"},type:"checkbox",autoComplete:"off",autoCorrect:"off",checked:!!c[b.get("name")],onChange:D=>f(D,b)}),j.jsx("span",{style:{fontSize:"14px"},children:b.get("name")})]},P))})]},v)})})})]})]})]})},Bu=(n,e,t)=>({index:n,isFolder:e,data:t,children:[],canMove:!1,canRename:!1}),ep=(n,e,t)=>{if(n instanceof Wt)n.getLayers().getArray().forEach(r=>{var o;const s=r.get("name");(o=t[e].children)==null||o.push(s),t[s]=Bu(s,r instanceof Wt,s),ep(r,s,t)});else{const i=n.get("name");t[i]=Bu(i,!1,n)}},jP=({obj:n})=>(I.useEffect(()=>{localStorage.setItem("isProduction",n==null?void 0:n.isProduction)},[n==null?void 0:n.isProduction]),j.jsxs(j.Fragment,{children:[j.jsx(UP,{showLatLon:n==null?void 0:n.showLatLon,freezeMap:n==null?void 0:n.freezeMap,INDIA_CENTER_COORDS:n==null?void 0:n.INDIA_CENTER_COORDS,INITIAL_ZOOM:n==null?void 0:n.INITIAL_ZOOM,KEY:n==null?void 0:n.KEY,URL:n==null?void 0:n.URL,callbackify:n==null?void 0:n.handleChildCallback,layersJson:n.layersJsonDefault,API_URL:n==null?void 0:n.API_URL,MAP_DATA:n==null?void 0:n.MAP_DATA,isProduction:n==null?void 0:n.isProduction}),j.jsx($P,{}),j.jsx(Gp,{})]}));Dt.MAP=jP,Object.defineProperty(Dt,Symbol.toStringTag,{value:"Module"})});
